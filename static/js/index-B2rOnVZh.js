import{l as e}from"./index-9F9TBnAc.js";import{b as a}from"./projectManagement-BSPCmzUb.js";import{a as l}from"./ElementPlus-heS2Cq9L.js";import{l as t,a as o,Z as n,ah as r,ap as u,m as s,p as d,U as i,O as p,S as m,u as c,P as v,M as f,q as g,T as b,F as _,a7 as y}from"./vue-K7LtoPyd.js";import"./axios-dB_UgXDe.js";const j={class:"dialog-footer"},V=t({__name:"index",setup(t){const V=o(!1);let h=n({pageNo:1,pageSize:10}),C=o({});const N=o(0),S=o(!1),w=o([]),z=o(""),M=o([]);function k(){var a;S.value=!0,(a=h,e.post("/versionManagement/findVersionManagementPage",a)).then((e=>{w.value=e.data.records,N.value=e.data.total,S.value=!1}))}function x(){var a;C.value.id?(a=>e.post("/versionManagement/updateVersionManagementById",a))(C.value).then((e=>{V.value=!1,k(),l({type:e.data?"success":"error",message:e.data?"修改成功":"修改失败"})})):(a=C.value,e.post("/versionManagement/addVersionManagement",a)).then((e=>{V.value=!1,k(),l({type:e.data?"success":"error",message:e.data?"创建成功":"创建失败"})}))}function U(e){e.id?(C.value={...e},z.value=JSON.stringify({projectCode:e.projectCode,projectName:e.projectName})):(C.value={},z.value=""),V.value=!0}function D(a){var t;(t={id:a},e.post("/versionManagement/removeVersionManagementById",{},{params:t})).then((e=>{k(),l({type:e.data?"success":"error",message:e.data?"删除成功":"删除失败"})}))}function O(e){let a=JSON.parse(e);C.value={...C.value,...a}}function P(e){switch(Number(e)){case 1:return"未发布";case 2:return"已发布";case 3:return"已打包";case 4:return"已回退";default:return e}}return a({}).then((e=>{M.value=e.data})),k(),(e,a)=>{const l=r("el-button"),t=r("el-form-item"),o=r("el-form"),n=r("el-table-column"),J=r("el-popconfirm"),B=r("el-table"),E=r("el-pagination"),I=r("el-option"),q=r("el-select"),A=r("el-input"),F=r("el-radio"),T=r("el-radio-group"),Z=r("el-dialog"),G=u("loading");return s(),d("div",null,[i(o,{inline:!0,model:c(h)},{default:p((()=>[i(t,null,{default:p((()=>[i(l,{type:"primary",onClick:k},{default:p((()=>[m("搜索")])),_:1}),i(l,{type:"success",onClick:U},{default:p((()=>[m("新增")])),_:1})])),_:1})])),_:1},8,["model"]),v((s(),f(B,{data:w.value,style:{width:"100%","margin-bottom":"20px"},border:""},{default:p((()=>[i(n,{prop:"projectName",label:"项目名称-中文名",align:"center"}),i(n,{prop:"projectCode",label:"项目编码-英文名",align:"center"}),i(n,{prop:"versionNumber",label:"版本号",align:"center"}),i(n,{prop:"versionDescribe",label:"版本描述",align:"center"}),i(n,{prop:"updateDate",label:"更新时间",align:"center"}),i(n,{label:"状态",align:"center"},{default:p((e=>[g("span",null,b(P(e.row.versionState)),1)])),_:1}),i(n,{label:"操作",width:"220",align:"center"},{default:p((e=>[i(l,{type:"primary",size:"small",onClick:a=>U(e.row)},{default:p((()=>[m("编辑")])),_:2},1032,["onClick"]),i(J,{title:"Are you sure to delete this?",onConfirm:a=>D(e.row.id)},{reference:p((()=>[i(l,{type:"danger",size:"small"},{default:p((()=>[m("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[G,S.value]]),i(E,{"current-page":c(h).pageNo,"onUpdate:currentPage":a[0]||(a[0]=e=>c(h).pageNo=e),"page-size":c(h).pageSize,"onUpdate:pageSize":a[1]||(a[1]=e=>c(h).pageSize=e),background:!0,layout:"total, sizes, prev, pager, next, jumper",total:N.value,onSizeChange:k,onCurrentChange:k},null,8,["current-page","page-size","total"]),i(Z,{modelValue:V.value,"onUpdate:modelValue":a[7]||(a[7]=e=>V.value=e),title:"操作",width:"600"},{footer:p((()=>[g("div",j,[i(l,{onClick:a[6]||(a[6]=e=>V.value=!1)},{default:p((()=>[m("取消")])),_:1}),i(l,{type:"primary",onClick:x},{default:p((()=>[m("确定")])),_:1})])])),default:p((()=>[i(o,{model:c(C),"label-width":"auto",style:{"max-width":"600px"}},{default:p((()=>[i(t,{label:"项目"},{default:p((()=>[i(q,{modelValue:z.value,"onUpdate:modelValue":a[2]||(a[2]=e=>z.value=e),placeholder:"选择项目",style:{width:"100%"},onChange:O},{default:p((()=>[(s(!0),d(_,null,y(M.value,(e=>(s(),f(I,{key:e.projectCode,label:e.projectName,value:JSON.stringify({projectCode:e.projectCode,projectName:e.projectName})},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(t,{label:"版本号"},{default:p((()=>[i(A,{modelValue:c(C).versionNumber,"onUpdate:modelValue":a[3]||(a[3]=e=>c(C).versionNumber=e)},null,8,["modelValue"])])),_:1}),i(t,{label:"服务描述"},{default:p((()=>[i(A,{modelValue:c(C).versionDescribe,"onUpdate:modelValue":a[4]||(a[4]=e=>c(C).versionDescribe=e)},null,8,["modelValue"])])),_:1}),i(t,{label:"状态"},{default:p((()=>[i(T,{modelValue:c(C).versionState,"onUpdate:modelValue":a[5]||(a[5]=e=>c(C).versionState=e)},{default:p((()=>[i(F,{value:1},{default:p((()=>[m("未发布")])),_:1}),i(F,{value:2},{default:p((()=>[m("已发布")])),_:1}),i(F,{value:3},{default:p((()=>[m("已打包")])),_:1}),i(F,{value:4},{default:p((()=>[m("已回退")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}});export{V as default};
