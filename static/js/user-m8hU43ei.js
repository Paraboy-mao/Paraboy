import{h as e,j as l,k as a}from"./index-9F9TBnAc.js";import{f as o}from"./sysRole-ciOoaIRN.js";import{a as s}from"./ElementPlus-heS2Cq9L.js";import{l as t,a as u,Z as r,ah as d,m as n,p as i,U as c,O as m,u as p,S as f,F as y,a7 as g,M as U,T as _,q as v,R as D}from"./vue-K7LtoPyd.js";import"./axios-dB_UgXDe.js";const V={class:"dialog-footer"},b=t({__name:"user",setup(t){const b=u(!1);let h=r({pageNo:1,pageSize:10,account:"",userName:""}),C=r({sysUserDo:{account:"",isMultiLogin:1,password:"",state:1,userName:""},sysUserRoleDos:[]});const w=u([]),N=u(0),k=u([]),z=u([]);o({}).then((e=>{k.value=e.data}));const x=()=>{let l={sysUserDo:C.sysUserDo,sysUserRoleDos:[]};w.value.forEach((e=>{l.sysUserRoleDos.push({account:C.sysUserDo.account,roleCode:e})})),e(l).then((e=>{b.value=!1,R(),s({type:e.data?"success":"error",message:e.data?"创建成功":"创建失败"})}))};function j(e){w.value=[],e.id?(C.sysUserDo={...e},e.roles.forEach((l=>{w.value.push(l.roleCode),C.sysUserRoleDos.push({account:e.account,roleCode:l.roleCode})}))):C=r({sysUserDo:{account:"",isMultiLogin:1,password:"",state:1,userName:""},sysUserRoleDos:[]}),b.value=!0}function R(){l(h).then((e=>{z.value=e.data.records,N.value=e.data.total}))}return R(),(e,l)=>{const o=d("el-input"),t=d("el-form-item"),u=d("el-button"),r=d("el-form"),M=d("el-table-column"),S=d("el-tag"),L=d("el-popconfirm"),E=d("el-table"),P=d("el-pagination"),q=d("el-option"),A=d("el-select"),F=d("el-radio"),O=d("el-radio-group"),T=d("el-dialog");return n(),i("div",null,[c(r,{inline:!0,model:p(h)},{default:m((()=>[c(t,{label:"账号"},{default:m((()=>[c(o,{modelValue:p(h).account,"onUpdate:modelValue":l[0]||(l[0]=e=>p(h).account=e),placeholder:"账号",clearable:""},null,8,["modelValue"])])),_:1}),c(t,null,{default:m((()=>[c(u,{type:"primary",onClick:R},{default:m((()=>[f("搜索")])),_:1}),c(u,{type:"success",onClick:j},{default:m((()=>[f("新增")])),_:1})])),_:1})])),_:1},8,["model"]),c(E,{data:z.value,style:{width:"100%","margin-bottom":"20px"},border:""},{default:m((()=>[c(M,{prop:"userName",label:"用户名称",align:"center"}),c(M,{prop:"account",label:"账号",align:"center"}),c(M,{label:"角色权限",align:"center"},{default:m((e=>[(n(!0),i(y,null,g(e.row.roles,(e=>(n(),U(S,{style:{"margin-right":"10px"}},{default:m((()=>[f(_(e.roleName),1)])),_:2},1024)))),256))])),_:1}),c(M,{label:"用户状态",align:"center"},{default:m((e=>[v("span",null,_(1==e.row.state?"启用":"禁用"),1)])),_:1}),c(M,{label:"是否多点登录",align:"center"},{default:m((e=>[v("span",null,_(1==e.row.isMultiLogin?"是":"否"),1)])),_:1}),c(M,{label:"操作",width:"220",align:"center"},{default:m((e=>[c(u,{type:"primary",size:"small",onClick:l=>j(e.row)},{default:m((()=>[f("编辑")])),_:2},1032,["onClick"]),c(L,{title:"Are you sure to delete this?",onConfirm:l=>{return o=e.row.account,void a({account:o}).then((e=>{R(),s({type:e.data?"success":"error",message:e.data?"删除成功":"删除失败"})}));var o}},{reference:m((()=>[c(u,{type:"danger",size:"small"},{default:m((()=>[f("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),c(P,{"current-page":p(h).pageNo,"onUpdate:currentPage":l[1]||(l[1]=e=>p(h).pageNo=e),"page-size":p(h).pageSize,"onUpdate:pageSize":l[2]||(l[2]=e=>p(h).pageSize=e),background:!0,layout:"total, sizes, prev, pager, next, jumper",total:N.value,onSizeChange:R,onCurrentChange:R},null,8,["current-page","page-size","total"]),c(T,{modelValue:b.value,"onUpdate:modelValue":l[10]||(l[10]=e=>b.value=e),title:"操作",width:"600"},{footer:m((()=>[v("div",V,[c(u,{onClick:l[9]||(l[9]=e=>b.value=!1)},{default:m((()=>[f("取消")])),_:1}),c(u,{type:"primary",onClick:x},{default:m((()=>[f("确定")])),_:1})])])),default:m((()=>[c(r,{model:p(C).sysUserDo,"label-width":"auto",style:{"max-width":"600px"}},{default:m((()=>[c(t,{label:"用户名称"},{default:m((()=>[c(o,{modelValue:p(C).sysUserDo.userName,"onUpdate:modelValue":l[3]||(l[3]=e=>p(C).sysUserDo.userName=e)},null,8,["modelValue"])])),_:1}),c(t,{label:"账号"},{default:m((()=>[c(o,{modelValue:p(C).sysUserDo.account,"onUpdate:modelValue":l[4]||(l[4]=e=>p(C).sysUserDo.account=e)},null,8,["modelValue"])])),_:1}),p(C).sysUserDo.id?D("",!0):(n(),U(t,{key:0,label:"密码"},{default:m((()=>[c(o,{modelValue:p(C).sysUserDo.password,"onUpdate:modelValue":l[5]||(l[5]=e=>p(C).sysUserDo.password=e)},null,8,["modelValue"])])),_:1})),c(t,{label:"角色权限"},{default:m((()=>[c(A,{modelValue:w.value,"onUpdate:modelValue":l[6]||(l[6]=e=>w.value=e),multiple:"",placeholder:"选着角色"},{default:m((()=>[(n(!0),i(y,null,g(k.value,(e=>(n(),U(q,{key:e.roleCode,label:e.roleName,value:e.roleCode},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),c(t,{label:"用户状态"},{default:m((()=>[c(O,{modelValue:p(C).sysUserDo.state,"onUpdate:modelValue":l[7]||(l[7]=e=>p(C).sysUserDo.state=e)},{default:m((()=>[c(F,{value:1},{default:m((()=>[f("启用")])),_:1}),c(F,{value:0},{default:m((()=>[f("停用")])),_:1})])),_:1},8,["modelValue"])])),_:1}),c(t,{label:"是否多点登录"},{default:m((()=>[c(O,{modelValue:p(C).sysUserDo.isMultiLogin,"onUpdate:modelValue":l[8]||(l[8]=e=>p(C).sysUserDo.isMultiLogin=e)},{default:m((()=>[c(F,{value:1},{default:m((()=>[f("启用")])),_:1}),c(F,{value:0},{default:m((()=>[f("停用")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}});export{b as default};
