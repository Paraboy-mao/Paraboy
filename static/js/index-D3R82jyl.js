import{l as t,aH as e,a as r,e as i,d as n,Y as o,ah as s,m as a,p as h,U as u,O as l,q as c,u as d,F as p,a7 as f,M as m,S as _,T as g,aE as y,aF as v}from"./vue-DiyBcK8j.js";import{g as b,b as x,h as T,a as E}from"./ElementPlus-Dxo_w5_G.js";import{_ as S}from"./index-DnOIoFi_.js";import"./axios-dB_UgXDe.js";function M(t,e){this.name="AggregateError",this.errors=t,this.message=e||""}M.prototype=Error.prototype;var P=setTimeout;function A(t){return Boolean(t&&void 0!==t.length)}function R(){}function w(t){if(!(this instanceof w))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],L(t,this)}function I(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,w._immediateFn((function(){var r=1===t._state?e.onFulfilled:e.onRejected;if(null!==r){var i;try{i=r(t._value)}catch(n){return void O(e.promise,n)}C(e.promise,i)}else(1===t._state?C:O)(e.promise,t._value)}))):t._deferreds.push(e)}function C(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if(e instanceof w)return t._state=3,t._value=e,void D(t);if("function"==typeof r)return void L((i=r,n=e,function(){i.apply(n,arguments)}),t)}t._state=1,t._value=e,D(t)}catch(o){O(t,o)}var i,n}function O(t,e){t._state=2,t._value=e,D(t)}function D(t){2===t._state&&0===t._deferreds.length&&w._immediateFn((function(){t._handled||w._unhandledRejectionFn(t._value)}));for(var e=0,r=t._deferreds.length;e<r;e++)I(t,t._deferreds[e]);t._deferreds=null}function F(t,e,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=r}function L(t,e){var r=!1;try{t((function(t){r||(r=!0,C(e,t))}),(function(t){r||(r=!0,O(e,t))}))}catch(i){if(r)return;r=!0,O(e,i)}}w.prototype.catch=function(t){return this.then(null,t)},w.prototype.then=function(t,e){var r=new this.constructor(R);return I(this,new F(t,e,r)),r},w.prototype.finally=function(t){var e=this.constructor;return this.then((function(r){return e.resolve(t()).then((function(){return r}))}),(function(r){return e.resolve(t()).then((function(){return e.reject(r)}))}))},w.all=function(t){return new w((function(e,r){if(!A(t))return r(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var n=i.length;function o(t,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,(function(e){o(t,e)}),r)}i[t]=s,0==--n&&e(i)}catch(h){r(h)}}for(var s=0;s<i.length;s++)o(s,i[s])}))},w.any=function(t){var e=this;return new e((function(r,i){if(!t||void 0===t.length)return i(new TypeError("Promise.any accepts an array"));var n=Array.prototype.slice.call(t);if(0===n.length)return i();for(var o=[],s=0;s<n.length;s++)try{e.resolve(n[s]).then(r).catch((function(t){o.push(t),o.length===n.length&&i(new M(o,"All promises were rejected"))}))}catch(a){i(a)}}))},w.allSettled=function(t){return new this((function(e,r){if(!t||void 0===t.length)return r(new TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var n=i.length;function o(t,r){if(r&&("object"==typeof r||"function"==typeof r)){var s=r.then;if("function"==typeof s)return void s.call(r,(function(e){o(t,e)}),(function(r){i[t]={status:"rejected",reason:r},0==--n&&e(i)}))}i[t]={status:"fulfilled",value:r},0==--n&&e(i)}for(var s=0;s<i.length;s++)o(s,i[s])}))},w.resolve=function(t){return t&&"object"==typeof t&&t.constructor===w?t:new w((function(e){e(t)}))},w.reject=function(t){return new w((function(e,r){r(t)}))},w.race=function(t){return new w((function(e,r){if(!A(t))return r(new TypeError("Promise.race accepts an array"));for(var i=0,n=t.length;i<n;i++)w.resolve(t[i]).then(e,r)}))},w._immediateFn=// @ts-ignore
"function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){P(t,0)},w._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console};
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var B=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;const G=b(function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(n){return!1}}()?Object.assign:function(t,e){for(var r,i,n=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),o=1;o<arguments.length;o++){for(var s in r=Object(arguments[o]))N.call(r,s)&&(n[s]=r[s]);if(B){i=B(r);for(var a=0;a<i.length;a++)U.call(r,i[a])&&(n[i[a]]=r[i[a]])}}return n});
/*!
 * @pixi/polyfill - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */"undefined"==typeof globalThis&&("undefined"!=typeof self?self.globalThis=self:"undefined"!=typeof global&&(global.globalThis=global)),globalThis.Promise||(globalThis.Promise=w),Object.assign||(Object.assign=G);if(Date.now&&Date.prototype.getTime||(Date.now=function(){
return(new Date).getTime()}),!globalThis.performance||!globalThis.performance.now){var k=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-k}}for(var X,j,V,H,Y,z,W,q,K,Z,$,J,Q,tt,et,rt,it,nt,ot,st,at,ht,ut,lt,ct,dt,pt,ft,mt,_t,gt,yt,vt,bt,xt,Tt,Et,St,Mt,Pt,At=Date.now(),Rt=["ms","moz","webkit","o"],wt=0;wt<Rt.length&&!globalThis.requestAnimationFrame;++wt){var It=Rt[wt];globalThis.requestAnimationFrame=globalThis[It+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[It+"CancelAnimationFrame"]||globalThis[It+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),r=16+At-e;return r<0&&(r=0),At=e,globalThis.self.setTimeout((function(){At=Date.now(),t(performance.now())}),r)}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array)
/*!
 * @pixi/constants - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */,(j=X||(X={}))[j.WEBGL_LEGACY=0]="WEBGL_LEGACY",j[j.WEBGL=1]="WEBGL",j[j.WEBGL2=2]="WEBGL2",(H=V||(V={}))[H.UNKNOWN=0]="UNKNOWN",H[H.WEBGL=1]="WEBGL",H[H.CANVAS=2]="CANVAS",(z=Y||(Y={}))[z.COLOR=16384]="COLOR",z[z.DEPTH=256]="DEPTH",z[z.STENCIL=1024]="STENCIL",(q=W||(W={}))[q.NORMAL=0]="NORMAL",q[q.ADD=1]="ADD",q[q.MULTIPLY=2]="MULTIPLY",q[q.SCREEN=3]="SCREEN",q[q.OVERLAY=4]="OVERLAY",q[q.DARKEN=5]="DARKEN",q[q.LIGHTEN=6]="LIGHTEN",q[q.COLOR_DODGE=7]="COLOR_DODGE",q[q.COLOR_BURN=8]="COLOR_BURN",q[q.HARD_LIGHT=9]="HARD_LIGHT",q[q.SOFT_LIGHT=10]="SOFT_LIGHT",q[q.DIFFERENCE=11]="DIFFERENCE",q[q.EXCLUSION=12]="EXCLUSION",q[q.HUE=13]="HUE",q[q.SATURATION=14]="SATURATION",q[q.COLOR=15]="COLOR",q[q.LUMINOSITY=16]="LUMINOSITY",q[q.NORMAL_NPM=17]="NORMAL_NPM",q[q.ADD_NPM=18]="ADD_NPM",q[q.SCREEN_NPM=19]="SCREEN_NPM",q[q.NONE=20]="NONE",q[q.SRC_OVER=0]="SRC_OVER",q[q.SRC_IN=21]="SRC_IN",q[q.SRC_OUT=22]="SRC_OUT",q[q.SRC_ATOP=23]="SRC_ATOP",q[q.DST_OVER=24]="DST_OVER",q[q.DST_IN=25]="DST_IN",q[q.DST_OUT=26]="DST_OUT",q[q.DST_ATOP=27]="DST_ATOP",q[q.ERASE=26]="ERASE",q[q.SUBTRACT=28]="SUBTRACT",q[q.XOR=29]="XOR",(Z=K||(K={}))[Z.POINTS=0]="POINTS",Z[Z.LINES=1]="LINES",Z[Z.LINE_LOOP=2]="LINE_LOOP",Z[Z.LINE_STRIP=3]="LINE_STRIP",Z[Z.TRIANGLES=4]="TRIANGLES",Z[Z.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Z[Z.TRIANGLE_FAN=6]="TRIANGLE_FAN",(J=$||($={}))[J.RGBA=6408]="RGBA",J[J.RGB=6407]="RGB",J[J.RG=33319]="RG",J[J.RED=6403]="RED",J[J.RGBA_INTEGER=36249]="RGBA_INTEGER",J[J.RGB_INTEGER=36248]="RGB_INTEGER",J[J.RG_INTEGER=33320]="RG_INTEGER",J[J.RED_INTEGER=36244]="RED_INTEGER",J[J.ALPHA=6406]="ALPHA",J[J.LUMINANCE=6409]="LUMINANCE",J[J.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",J[J.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",J[J.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(tt=Q||(Q={}))[tt.TEXTURE_2D=3553]="TEXTURE_2D",tt[tt.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",tt[tt.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",tt[tt.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",tt[tt.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",tt[tt.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",tt[tt.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",tt[tt.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",tt[tt.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(rt=et||(et={}))[rt.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",rt[rt.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",rt[rt.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",rt[rt.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",rt[rt.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",rt[rt.UNSIGNED_INT=5125]="UNSIGNED_INT",rt[rt.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",rt[rt.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",rt[rt.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",rt[rt.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",rt[rt.BYTE=5120]="BYTE",rt[rt.SHORT=5122]="SHORT",rt[rt.INT=5124]="INT",rt[rt.FLOAT=5126]="FLOAT",rt[rt.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",rt[rt.HALF_FLOAT=36193]="HALF_FLOAT",(nt=it||(it={}))[nt.FLOAT=0]="FLOAT",nt[nt.INT=1]="INT",nt[nt.UINT=2]="UINT",(st=ot||(ot={}))[st.NEAREST=0]="NEAREST",st[st.LINEAR=1]="LINEAR",(ht=at||(at={}))[ht.CLAMP=33071]="CLAMP",ht[ht.REPEAT=10497]="REPEAT",ht[ht.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(lt=ut||(ut={}))[lt.OFF=0]="OFF",lt[lt.POW2=1]="POW2",lt[lt.ON=2]="ON",lt[lt.ON_MANUAL=3]="ON_MANUAL",(dt=ct||(ct={}))[dt.NPM=0]="NPM",dt[dt.UNPACK=1]="UNPACK",dt[dt.PMA=2]="PMA",dt[dt.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",dt[dt.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",dt[dt.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",dt[dt.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",(ft=pt||(pt={}))[ft.NO=0]="NO",ft[ft.YES=1]="YES",ft[ft.AUTO=2]="AUTO",ft[ft.BLEND=0]="BLEND",ft[ft.CLEAR=1]="CLEAR",ft[ft.BLIT=2]="BLIT",(_t=mt||(mt={}))[_t.AUTO=0]="AUTO",_t[_t.MANUAL=1]="MANUAL",(yt=gt||(gt={})).LOW="lowp",yt.MEDIUM="mediump",yt.HIGH="highp",(bt=vt||(vt={}))[bt.NONE=0]="NONE",bt[bt.SCISSOR=1]="SCISSOR",bt[bt.STENCIL=2]="STENCIL",bt[bt.SPRITE=3]="SPRITE",bt[bt.COLOR=4]="COLOR",(Tt=xt||(xt={}))[Tt.RED=1]="RED",Tt[Tt.GREEN=2]="GREEN",Tt[Tt.BLUE=4]="BLUE",Tt[Tt.ALPHA=8]="ALPHA",(St=Et||(Et={}))[St.NONE=0]="NONE",St[St.LOW=2]="LOW",St[St.MEDIUM=4]="MEDIUM",St[St.HIGH=8]="HIGH",(Pt=Mt||(Mt={}))[Pt.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",Pt[Pt.ARRAY_BUFFER=34962]="ARRAY_BUFFER",Pt[Pt.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";
/*!
 * @pixi/settings - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Ct={
/**
   * Creates a canvas element of the given size.
   * This canvas is created using the browser's native canvas element.
   * @param width - width of the canvas
   * @param height - height of the canvas
   */
createCanvas:function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,r},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var t;return null!==(t=document.baseURI)&&void 0!==t?t:window.location.href},fetch:function(t,e){return fetch(t,e)}},Ot=/iPhone/i,Dt=/iPod/i,Ft=/iPad/i,Lt=/\biOS-universal(?:.+)Mac\b/i,Bt=/\bAndroid(?:.+)Mobile\b/i,Nt=/Android/i,Ut=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Gt=/Silk/i,kt=/Windows Phone/i,Xt=/\bWindows(?:.+)ARM\b/i,jt=/BlackBerry/i,Vt=/BB10/i,Ht=/Opera Mini/i,Yt=/\b(CriOS|Chrome)(?:.+)Mobile/i,zt=/Mobile(?:.+)Firefox\b/i,Wt=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};var qt=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),o={apple:{phone:n(Ot)&&!n(kt),ipod:n(Dt),tablet:!n(Ot)&&(n(Ft)||Wt(e))&&!n(kt),universal:n(Lt),device:(n(Ot)||n(Dt)||n(Ft)||n(Lt)||Wt(e))&&!n(kt)},amazon:{phone:n(Ut),tablet:!n(Ut)&&n(Gt),device:n(Ut)||n(Gt)},android:{phone:!n(kt)&&n(Ut)||!n(kt)&&n(Bt),tablet:!n(kt)&&!n(Ut)&&!n(Bt)&&(n(Gt)||n(Nt)),device:!n(kt)&&(n(Ut)||n(Gt)||n(Bt)||n(Nt))||n(/\bokhttp\b/i)},windows:{phone:n(kt),tablet:n(Xt),device:n(kt)||n(Xt)},other:{blackberry:n(jt),blackberry10:n(Vt),opera:n(Ht),firefox:n(zt),chrome:n(Yt),device:n(jt)||n(Vt)||n(Ht)||n(zt)||n(Yt)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}(globalThis.navigator);var Kt={
/**
   * This adapter is used to call methods that are platform dependent.
   * For example `document.createElement` only runs on the web but fails in node environments.
   * This allows us to support more platforms by abstracting away specific implementations per platform.
   *
   * By default the adapter is set to work in the browser. However you can create your own
   * by implementing the `IAdapter` interface. See `IAdapter` for more information.
   * @name ADAPTER
   * @memberof PIXI.settings
   * @type {PIXI.IAdapter}
   * @default PIXI.BrowserAdapter
   */
ADAPTER:Ct,
/**
   * If set to true WebGL will attempt make textures mimpaped by default.
   * Mipmapping will only succeed if the base texture uploaded has power of two dimensions.
   * @static
   * @name MIPMAP_TEXTURES
   * @memberof PIXI.settings
   * @type {PIXI.MIPMAP_MODES}
   * @default PIXI.MIPMAP_MODES.POW2
   */
MIPMAP_TEXTURES:ut.POW2,
/**
   * Default anisotropic filtering level of textures.
   * Usually from 0 to 16
   * @static
   * @name ANISOTROPIC_LEVEL
   * @memberof PIXI.settings
   * @type {number}
   * @default 0
   */
ANISOTROPIC_LEVEL:0,
/**
   * Default resolution / device pixel ratio of the renderer.
   * @static
   * @name RESOLUTION
   * @memberof PIXI.settings
   * @type {number}
   * @default 1
   */
RESOLUTION:1,
/**
   * Default filter resolution.
   * @static
   * @name FILTER_RESOLUTION
   * @memberof PIXI.settings
   * @type {number}
   * @default 1
   */
FILTER_RESOLUTION:1,
/**
   * Default filter samples.
   * @static
   * @name FILTER_MULTISAMPLE
   * @memberof PIXI.settings
   * @type {PIXI.MSAA_QUALITY}
   * @default PIXI.MSAA_QUALITY.NONE
   */
FILTER_MULTISAMPLE:Et.NONE,
/**
   * The maximum textures that this device supports.
   * @static
   * @name SPRITE_MAX_TEXTURES
   * @memberof PIXI.settings
   * @type {number}
   * @default 32
   */
SPRITE_MAX_TEXTURES:function(t){var e=!0;if(qt.tablet||qt.phone){var r;if(qt.apple.device)if(r=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(r[1],10)<11&&(e=!1);if(qt.android.device)if(r=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(r[1],10)<7&&(e=!1)}return e?t:4}(32),
// TODO: maybe change to SPRITE.BATCH_SIZE: 2000
// TODO: maybe add PARTICLE.BATCH_SIZE: 15000
/**
   * The default sprite batch size.
   *
   * The default aims to balance desktop and mobile devices.
   * @static
   * @name SPRITE_BATCH_SIZE
   * @memberof PIXI.settings
   * @type {number}
   * @default 4096
   */
SPRITE_BATCH_SIZE:4096,
/**
   * The default render options if none are supplied to {@link PIXI.Renderer}
   * or {@link PIXI.CanvasRenderer}.
   * @static
   * @name RENDER_OPTIONS
   * @memberof PIXI.settings
   * @type {object}
   * @property {boolean} [antialias=false] - {@link PIXI.IRendererOptions.antialias}
   * @property {boolean} [autoDensity=false] - {@link PIXI.IRendererOptions.autoDensity}
   * @property {number} [backgroundAlpha=1] - {@link PIXI.IRendererOptions.backgroundAlpha}
   * @property {number} [backgroundColor=0x000000] - {@link PIXI.IRendererOptions.backgroundColor}
   * @property {boolean} [clearBeforeRender=true] - {@link PIXI.IRendererOptions.clearBeforeRender}
   * @property {number} [height=600] - {@link PIXI.IRendererOptions.height}
   * @property {boolean} [preserveDrawingBuffer=false] - {@link PIXI.IRendererOptions.preserveDrawingBuffer}
   * @property {boolean|'notMultiplied'} [useContextAlpha=true] - {@link PIXI.IRendererOptions.useContextAlpha}
   * @property {HTMLCanvasElement} [view=null] - {@link PIXI.IRendererOptions.view}
   * @property {number} [width=800] - {@link PIXI.IRendererOptions.width}
   */
RENDER_OPTIONS:{view:null,width:800,height:600,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,antialias:!1,preserveDrawingBuffer:!1},
/**
   * Default Garbage Collection mode.
   * @static
   * @name GC_MODE
   * @memberof PIXI.settings
   * @type {PIXI.GC_MODES}
   * @default PIXI.GC_MODES.AUTO
   */
GC_MODE:mt.AUTO,
/**
   * Default Garbage Collection max idle.
   * @static
   * @name GC_MAX_IDLE
   * @memberof PIXI.settings
   * @type {number}
   * @default 3600
   */
GC_MAX_IDLE:3600,
/**
   * Default Garbage Collection maximum check count.
   * @static
   * @name GC_MAX_CHECK_COUNT
   * @memberof PIXI.settings
   * @type {number}
   * @default 600
   */
GC_MAX_CHECK_COUNT:600,
/**
   * Default wrap modes that are supported by pixi.
   * @static
   * @name WRAP_MODE
   * @memberof PIXI.settings
   * @type {PIXI.WRAP_MODES}
   * @default PIXI.WRAP_MODES.CLAMP
   */
WRAP_MODE:at.CLAMP,
/**
   * Default scale mode for textures.
   * @static
   * @name SCALE_MODE
   * @memberof PIXI.settings
   * @type {PIXI.SCALE_MODES}
   * @default PIXI.SCALE_MODES.LINEAR
   */
SCALE_MODE:ot.LINEAR,
/**
   * Default specify float precision in vertex shader.
   * @static
   * @name PRECISION_VERTEX
   * @memberof PIXI.settings
   * @type {PIXI.PRECISION}
   * @default PIXI.PRECISION.HIGH
   */
PRECISION_VERTEX:gt.HIGH,
/**
   * Default specify float precision in fragment shader.
   * iOS is best set at highp due to https://github.com/pixijs/pixi.js/issues/3742
   * @static
   * @name PRECISION_FRAGMENT
   * @memberof PIXI.settings
   * @type {PIXI.PRECISION}
   * @default PIXI.PRECISION.MEDIUM
   */
PRECISION_FRAGMENT:qt.apple.device?gt.HIGH:gt.MEDIUM,
/**
   * Can we upload the same buffer in a single frame?
   * @static
   * @name CAN_UPLOAD_SAME_BUFFER
   * @memberof PIXI.settings
   * @type {boolean}
   */
CAN_UPLOAD_SAME_BUFFER:!qt.apple.device,
/**
   * Enables bitmap creation before image load. This feature is experimental.
   * @static
   * @name CREATE_IMAGE_BITMAP
   * @memberof PIXI.settings
   * @type {boolean}
   * @default false
   */
CREATE_IMAGE_BITMAP:!1,
/**
   * If true PixiJS will Math.floor() x/y values when rendering, stopping pixel interpolation.
   * Advantages can include sharper image quality (like text) and faster rendering on canvas.
   * The main disadvantage is movement of objects may appear less smooth.
   * @static
   * @constant
   * @memberof PIXI.settings
   * @type {boolean}
   * @default false
   */
ROUND_PIXELS:!1},Zt={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,r="~";function i(){}function n(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,i,o,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new n(i,o||t,s),h=r?r+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,i,n=[];if(0===this._eventsCount)return n;for(i in t=this._events)e.call(t,i)&&n.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},a.prototype.listeners=function(t){var e=r?r+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,o=i.length,s=new Array(o);n<o;n++)s[n]=i[n].fn;return s},a.prototype.listenerCount=function(t){var e=r?r+t:t,i=this._events[e];return i?i.fn?1:i.length:0},a.prototype.emit=function(t,e,i,n,o,s){var a=r?r+t:t;if(!this._events[a])return!1;var h,u,l=this._events[a],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,i),!0;case 4:return l.fn.call(l.context,e,i,n),!0;case 5:return l.fn.call(l.context,e,i,n,o),!0;case 6:return l.fn.call(l.context,e,i,n,o,s),!0}for(u=1,h=new Array(c-1);u<c;u++)h[u-1]=arguments[u];l.fn.apply(l.context,h)}else{var d,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,i);break;case 4:l[u].fn.call(l[u].context,e,i,n);break;default:if(!h)for(d=1,h=new Array(c-1);d<c;d++)h[d-1]=arguments[d];l[u].fn.apply(l[u].context,h)}}return!0},a.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,i,n){var o=r?r+t:t;if(!this._events[o])return this;if(!e)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||n&&!a.once||i&&a.context!==i||s(this,o);else{for(var h=0,u=[],l=a.length;h<l;h++)(a[h].fn!==e||n&&!a[h].once||i&&a[h].context!==i)&&u.push(a[h]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&s(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a}(Zt);const $t=b(Zt.exports);var Jt={exports:{}};function Qt(t,e,r){r=r||2;var i,n,o,s,a,h,u,l=e&&e.length,c=l?e[0]*r:t.length,d=te(t,0,c,r,!0),p=[];if(!d||d.next===d.prev)return p;if(l&&(d=function(t,e,r,i){var n,o,s,a=[];for(n=0,o=e.length;n<o;n++)(s=te(t,e[n]*i,n<o-1?e[n+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(ce(s));for(a.sort(ae),n=0;n<a.length;n++)r=he(a[n],r);return r}(t,e,d,r)),t.length>80*r){i=o=t[0],n=s=t[1];for(var f=r;f<c;f+=r)(a=t[f])<i&&(i=a),(h=t[f+1])<n&&(n=h),a>o&&(o=a),h>s&&(s=h);u=0!==(u=Math.max(o-i,s-n))?32767/u:0}return re(d,p,r,i,n,u,0),p}function te(t,e,r,i,n){var o,s;if(n===Se(t,e,r,i)>0)for(o=e;o<r;o+=i)s=xe(o,t[o],t[o+1],s);else for(o=r-i;o>=e;o-=i)s=xe(o,t[o],t[o+1],s);return s&&me(s,s.next)&&(Te(s),s=s.next),s}function ee(t,e){if(!t)return t;e||(e=t);var r,i=t;do{if(r=!1,i.steiner||!me(i,i.next)&&0!==fe(i.prev,i,i.next))i=i.next;else{if(Te(i),(i=e=i.prev)===i.next)break;r=!0}}while(r||i!==e);return e}function re(t,e,r,i,n,o,s){if(t){!s&&o&&function(t,e,r,i){var n=t;do{0===n.z&&(n.z=le(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,r,i,n,o,s,a,h,u=1;do{for(r=t,t=null,o=null,s=0;r;){for(s++,i=r,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(h=u;a>0||h>0&&i;)0!==a&&(0===h||!i||r.z<=i.z)?(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,h--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;r=i}o.nextZ=null,u*=2}while(s>1)}(n)}(t,i,n,o);for(var a,h,u=t;t.prev!==t.next;)if(a=t.prev,h=t.next,o?ne(t,i,n,o):ie(t))e.push(a.i/r|0),e.push(t.i/r|0),e.push(h.i/r|0),Te(t),t=h.next,u=h.next;else if((t=h)===u){s?1===s?re(t=oe(ee(t),e,r),e,r,i,n,o,2):2===s&&se(t,e,r,i,n,o):re(ee(t),e,r,i,n,o,1);break}}}function ie(t){var e=t.prev,r=t,i=t.next;if(fe(e,r,i)>=0)return!1;for(var n=e.x,o=r.x,s=i.x,a=e.y,h=r.y,u=i.y,l=n<o?n<s?n:s:o<s?o:s,c=a<h?a<u?a:u:h<u?h:u,d=n>o?n>s?n:s:o>s?o:s,p=a>h?a>u?a:u:h>u?h:u,f=i.next;f!==e;){if(f.x>=l&&f.x<=d&&f.y>=c&&f.y<=p&&de(n,a,o,h,s,u,f.x,f.y)&&fe(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function ne(t,e,r,i){var n=t.prev,o=t,s=t.next;if(fe(n,o,s)>=0)return!1;for(var a=n.x,h=o.x,u=s.x,l=n.y,c=o.y,d=s.y,p=a<h?a<u?a:u:h<u?h:u,f=l<c?l<d?l:d:c<d?c:d,m=a>h?a>u?a:u:h>u?h:u,_=l>c?l>d?l:d:c>d?c:d,g=le(p,f,e,r,i),y=le(m,_,e,r,i),v=t.prevZ,b=t.nextZ;v&&v.z>=g&&b&&b.z<=y;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=_&&v!==n&&v!==s&&de(a,l,h,c,u,d,v.x,v.y)&&fe(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,b.x>=p&&b.x<=m&&b.y>=f&&b.y<=_&&b!==n&&b!==s&&de(a,l,h,c,u,d,b.x,b.y)&&fe(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;v&&v.z>=g;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=_&&v!==n&&v!==s&&de(a,l,h,c,u,d,v.x,v.y)&&fe(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;b&&b.z<=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=_&&b!==n&&b!==s&&de(a,l,h,c,u,d,b.x,b.y)&&fe(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function oe(t,e,r){var i=t;do{var n=i.prev,o=i.next.next;!me(n,o)&&_e(n,i,i.next,o)&&ve(n,o)&&ve(o,n)&&(e.push(n.i/r|0),e.push(i.i/r|0),e.push(o.i/r|0),Te(i),Te(i.next),i=t=o),i=i.next}while(i!==t);return ee(i)}function se(t,e,r,i,n,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&pe(s,a)){var h=be(s,a);return s=ee(s,s.next),h=ee(h,h.next),re(s,e,r,i,n,o,0),void re(h,e,r,i,n,o,0)}a=a.next}s=s.next}while(s!==t)}function ae(t,e){return t.x-e.x}function he(t,e){var r=function(t,e){var r,i=e,n=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=n&&a>s&&(s=a,r=i.x<i.next.x?i:i.next,a===n))return r}i=i.next}while(i!==e);if(!r)return null;var h,u=r,l=r.x,c=r.y,d=1/0;i=r;do{n>=i.x&&i.x>=l&&n!==i.x&&de(o<c?n:s,o,l,c,o<c?s:n,o,i.x,i.y)&&(h=Math.abs(o-i.y)/(n-i.x),ve(i,t)&&(h<d||h===d&&(i.x>r.x||i.x===r.x&&ue(r,i)))&&(r=i,d=h)),i=i.next}while(i!==u);return r}(t,e);if(!r)return e;var i=be(r,t);return ee(i,i.next),ee(r,r.next)}function ue(t,e){return fe(t.prev,t,e.prev)<0&&fe(e.next,t,t.next)<0}function le(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ce(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function de(t,e,r,i,n,o,s,a){return(n-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(r-s)*(e-a)&&(r-s)*(o-a)>=(n-s)*(i-a)}function pe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&_e(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(// dones't intersect other edges
ve(t,e)&&ve(e,t)&&function(t,e){var r=t,i=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==t);return i}(t,e)&&(// locally visible
fe(t.prev,t,e.prev)||fe(t,e.prev,e))||// does not create opposite-facing sectors
me(t,e)&&fe(t.prev,t,t.next)>0&&fe(e.prev,e,e.next)>0)}function fe(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function me(t,e){return t.x===e.x&&t.y===e.y}function _e(t,e,r,i){var n=ye(fe(t,e,r)),o=ye(fe(t,e,i)),s=ye(fe(r,i,t)),a=ye(fe(r,i,e));return n!==o&&s!==a||(!(0!==n||!ge(t,r,e))||(!(0!==o||!ge(t,i,e))||(!(0!==s||!ge(r,t,i))||!(0!==a||!ge(r,e,i)))))}function ge(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function ye(t){return t>0?1:t<0?-1:0}function ve(t,e){return fe(t.prev,t,t.next)<0?fe(t,e,t.next)>=0&&fe(t,t.prev,e)>=0:fe(t,e,t.prev)<0||fe(t,t.next,e)<0}function be(t,e){var r=new Ee(t.i,t.x,t.y),i=new Ee(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function xe(t,e,r,i){var n=new Ee(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Te(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ee(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Se(t,e,r,i){for(var n=0,o=e,s=r-i;o<r;o+=i)n+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return n}Jt.exports=Qt,Jt.exports.default=Qt,Qt.deviation=function(t,e,r,i){var n=e&&e.length,o=n?e[0]*r:t.length,s=Math.abs(Se(t,0,o,r));if(n)for(var a=0,h=e.length;a<h;a++){var u=e[a]*r,l=a<h-1?e[a+1]*r:t.length;s-=Math.abs(Se(t,u,l,r))}var c=0;for(a=0;a<i.length;a+=3){var d=i[a]*r,p=i[a+1]*r,f=i[a+2]*r;c+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},Qt.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var s=0;s<e;s++)r.vertices.push(t[n][o][s]);n>0&&(i+=t[n-1].length,r.holes.push(i))}return r};const Me=b(Jt.exports);var Pe,Ae,Re={exports:{}};
/*! https://mths.be/punycode v1.4.1 by @mathias */Pe=Re,Ae=Re.exports,function(t){var e=Ae&&!Ae.nodeType&&Ae,r=Pe&&!Pe.nodeType&&Pe,i="object"==typeof x&&x;i.global!==i&&i.window!==i&&i.self!==i||(t=i);var n,o,s=2147483647,a=36,h=1,u=26,l=38,c=700,d=72,p=128,f="-",m=/^xn--/,_=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=a-h,b=Math.floor,T=String.fromCharCode;function E(t){throw new RangeError(y[t])}function S(t,e){for(var r=t.length,i=[];r--;)i[r]=e(t[r]);return i}function M(t,e){var r=t.split("@"),i="";return r.length>1&&(i=r[0]+"@",t=r[1]),i+S((t=t.replace(g,".")).split("."),e).join(".")}function P(t){for(var e,r,i=[],n=0,o=t.length;n<o;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<o?56320==(64512&(r=t.charCodeAt(n++)))?i.push(((1023&e)<<10)+(1023&r)+65536):(i.push(e),n--):i.push(e);return i}function A(t){return S(t,(function(t){var e="";return t>65535&&(e+=T((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=T(t)})).join("")}function R(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function w(t,e,r){var i=0;for(t=r?b(t/c):t>>1,t+=b(t/e);t>v*u>>1;i+=a)t=b(t/v);return b(i+(v+1)*t/(t+l))}function I(t){var e,r,i,n,o,l,c,m,_,g,y,v=[],x=t.length,T=0,S=p,M=d;for((r=t.lastIndexOf(f))<0&&(r=0),i=0;i<r;++i)t.charCodeAt(i)>=128&&E("not-basic"),v.push(t.charCodeAt(i));for(n=r>0?r+1:0;n<x;){for(o=T,l=1,c=a;n>=x&&E("invalid-input"),((m=(y=t.charCodeAt(n++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:a)>=a||m>b((s-T)/l))&&E("overflow"),T+=m*l,!(m<(_=c<=M?h:c>=M+u?u:c-M));c+=a)l>b(s/(g=a-_))&&E("overflow"),l*=g;M=w(T-o,e=v.length+1,0==o),b(T/e)>s-S&&E("overflow"),S+=b(T/e),T%=e,v.splice(T++,0,S)}return A(v)}function C(t){var e,r,i,n,o,l,c,m,_,g,y,v,x,S,M,A=[];for(v=(t=P(t)).length,e=p,r=0,o=d,l=0;l<v;++l)(y=t[l])<128&&A.push(T(y));for(i=n=A.length,n&&A.push(f);i<v;){for(c=s,l=0;l<v;++l)(y=t[l])>=e&&y<c&&(c=y);for(c-e>b((s-r)/(x=i+1))&&E("overflow"),r+=(c-e)*x,e=c,l=0;l<v;++l)if((y=t[l])<e&&++r>s&&E("overflow"),y==e){for(m=r,_=a;!(m<(g=_<=o?h:_>=o+u?u:_-o));_+=a)M=m-g,S=a-g,A.push(T(R(g+M%S,0))),m=b(M/S);A.push(T(R(m,0))),o=w(r,x,i==n),r=0,++i}++r,++e}return A.join("")}if(n={
/**
       * A string representing the current Punycode.js version number.
       * @memberOf punycode
       * @type String
       */
version:"1.4.1",
/**
       * An object of methods to convert from JavaScript's internal character
       * representation (UCS-2) to Unicode code points, and back.
       * @see <https://mathiasbynens.be/notes/javascript-encoding>
       * @memberOf punycode
       * @type Object
       */
ucs2:{decode:P,encode:A},decode:I,encode:C,toASCII:function(t){return M(t,(function(t){return _.test(t)?"xn--"+C(t):t}))},toUnicode:function(t){return M(t,(function(t){return m.test(t)?I(t.slice(4).toLowerCase()):t}))}},e&&r)if(Pe.exports==e)r.exports=n;else for(o in n)n.hasOwnProperty(o)&&(e[o]=n[o]);else t.punycode=n}(x);var we,Ie=Re.exports,Ce=Error,Oe=EvalError,De=RangeError,Fe=ReferenceError,Le=SyntaxError,Be=TypeError,Ne=URIError,Ue="undefined"!=typeof Symbol&&Symbol,Ge=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),r=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var i=Object.getOwnPropertySymbols(t);if(1!==i.length||i[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var n=Object.getOwnPropertyDescriptor(t,e);if(42!==n.value||!0!==n.enumerable)return!1}return!0},ke={__proto__:null,foo:{}},Xe=Object,je=Object.prototype.toString,Ve=Math.max,He=function(t,e){for(var r=[],i=0;i<t.length;i+=1)r[i]=t[i];for(var n=0;n<e.length;n+=1)r[n+t.length]=e[n];return r},Ye=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==je.apply(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var r,i=function(t,e){for(var r=[],i=e||0,n=0;i<t.length;i+=1,n+=1)r[n]=t[i];return r}(arguments,1),n=Ve(0,e.length-i.length),o=[],s=0;s<n;s++)o[s]="$"+s;if(r=Function("binder","return function ("+function(t,e){for(var r="",i=0;i<t.length;i+=1)r+=t[i],i+1<t.length&&(r+=e);return r}(o,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof r){var n=e.apply(this,He(i,arguments));return Object(n)===n?n:this}return e.apply(t,He(i,arguments))})),e.prototype){var a=function(){};a.prototype=e.prototype,r.prototype=new a,a.prototype=null}return r},ze=Function.prototype.bind||Ye,We=Function.prototype.call,qe=Object.prototype.hasOwnProperty,Ke=ze.call(We,qe),Ze=Ce,$e=Oe,Je=De,Qe=Fe,tr=Le,er=Be,rr=Ne,ir=Function,nr=function(t){try{return ir('"use strict"; return ('+t+").constructor;")()}catch(e){}},or=Object.getOwnPropertyDescriptor;if(or)try{or({},"")}catch(pm){or=null}var sr=function(){throw new er},ar=or?function(){try{return sr}catch(t){try{return or(arguments,"callee").get}catch(e){return sr}}}():sr,hr="function"==typeof Ue&&"function"==typeof Symbol&&"symbol"==typeof Ue("foo")&&"symbol"==typeof Symbol("bar")&&Ge(),ur={__proto__:ke}.foo===ke.foo&&!(ke instanceof Xe),lr=Object.getPrototypeOf||(ur?function(t){return t.__proto__}:null),cr={},dr="undefined"!=typeof Uint8Array&&lr?lr(Uint8Array):we,pr={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?we:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?we:ArrayBuffer,"%ArrayIteratorPrototype%":hr&&lr?lr([][Symbol.iterator]()):we,"%AsyncFromSyncIteratorPrototype%":we,"%AsyncFunction%":cr,"%AsyncGenerator%":cr,"%AsyncGeneratorFunction%":cr,"%AsyncIteratorPrototype%":cr,"%Atomics%":"undefined"==typeof Atomics?we:Atomics,"%BigInt%":"undefined"==typeof BigInt?we:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?we:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?we:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?we:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Ze,"%eval%":eval,
// eslint-disable-line no-eval
"%EvalError%":$e,"%Float32Array%":"undefined"==typeof Float32Array?we:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?we:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?we:FinalizationRegistry,"%Function%":ir,"%GeneratorFunction%":cr,"%Int8Array%":"undefined"==typeof Int8Array?we:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?we:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?we:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hr&&lr?lr(lr([][Symbol.iterator]())):we,"%JSON%":"object"==typeof JSON?JSON:we,"%Map%":"undefined"==typeof Map?we:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&hr&&lr?lr((new Map)[Symbol.iterator]()):we,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?we:Promise,"%Proxy%":"undefined"==typeof Proxy?we:Proxy,"%RangeError%":Je,"%ReferenceError%":Qe,"%Reflect%":"undefined"==typeof Reflect?we:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?we:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&hr&&lr?lr((new Set)[Symbol.iterator]()):we,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?we:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hr&&lr?lr(""[Symbol.iterator]()):we,"%Symbol%":hr?Symbol:we,"%SyntaxError%":tr,"%ThrowTypeError%":ar,"%TypedArray%":dr,"%TypeError%":er,"%Uint8Array%":"undefined"==typeof Uint8Array?we:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?we:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?we:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?we:Uint32Array,"%URIError%":rr,"%WeakMap%":"undefined"==typeof WeakMap?we:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?we:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?we:WeakSet};if(lr)try{null.error}catch(pm){var fr=lr(lr(pm));pr["%Error.prototype%"]=fr}var mr,_r,gr=function t(e){var r;if("%AsyncFunction%"===e)r=nr("async function () {}");else if("%GeneratorFunction%"===e)r=nr("function* () {}");else if("%AsyncGeneratorFunction%"===e)r=nr("async function* () {}");else if("%AsyncGenerator%"===e){var i=t("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if("%AsyncIteratorPrototype%"===e){var n=t("%AsyncGenerator%");n&&lr&&(r=lr(n.prototype))}return pr[e]=r,r},yr={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},vr=ze,br=Ke,xr=vr.call(Function.call,Array.prototype.concat),Tr=vr.call(Function.apply,Array.prototype.splice),Er=vr.call(Function.call,String.prototype.replace),Sr=vr.call(Function.call,String.prototype.slice),Mr=vr.call(Function.call,RegExp.prototype.exec),Pr=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Ar=/\\(\\)?/g,Rr=function(t,e){var r,i=t;if(br(yr,i)&&(i="%"+(r=yr[i])[0]+"%"),br(pr,i)){var n=pr[i];if(n===cr&&(n=gr(i)),void 0===n&&!e)throw new er("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:r,name:i,value:n}}throw new tr("intrinsic "+t+" does not exist!")},wr=function(t,e){if("string"!=typeof t||0===t.length)throw new er("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new er('"allowMissing" argument must be a boolean');if(null===Mr(/^%?[^%]*%?$/,t))throw new tr("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(t){var e=Sr(t,0,1),r=Sr(t,-1);if("%"===e&&"%"!==r)throw new tr("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==e)throw new tr("invalid intrinsic syntax, expected opening `%`");var i=[];return Er(t,Pr,(function(t,e,r,n){i[i.length]=r?Er(n,Ar,"$1"):e||t})),i}(t),i=r.length>0?r[0]:"",n=Rr("%"+i+"%",e),o=n.name,s=n.value,a=!1,h=n.alias;h&&(i=h[0],Tr(r,xr([0,1],h)));for(var u=1,l=!0;u<r.length;u+=1){var c=r[u],d=Sr(c,0,1),p=Sr(c,-1);if(('"'===d||"'"===d||"`"===d||'"'===p||"'"===p||"`"===p)&&d!==p)throw new tr("property names with quotes must have matching quotes");if("constructor"!==c&&l||(a=!0),br(pr,o="%"+(i+="."+c)+"%"))s=pr[o];else if(null!=s){if(!(c in s)){if(!e)throw new er("base intrinsic for "+t+" exists, but the property is not available.");return}if(or&&u+1>=r.length){var f=or(s,c);s=(l=!!f)&&"get"in f&&!("originalValue"in f.get)?f.get:s[c]}else l=br(s,c),s=s[c];l&&!a&&(pr[o]=s)}}return s},Ir={exports:{}};function Cr(){if(_r)return mr;_r=1;var t=wr("%Object.defineProperty%",!0)||!1;if(t)try{t({},"a",{value:1})}catch(pm){t=!1}return mr=t}var Or=wr("%Object.getOwnPropertyDescriptor%",!0);if(Or)try{Or([],"length")}catch(pm){Or=null}var Dr=Or,Fr=Cr(),Lr=Le,Br=Be,Nr=Dr,Ur=Cr(),Gr=function(){return!!Ur};Gr.hasArrayLengthDefineBug=function(){if(!Ur)return null;try{return 1!==Ur([],"length",{value:1}).length}catch(pm){return!0}};var kr=wr,Xr=function(t,e,r){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new Br("`obj` must be an object or a function`");if("string"!=typeof e&&"symbol"!=typeof e)throw new Br("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new Br("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new Br("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new Br("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new Br("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,n=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,s=arguments.length>6&&arguments[6],a=!!Nr&&Nr(t,e);if(Fr)Fr(t,e,{configurable:null===o&&a?a.configurable:!o,enumerable:null===i&&a?a.enumerable:!i,value:r,writable:null===n&&a?a.writable:!n});else{if(!s&&(i||n||o))throw new Lr("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");t[e]=r}},jr=Gr(),Vr=Dr,Hr=Be,Yr=kr("%Math.floor%"),zr=function(t,e){if("function"!=typeof t)throw new Hr("`fn` is not a function");if("number"!=typeof e||e<0||e>4294967295||Yr(e)!==e)throw new Hr("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],i=!0,n=!0;if("length"in t&&Vr){var o=Vr(t,"length");o&&!o.configurable&&(i=!1),o&&!o.writable&&(n=!1)}return(i||n||!r)&&(jr?Xr(
/** @type {Parameters<define>[0]} */
t,"length",e,!0,!0):Xr(
/** @type {Parameters<define>[0]} */
t,"length",e)),t};!function(t){var e=ze,r=wr,i=zr,n=Be,o=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),a=r("%Reflect.apply%",!0)||e.call(s,o),h=Cr(),u=r("%Math.max%");t.exports=function(t){if("function"!=typeof t)throw new n("a function is required");var r=a(e,s,arguments);return i(r,1+u(0,t.length-(arguments.length-1)),!0)};var l=function(){return a(e,o,arguments)};h?h(t.exports,"apply",{value:l}):t.exports.apply=l}(Ir);var Wr=wr,qr=Ir.exports,Kr=qr(Wr("String.prototype.indexOf"));const Zr=T(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var $r="function"==typeof Map&&Map.prototype,Jr=Object.getOwnPropertyDescriptor&&$r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Qr=$r&&Jr&&"function"==typeof Jr.get?Jr.get:null,ti=$r&&Map.prototype.forEach,ei="function"==typeof Set&&Set.prototype,ri=Object.getOwnPropertyDescriptor&&ei?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,ii=ei&&ri&&"function"==typeof ri.get?ri.get:null,ni=ei&&Set.prototype.forEach,oi="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,si="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,ai="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,hi=Boolean.prototype.valueOf,ui=Object.prototype.toString,li=Function.prototype.toString,ci=String.prototype.match,di=String.prototype.slice,pi=String.prototype.replace,fi=String.prototype.toUpperCase,mi=String.prototype.toLowerCase,_i=RegExp.prototype.test,gi=Array.prototype.concat,yi=Array.prototype.join,vi=Array.prototype.slice,bi=Math.floor,xi="function"==typeof BigInt?BigInt.prototype.valueOf:null,Ti=Object.getOwnPropertySymbols,Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,Si="function"==typeof Symbol&&"object"==typeof Symbol.iterator,Mi="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Si||"symbol")?Symbol.toStringTag:null,Pi=Object.prototype.propertyIsEnumerable,Ai=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function Ri(t,e){if(t===1/0||t===-1/0||t!=t||t&&t>-1e3&&t<1e3||_i.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof t){var i=t<0?-bi(-t):bi(t);if(i!==t){var n=String(i),o=di.call(e,n.length+1);return pi.call(n,r,"$&_")+"."+pi.call(pi.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return pi.call(e,r,"$&_")}var wi=Zr,Ii=wi.custom,Ci=Bi(Ii)?Ii:null;function Oi(t,e,r){var i="double"===(r.quoteStyle||e)?'"':"'";return i+t+i}function Di(t){return pi.call(String(t),/"/g,"&quot;")}function Fi(t){return!("[object Array]"!==Gi(t)||Mi&&"object"==typeof t&&Mi in t)}function Li(t){return!("[object RegExp]"!==Gi(t)||Mi&&"object"==typeof t&&Mi in t)}function Bi(t){if(Si)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return!0;if(!t||"object"!=typeof t||!Ei)return!1;try{return Ei.call(t),!0}catch(pm){}return!1}var Ni=Object.prototype.hasOwnProperty||function(t){return t in this};function Ui(t,e){return Ni.call(t,e)}function Gi(t){return ui.call(t)}function ki(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}function Xi(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,i="... "+r+" more character"+(r>1?"s":"");return Xi(di.call(t,0,e.maxStringLength),e)+i}return Oi(pi.call(pi.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,ji),"single",e)}function ji(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+fi.call(e.toString(16))}function Vi(t){return"Object("+t+")"}function Hi(t){return t+" { ? }"}function Yi(t,e,r,i){return t+" ("+e+") {"+(i?zi(r,i):yi.call(r,", "))+"}"}function zi(t,e){if(0===t.length)return"";var r="\n"+e.prev+e.base;return r+yi.call(t,","+r)+"\n"+e.prev}function Wi(t,e){var r=Fi(t),i=[];if(r){i.length=t.length;for(var n=0;n<t.length;n++)i[n]=Ui(t,n)?e(t[n],t):""}var o,s="function"==typeof Ti?Ti(t):[];if(Si){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var h in t)Ui(t,h)&&(r&&String(Number(h))===h&&h<t.length||Si&&o["$"+h]instanceof Symbol||(_i.call(/[^\w$]/,h)?i.push(e(h,t)+": "+e(t[h],t)):i.push(h+": "+e(t[h],t))));if("function"==typeof Ti)for(var u=0;u<s.length;u++)Pi.call(t,s[u])&&i.push("["+e(s[u])+"]: "+e(t[s[u]],t));return i}var qi=wr,Ki=function(t,e){var r=Wr(t,!!e);return"function"==typeof r&&Kr(t,".prototype.")>-1?qr(r):r},Zi=function t(e,r,i,n){var o=r||{};if(Ui(o,"quoteStyle")&&"single"!==o.quoteStyle&&"double"!==o.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ui(o,"maxStringLength")&&("number"==typeof o.maxStringLength?o.maxStringLength<0&&o.maxStringLength!==1/0:null!==o.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var s=!Ui(o,"customInspect")||o.customInspect;if("boolean"!=typeof s&&"symbol"!==s)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ui(o,"indent")&&null!==o.indent&&"\t"!==o.indent&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ui(o,"numericSeparator")&&"boolean"!=typeof o.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=o.numericSeparator;if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("string"==typeof e)return Xi(e,o);if("number"==typeof e){if(0===e)return 1/0/e>0?"0":"-0";var h=String(e);return a?Ri(e,h):h}if("bigint"==typeof e){var u=String(e)+"n";return a?Ri(e,u):u}var l=void 0===o.depth?5:o.depth;if(void 0===i&&(i=0),i>=l&&l>0&&"object"==typeof e)return Fi(e)?"[Array]":"[Object]";var c=function(t,e){var r;if("\t"===t.indent)r="\t";else{if(!("number"==typeof t.indent&&t.indent>0))return null;r=yi.call(Array(t.indent+1)," ")}return{base:r,prev:yi.call(Array(e+1),r)}}(o,i);if(void 0===n)n=[];else if(ki(n,e)>=0)return"[Circular]";function d(e,r,s){if(r&&(n=vi.call(n)).push(r),s){var a={depth:o.depth};return Ui(o,"quoteStyle")&&(a.quoteStyle=o.quoteStyle),t(e,a,i+1,n)}return t(e,o,i+1,n)}if("function"==typeof e&&!Li(e)){var p=function(t){if(t.name)return t.name;var e=ci.call(li.call(t),/^function\s*([\w$]+)/);if(e)return e[1];return null}(e),f=Wi(e,d);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(f.length>0?" { "+yi.call(f,", ")+" }":"")}if(Bi(e)){var m=Si?pi.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Ei.call(e);return"object"!=typeof e||Si?m:Vi(m)}if(function(t){if(!t||"object"!=typeof t)return!1;if("undefined"!=typeof HTMLElement&&t instanceof HTMLElement)return!0;return"string"==typeof t.nodeName&&"function"==typeof t.getAttribute}(e)){for(var _="<"+mi.call(String(e.nodeName)),g=e.attributes||[],y=0;y<g.length;y++)_+=" "+g[y].name+"="+Oi(Di(g[y].value),"double",o);return _+=">",e.childNodes&&e.childNodes.length&&(_+="..."),_+="</"+mi.call(String(e.nodeName))+">"}if(Fi(e)){if(0===e.length)return"[]";var v=Wi(e,d);return c&&!function(t){for(var e=0;e<t.length;e++)if(ki(t[e],"\n")>=0)return!1;return!0}(v)?"["+zi(v,c)+"]":"[ "+yi.call(v,", ")+" ]"}if(function(t){return!("[object Error]"!==Gi(t)||Mi&&"object"==typeof t&&Mi in t)}(e)){var b=Wi(e,d);return"cause"in Error.prototype||!("cause"in e)||Pi.call(e,"cause")?0===b.length?"["+String(e)+"]":"{ ["+String(e)+"] "+yi.call(b,", ")+" }":"{ ["+String(e)+"] "+yi.call(gi.call("[cause]: "+d(e.cause),b),", ")+" }"}if("object"==typeof e&&s){if(Ci&&"function"==typeof e[Ci]&&wi)return wi(e,{depth:l-i});if("symbol"!==s&&"function"==typeof e.inspect)return e.inspect()}if(function(t){if(!Qr||!t||"object"!=typeof t)return!1;try{Qr.call(t);try{ii.call(t)}catch(_){return!0}return t instanceof Map}catch(pm){}return!1}(e)){var T=[];return ti&&ti.call(e,(function(t,r){T.push(d(r,e,!0)+" => "+d(t,e))})),Yi("Map",Qr.call(e),T,c)}if(function(t){if(!ii||!t||"object"!=typeof t)return!1;try{ii.call(t);try{Qr.call(t)}catch(e){return!0}return t instanceof Set}catch(pm){}return!1}(e)){var E=[];return ni&&ni.call(e,(function(t){E.push(d(t,e))})),Yi("Set",ii.call(e),E,c)}if(function(t){if(!oi||!t||"object"!=typeof t)return!1;try{oi.call(t,oi);try{si.call(t,si)}catch(_){return!0}return t instanceof WeakMap}catch(pm){}return!1}(e))return Hi("WeakMap");if(function(t){if(!si||!t||"object"!=typeof t)return!1;try{si.call(t,si);try{oi.call(t,oi)}catch(_){return!0}return t instanceof WeakSet}catch(pm){}return!1}(e))return Hi("WeakSet");if(function(t){if(!ai||!t||"object"!=typeof t)return!1;try{return ai.call(t),!0}catch(pm){}return!1}(e))return Hi("WeakRef");if(function(t){return!("[object Number]"!==Gi(t)||Mi&&"object"==typeof t&&Mi in t)}(e))return Vi(d(Number(e)));if(function(t){if(!t||"object"!=typeof t||!xi)return!1;try{return xi.call(t),!0}catch(pm){}return!1}(e))return Vi(d(xi.call(e)));if(function(t){return!("[object Boolean]"!==Gi(t)||Mi&&"object"==typeof t&&Mi in t)}(e))return Vi(hi.call(e));if(function(t){return!("[object String]"!==Gi(t)||Mi&&"object"==typeof t&&Mi in t)}(e))return Vi(d(String(e)));if("undefined"!=typeof window&&e===window)return"{ [object Window] }";if(e===x)return"{ [object globalThis] }";if(!function(t){return!("[object Date]"!==Gi(t)||Mi&&"object"==typeof t&&Mi in t)}(e)&&!Li(e)){var S=Wi(e,d),M=Ai?Ai(e)===Object.prototype:e instanceof Object||e.constructor===Object,P=e instanceof Object?"":"null prototype",A=!M&&Mi&&Object(e)===e&&Mi in e?di.call(Gi(e),8,-1):P?"Object":"",R=(M||"function"!=typeof e.constructor?"":e.constructor.name?e.constructor.name+" ":"")+(A||P?"["+yi.call(gi.call([],A||[],P||[]),": ")+"] ":"");return 0===S.length?R+"{}":c?R+"{"+zi(S,c)+"}":R+"{ "+yi.call(S,", ")+" }"}return String(e)},$i=Be,Ji=qi("%WeakMap%",!0),Qi=qi("%Map%",!0),tn=Ki("WeakMap.prototype.get",!0),en=Ki("WeakMap.prototype.set",!0),rn=Ki("WeakMap.prototype.has",!0),nn=Ki("Map.prototype.get",!0),on=Ki("Map.prototype.set",!0),sn=Ki("Map.prototype.has",!0),an=function(t,e){for(var r,i=t;null!==(r=i.next);i=r)if(r.key===e)return i.next=r.next,r.next=/** @type {NonNullable<typeof list.next>} */
t.next,t.next=r,r},hn=String.prototype.replace,un=/%20/g,ln="RFC3986",cn={default:ln,formatters:{RFC1738:function(t){return hn.call(t,un,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:ln},dn=cn,pn=Object.prototype.hasOwnProperty,fn=Array.isArray,mn=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),_n=function(t,e){for(var r=e&&e.plainObjects?Object.create(null):{},i=0;i<t.length;++i)void 0!==t[i]&&(r[i]=t[i]);return r},gn=1024,yn={arrayToObject:_n,assign:function(t,e){return Object.keys(e).reduce((function(t,r){return t[r]=e[r],t}),t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],r=[],i=0;i<e.length;++i)for(var n=e[i],o=n.obj[n.prop],s=Object.keys(o),a=0;a<s.length;++a){var h=s[a],u=o[h];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(e.push({obj:o,prop:h}),r.push(u))}return function(t){for(;t.length>1;){var e=t.pop(),r=e.obj[e.prop];if(fn(r)){for(var i=[],n=0;n<r.length;++n)void 0!==r[n]&&i.push(r[n]);e.obj[e.prop]=i}}}(e),t},decode:function(t,e,r){var i=t.replace(/\+/g," ");if("iso-8859-1"===r)return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch(pm){return i}},encode:function(t,e,r,i,n){if(0===t.length)return t;var o=t;if("symbol"==typeof t?o=Symbol.prototype.toString.call(t):"string"!=typeof t&&(o=String(t)),"iso-8859-1"===r)return escape(o).replace(/%u[0-9a-f]{4}/gi,(function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"}));for(var s="",a=0;a<o.length;a+=gn){for(var h=o.length>=gn?o.slice(a,a+gn):o,u=[],l=0;l<h.length;++l){var c=h.charCodeAt(l);45===c||46===c||95===c||126===c||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||n===dn.RFC1738&&(40===c||41===c)?u[u.length]=h.charAt(l):c<128?u[u.length]=mn[c]:c<2048?u[u.length]=mn[192|c>>6]+mn[128|63&c]:c<55296||c>=57344?u[u.length]=mn[224|c>>12]+mn[128|c>>6&63]+mn[128|63&c]:(l+=1,c=65536+((1023&c)<<10|1023&h.charCodeAt(l)),u[u.length]=mn[240|c>>18]+mn[128|c>>12&63]+mn[128|c>>6&63]+mn[128|63&c])}s+=u.join("")}return s},isBuffer:function(t){return!(!t||"object"!=typeof t)&&!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,e){if(fn(t)){for(var r=[],i=0;i<t.length;i+=1)r.push(e(t[i]));return r}return e(t)},merge:function t(e,r,i){if(!r)return e;if("object"!=typeof r){if(fn(e))e.push(r);else{if(!e||"object"!=typeof e)return[e,r];(i&&(i.plainObjects||i.allowPrototypes)||!pn.call(Object.prototype,r))&&(e[r]=!0)}return e}if(!e||"object"!=typeof e)return[e].concat(r);var n=e;return fn(e)&&!fn(r)&&(n=_n(e,i)),fn(e)&&fn(r)?(r.forEach((function(r,n){if(pn.call(e,n)){var o=e[n];o&&"object"==typeof o&&r&&"object"==typeof r?e[n]=t(o,r,i):e.push(r)}else e[n]=r})),e):Object.keys(r).reduce((function(e,n){var o=r[n];return pn.call(e,n)?e[n]=t(e[n],o,i):e[n]=o,e}),n)}},vn=function(){var t,e,r,i={assert:function(t){if(!i.has(t))throw new $i("Side channel does not contain "+Zi(t))},get:function(i){if(Ji&&i&&("object"==typeof i||"function"==typeof i)){if(t)return tn(t,i)}else if(Qi){if(e)return nn(e,i)}else if(r)return function(t,e){var r=an(t,e);return r&&r.value}(r,i)},has:function(i){if(Ji&&i&&("object"==typeof i||"function"==typeof i)){if(t)return rn(t,i)}else if(Qi){if(e)return sn(e,i)}else if(r)return function(t,e){return!!an(t,e)}(r,i);return!1},set:function(i,n){Ji&&i&&("object"==typeof i||"function"==typeof i)?(t||(t=new Ji),en(t,i,n)):Qi?(e||(e=new Qi),on(e,i,n)):(r||(r={key:{},next:null}),function(t,e,r){var i=an(t,e);i?i.value=r:t.next=/** @type {import('.').ListNode<typeof value>} */
{
// eslint-disable-line no-param-reassign, no-extra-parens
key:e,next:t.next,value:r}}(r,i,n))}};return i},bn=yn,xn=cn,Tn=Object.prototype.hasOwnProperty,En={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},Sn=Array.isArray,Mn=Array.prototype.push,Pn=function(t,e){Mn.apply(t,Sn(e)?e:[e])},An=Date.prototype.toISOString,Rn=xn.default,wn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:bn.encode,encodeValuesOnly:!1,format:Rn,formatter:xn.formatters[Rn],
// deprecated
indices:!1,serializeDate:function(t){return An.call(t)},skipNulls:!1,strictNullHandling:!1},In={},Cn=function t(e,r,i,n,o,s,a,h,u,l,c,d,p,f,m,_,g,y){for(var v,b=e,x=y,T=0,E=!1;void 0!==(x=x.get(In))&&!E;){var S=x.get(e);if(T+=1,void 0!==S){if(S===T)throw new RangeError("Cyclic object value");E=!0}void 0===x.get(In)&&(T=0)}if("function"==typeof l?b=l(r,b):b instanceof Date?b=p(b):"comma"===i&&Sn(b)&&(b=bn.maybeMap(b,(function(t){return t instanceof Date?p(t):t}))),null===b){if(s)return u&&!_?u(r,wn.encoder,g,"key",f):r;b=""}if("string"==typeof(v=b)||"number"==typeof v||"boolean"==typeof v||"symbol"==typeof v||"bigint"==typeof v||bn.isBuffer(b))return u?[m(_?r:u(r,wn.encoder,g,"key",f))+"="+m(u(b,wn.encoder,g,"value",f))]:[m(r)+"="+m(String(b))];var M,P=[];if(void 0===b)return P;if("comma"===i&&Sn(b))_&&u&&(b=bn.maybeMap(b,u)),M=[{value:b.length>0?b.join(",")||null:void 0}];else if(Sn(l))M=l;else{var A=Object.keys(b);M=c?A.sort(c):A}var R=h?r.replace(/\./g,"%2E"):r,w=n&&Sn(b)&&1===b.length?R+"[]":R;if(o&&Sn(b)&&0===b.length)return w+"[]";for(var I=0;I<M.length;++I){var C=M[I],O="object"==typeof C&&void 0!==C.value?C.value:b[C];if(!a||null!==O){var D=d&&h?C.replace(/\./g,"%2E"):C,F=Sn(b)?"function"==typeof i?i(w,D):w:w+(d?"."+D:"["+D+"]");y.set(e,T);var L=vn();L.set(In,y),Pn(P,t(O,F,i,n,o,s,a,h,"comma"===i&&_&&Sn(b)?null:u,l,c,d,p,f,m,_,g,L))}}return P},On=yn,Dn=Object.prototype.hasOwnProperty,Fn=Array.isArray,Ln={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:On.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Bn=function(t){return t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e,10))}))},Nn=function(t,e){return t&&"string"==typeof t&&e.comma&&t.indexOf(",")>-1?t.split(","):t},Un=function(t,e,r,i){if(t){var n=r.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,o=/(\[[^[\]]*])/g,s=r.depth>0&&/(\[[^[\]]*])/.exec(n),a=s?n.slice(0,s.index):n,h=[];if(a){if(!r.plainObjects&&Dn.call(Object.prototype,a)&&!r.allowPrototypes)return;h.push(a)}for(var u=0;r.depth>0&&null!==(s=o.exec(n))&&u<r.depth;){if(u+=1,!r.plainObjects&&Dn.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;h.push(s[1])}return s&&h.push("["+n.slice(s.index)+"]"),function(t,e,r,i){for(var n=i?e:Nn(e,r),o=t.length-1;o>=0;--o){var s,a=t[o];if("[]"===a&&r.parseArrays)s=r.allowEmptyArrays&&""===n?[]:[].concat(n);else{s=r.plainObjects?Object.create(null):{};var h="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,u=r.decodeDotInKeys?h.replace(/%2E/g,"."):h,l=parseInt(u,10);r.parseArrays||""!==u?!isNaN(l)&&a!==u&&String(l)===u&&l>=0&&r.parseArrays&&l<=r.arrayLimit?(s=[])[l]=n:"__proto__"!==u&&(s[u]=n):s={0:n}}n=s}return n}(h,e,r,i)}},Gn={formats:cn,parse:function(t,e){var r=function(t){if(!t)return Ln;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.decodeDotInKeys&&"boolean"!=typeof t.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=void 0===t.charset?Ln.charset:t.charset,r=void 0===t.duplicates?Ln.duplicates:t.duplicates;if("combine"!==r&&"first"!==r&&"last"!==r)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===t.allowDots?!0===t.decodeDotInKeys||Ln.allowDots:!!t.allowDots,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:Ln.allowEmptyArrays,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:Ln.allowPrototypes,allowSparse:"boolean"==typeof t.allowSparse?t.allowSparse:Ln.allowSparse,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:Ln.arrayLimit,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:Ln.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:Ln.comma,decodeDotInKeys:"boolean"==typeof t.decodeDotInKeys?t.decodeDotInKeys:Ln.decodeDotInKeys,decoder:"function"==typeof t.decoder?t.decoder:Ln.decoder,delimiter:"string"==typeof t.delimiter||On.isRegExp(t.delimiter)?t.delimiter:Ln.delimiter,
// eslint-disable-next-line no-implicit-coercion, no-extra-parens
depth:"number"==typeof t.depth||!1===t.depth?+t.depth:Ln.depth,duplicates:r,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:Ln.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:Ln.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:Ln.plainObjects,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:Ln.strictNullHandling}}(e);if(""===t||null==t)return r.plainObjects?Object.create(null):{};for(var i="string"==typeof t?function(t,e){var r,i={__proto__:null},n=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,o=e.parameterLimit===1/0?void 0:e.parameterLimit,s=n.split(e.delimiter,o),a=-1,h=e.charset;if(e.charsetSentinel)for(r=0;r<s.length;++r)0===s[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===s[r]?h="utf-8":"utf8=%26%2310003%3B"===s[r]&&(h="iso-8859-1"),a=r,r=s.length);for(r=0;r<s.length;++r)if(r!==a){var u,l,c=s[r],d=c.indexOf("]="),p=-1===d?c.indexOf("="):d+1;-1===p?(u=e.decoder(c,Ln.decoder,h,"key"),l=e.strictNullHandling?null:""):(u=e.decoder(c.slice(0,p),Ln.decoder,h,"key"),l=On.maybeMap(Nn(c.slice(p+1),e),(function(t){return e.decoder(t,Ln.decoder,h,"value")}))),l&&e.interpretNumericEntities&&"iso-8859-1"===h&&(l=Bn(l)),c.indexOf("[]=")>-1&&(l=Fn(l)?[l]:l);var f=Dn.call(i,u);f&&"combine"===e.duplicates?i[u]=On.combine(i[u],l):f&&"last"!==e.duplicates||(i[u]=l)}return i}(t,r):t,n=r.plainObjects?Object.create(null):{},o=Object.keys(i),s=0;s<o.length;++s){var a=o[s],h=Un(a,i[a],r,"string"==typeof t);n=On.merge(n,h,r)}return!0===r.allowSparse?n:On.compact(n)},stringify:function(t,e){var r,i=t,n=function(t){if(!t)return wn;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.encodeDotInKeys&&"boolean"!=typeof t.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||wn.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=xn.default;if(void 0!==t.format){if(!Tn.call(xn.formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}var i,n=xn.formatters[r],o=wn.filter;if(("function"==typeof t.filter||Sn(t.filter))&&(o=t.filter),i=t.arrayFormat in En?t.arrayFormat:"indices"in t?t.indices?"indices":"repeat":wn.arrayFormat,"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var s=void 0===t.allowDots?!0===t.encodeDotInKeys||wn.allowDots:!!t.allowDots;return{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:wn.addQueryPrefix,allowDots:s,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:wn.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:wn.charsetSentinel,commaRoundTrip:t.commaRoundTrip,delimiter:void 0===t.delimiter?wn.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:wn.encode,encodeDotInKeys:"boolean"==typeof t.encodeDotInKeys?t.encodeDotInKeys:wn.encodeDotInKeys,encoder:"function"==typeof t.encoder?t.encoder:wn.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:wn.encodeValuesOnly,filter:o,format:r,formatter:n,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:wn.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:wn.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:wn.strictNullHandling}}(e);"function"==typeof n.filter?i=(0,n.filter)("",i):Sn(n.filter)&&(r=n.filter);var o=[];if("object"!=typeof i||null===i)return"";var s=En[n.arrayFormat],a="comma"===s&&n.commaRoundTrip;r||(r=Object.keys(i)),n.sort&&r.sort(n.sort);for(var h=vn(),u=0;u<r.length;++u){var l=r[u];n.skipNulls&&null===i[l]||Pn(o,Cn(i[l],l,s,a,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,h))}var c=o.join(n.delimiter),d=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&("iso-8859-1"===n.charset?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),c.length>0?d+c:""}},kn=Ie;function Xn(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var jn=/^([a-z0-9.+-]+:)/i,Vn=/:[0-9]*$/,Hn=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,Yn=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),zn=["'"].concat(Yn),Wn=["%","/","?",";","#"].concat(zn),qn=["/","?","#"],Kn=/^[+a-z0-9A-Z_-]{0,63}$/,Zn=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,$n={javascript:!0,"javascript:":!0},Jn={javascript:!0,"javascript:":!0},Qn={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},to=Gn;function eo(t,e,r){if(t&&"object"==typeof t&&t instanceof Xn)return t;var i=new Xn;return i.parse(t,e,r),i}Xn.prototype.parse=function(t,e,r){if("string"!=typeof t)throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),n=-1!==i&&i<t.indexOf("#")?"?":"#",o=t.split(n);o[0]=o[0].replace(/\\/g,"/");var s=t=o.join(n);if(s=s.trim(),!r&&1===t.split("#").length){var a=Hn.exec(s);if(a)return this.path=s,this.href=s,this.pathname=a[1],a[2]?(this.search=a[2],this.query=e?to.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var h=jn.exec(s);if(h){var u=(h=h[0]).toLowerCase();this.protocol=u,s=s.substr(h.length)}if(r||h||s.match(/^\/\/[^@/]+@[^@/]+/)){var l="//"===s.substr(0,2);!l||h&&Jn[h]||(s=s.substr(2),this.slashes=!0)}if(!Jn[h]&&(l||h&&!Qn[h])){for(var c,d,p=-1,f=0;f<qn.length;f++){-1!==(m=s.indexOf(qn[f]))&&(-1===p||m<p)&&(p=m)}-1!==(d=-1===p?s.lastIndexOf("@"):s.lastIndexOf("@",p))&&(c=s.slice(0,d),s=s.slice(d+1),this.auth=decodeURIComponent(c)),p=-1;for(f=0;f<Wn.length;f++){var m;-1!==(m=s.indexOf(Wn[f]))&&(-1===p||m<p)&&(p=m)}-1===p&&(p=s.length),this.host=s.slice(0,p),s=s.slice(p),this.parseHost(),this.hostname=this.hostname||"";var _="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!_)for(var g=this.hostname.split(/\./),y=(f=0,g.length);f<y;f++){var v=g[f];if(v&&!v.match(Kn)){for(var b="",x=0,T=v.length;x<T;x++)v.charCodeAt(x)>127?b+="x":b+=v[x];if(!b.match(Kn)){var E=g.slice(0,f),S=g.slice(f+1),M=v.match(Zn);M&&(E.push(M[1]),S.unshift(M[2])),S.length&&(s="/"+S.join(".")+s),this.hostname=E.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),_||(this.hostname=kn.toASCII(this.hostname));var P=this.port?":"+this.port:"",A=this.hostname||"";this.host=A+P,this.href+=this.host,_&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!$n[u])for(f=0,y=zn.length;f<y;f++){var R=zn[f];if(-1!==s.indexOf(R)){var w=encodeURIComponent(R);w===R&&(w=escape(R)),s=s.split(R).join(w)}}var I=s.indexOf("#");-1!==I&&(this.hash=s.substr(I),s=s.slice(0,I));var C=s.indexOf("?");if(-1!==C?(this.search=s.substr(C),this.query=s.substr(C+1),e&&(this.query=to.parse(this.query)),s=s.slice(0,C)):e&&(this.search="",this.query={}),s&&(this.pathname=s),Qn[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){P=this.pathname||"";var O=this.search||"";this.path=P+O}return this.href=this.format(),this},Xn.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,o="";this.host?n=t+this.host:this.hostname&&(n=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(o=to.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||Qn[e])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),i&&"#"!==i.charAt(0)&&(i="#"+i),s&&"?"!==s.charAt(0)&&(s="?"+s),e+n+(r=r.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(s=s.replace("#","%23"))+i},Xn.prototype.resolve=function(t){return this.resolveObject(eo(t,!1,!0)).format()},Xn.prototype.resolveObject=function(t){if("string"==typeof t){var e=new Xn;e.parse(t,!1,!0),t=e}for(var r=new Xn,i=Object.keys(this),n=0;n<i.length;n++){var o=i[n];r[o]=this[o]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),a=0;a<s.length;a++){var h=s[a];"protocol"!==h&&(r[h]=t[h])}return Qn[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!Qn[t.protocol]){for(var u=Object.keys(t),l=0;l<u.length;l++){var c=u[l];r[c]=t[c]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||Jn[t.protocol])r.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var p=r.pathname||"",f=r.search||"";r.path=p+f}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&"/"===r.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),g=_||m||r.host&&t.pathname,y=g,v=r.pathname&&r.pathname.split("/")||[],b=(d=t.pathname&&t.pathname.split("/")||[],r.protocol&&!Qn[r.protocol]);if(b&&(r.hostname="",r.port=null,r.host&&(""===v[0]?v[0]=r.host:v.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),g=g&&(""===d[0]||""===v[0])),_)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,v=d;else if(d.length)v||(v=[]),v.pop(),v=v.concat(d),r.search=t.search,r.query=t.query;else if(null!=t.search){if(b)r.host=v.shift(),r.hostname=r.host,(M=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=M.shift(),r.hostname=M.shift(),r.host=r.hostname);return r.search=t.search,r.query=t.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!v.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var x=v.slice(-1)[0],T=(r.host||t.host||v.length>1)&&("."===x||".."===x)||""===x,E=0,S=v.length;S>=0;S--)"."===(x=v[S])?v.splice(S,1):".."===x?(v.splice(S,1),E++):E&&(v.splice(S,1),E--);if(!g&&!y)for(;E--;E)v.unshift("..");!g||""===v[0]||v[0]&&"/"===v[0].charAt(0)||v.unshift(""),T&&"/"!==v.join("/").substr(-1)&&v.push("");var M,P=""===v[0]||v[0]&&"/"===v[0].charAt(0);b&&(r.hostname=P?"":v.length?v.shift():"",r.host=r.hostname,(M=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=M.shift(),r.hostname=M.shift(),r.host=r.hostname));return(g=g||r.host&&v.length)&&!P&&v.unshift(""),v.length>0?r.pathname=v.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},Xn.prototype.parseHost=function(){var t=this.host,e=Vn.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var ro={parse:eo,format:function(t){return"string"==typeof t&&(t=eo(t)),t instanceof Xn?t.format():Xn.prototype.format.call(t)},resolve:function(t,e){return eo(t,!1,!0).resolve(e)}};function io(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function no(t){return t.split("?")[0].split("#")[0]}var oo={
/**
   * Converts a path to posix format.
   * @param path - The path to convert to posix
   */
toPosix:function(t){return e="\\",r="/",t.replace(new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),r);var e,r},
/**
   * Checks if the path is a URL
   * @param path - The path to check
   */
isUrl:function(t){return/^https?:/.test(this.toPosix(t))},
/**
   * Checks if the path is a data URL
   * @param path - The path to check
   */
isDataUrl:function(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},
/**
   * Checks if the path has a protocol e.g. http://
   * This will return true for windows file paths
   * @param path - The path to check
   */
hasProtocol:function(t){return/^[^/:]+:\//.test(this.toPosix(t))},
/**
   * Returns the protocol of the path e.g. http://, C:/, file:///
   * @param path - The path to get the protocol from
   */
getProtocol:function(t){io(t),t=this.toPosix(t);var e="",r=/^file:\/\/\//.exec(t),i=/^[^/:]+:\/\//.exec(t),n=/^[^/:]+:\//.exec(t);if(r||i||n){var o=(null==r?void 0:r[0])||(null==i?void 0:i[0])||(null==n?void 0:n[0]);e=o,t=t.slice(o.length)}return e},
/**
   * Converts URL to an absolute path.
   * When loading from a Web Worker, we must use absolute paths.
   * If the URL is already absolute we return it as is
   * If it's not, we convert it
   * @param url - The URL to test
   * @param customBaseUrl - The base URL to use
   * @param customRootUrl - The root URL to use
   */
toAbsolute:function(t,e,r){if(this.isDataUrl(t))return t;var i=no(this.toPosix(null!=e?e:Kt.ADAPTER.getBaseUrl())),n=no(this.toPosix(null!=r?r:this.rootname(i)));return io(t),(t=this.toPosix(t)).startsWith("/")?oo.join(n,t.slice(1)):this.isAbsolute(t)?t:this.join(i,t)},
/**
   * Normalizes the given path, resolving '..' and '.' segments
   * @param path - The path to normalize
   */
normalize:function(t){if(io(t=this.toPosix(t)),0===t.length)return".";var e="",r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));var i=t.endsWith("/");return(t=function(t,e){for(var r,i="",n=0,o=-1,s=0,a=0;a<=t.length;++a){if(a<t.length)r=t.charCodeAt(a);else{if(47===r)break;r=47}if(47===r){if(o===a-1||1===s);else if(o!==a-1&&2===s){if(i.length<2||2!==n||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var h=i.lastIndexOf("/");if(h!==i.length-1){-1===h?(i="",n=0):n=(i=i.slice(0,h)).length-1-i.lastIndexOf("/"),o=a,s=0;continue}}else if(2===i.length||1===i.length){i="",n=0,o=a,s=0;continue}e&&(i.length>0?i+="/..":i="..",n=2)}else i.length>0?i+="/"+t.slice(o+1,a):i=t.slice(o+1,a),n=a-o-1;o=a,s=0}else 46===r&&-1!==s?++s:s=-1}return i}(t,!1)).length>0&&i&&(t+="/"),r?"/"+t:e+t},
/**
   * Determines if path is an absolute path.
   * Absolute paths can be urls, data urls, or paths on disk
   * @param path - The path to test
   */
isAbsolute:function(t){return io(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},
/**
   * Joins all given path segments together using the platform-specific separator as a delimiter,
   * then normalizes the resulting path
   * @param segments - The segments of the path to join
   */
join:function(){for(var t,e,r=arguments,i=[],n=0;n<arguments.length;n++)i[n]=r[n];if(0===i.length)return".";for(var o=0;o<i.length;++o){var s=i[o];if(io(s),s.length>0)if(void 0===e)e=s;else{var a=null!==(t=i[o-1])&&void 0!==t?t:"";this.extname(a)?e+="/../"+s:e+="/"+s}}return void 0===e?".":this.normalize(e)},
/**
   * Returns the directory name of a path
   * @param path - The path to parse
   */
dirname:function(t){if(io(t),0===t.length)return".";for(var e=(t=this.toPosix(t)).charCodeAt(0),r=47===e,i=-1,n=!0,o=this.getProtocol(t),s=t,a=(t=t.slice(o.length)).length-1;a>=1;--a)if(47===(e=t.charCodeAt(a))){if(!n){i=a;break}}else n=!1;return-1===i?r?"/":this.isUrl(s)?o+t:o:r&&1===i?"//":o+t.slice(0,i)},
/**
   * Returns the root of the path e.g. /, C:/, file:///, http://domain.com/
   * @param path - The path to parse
   */
rootname:function(t){io(t);var e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){var r=t.indexOf("/",e.length);(e=-1!==r?t.slice(0,r):t).endsWith("/")||(e+="/")}return e},
/**
   * Returns the last portion of a path
   * @param path - The path to test
   * @param ext - Optional extension to remove
   */
basename:function(t,e){io(t),e&&io(e),t=this.toPosix(t);var r,i=0,n=-1,o=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var s=e.length-1,a=-1;for(r=t.length-1;r>=0;--r){var h=t.charCodeAt(r);if(47===h){if(!o){i=r+1;break}}else-1===a&&(o=!1,a=r+1),s>=0&&(h===e.charCodeAt(s)?-1==--s&&(n=r):(s=-1,n=a))}return i===n?n=a:-1===n&&(n=t.length),t.slice(i,n)}for(r=t.length-1;r>=0;--r)if(47===t.charCodeAt(r)){if(!o){i=r+1;break}}else-1===n&&(o=!1,n=r+1);return-1===n?"":t.slice(i,n)},
/**
   * Returns the extension of the path, from the last occurrence of the . (period) character to end of string in the last
   * portion of the path. If there is no . in the last portion of the path, or if there are no . characters other than
   * the first character of the basename of path, an empty string is returned.
   * @param path - The path to parse
   */
extname:function(t){io(t);for(var e=-1,r=0,i=-1,n=!0,o=0,s=(t=this.toPosix(t)).length-1;s>=0;--s){var a=t.charCodeAt(s);if(47!==a)-1===i&&(n=!1,i=s+1),46===a?-1===e?e=s:1!==o&&(o=1):-1!==e&&(o=-1);else if(!n){r=s+1;break}}return-1===e||-1===i||0===o||1===o&&e===i-1&&e===r+1?"":t.slice(e,i)},
/**
   * Parses a path into an object containing the 'root', `dir`, `base`, `ext`, and `name` properties.
   * @param path - The path to parse
   */
parse:function(t){io(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;var r,i=(t=this.toPosix(t)).charCodeAt(0),n=this.isAbsolute(t);e.root=this.rootname(t),r=n||this.hasProtocol(t)?1:0;for(var o=-1,s=0,a=-1,h=!0,u=t.length-1,l=0;u>=r;--u)if(47!==(i=t.charCodeAt(u)))-1===a&&(h=!1,a=u+1),46===i?-1===o?o=u:1!==l&&(l=1):-1!==o&&(l=-1);else if(!h){s=u+1;break}return-1===o||-1===a||0===l||1===l&&o===a-1&&o===s+1?-1!==a&&(e.base=e.name=0===s&&n?t.slice(1,a):t.slice(s,a)):(0===s&&n?(e.name=t.slice(1,o),e.base=t.slice(1,a)):(e.name=t.slice(s,o),e.base=t.slice(s,a)),e.ext=t.slice(o,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":"};Kt.RETINA_PREFIX=/@([0-9\.]+)x/,Kt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var so,ao=!1,ho="6.5.10";function uo(t){var e;if(!ao){if(Kt.ADAPTER.getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){var r=["\n %c %c %c PixiJS "+ho+" - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=globalThis.console).log.apply(e,r)}else globalThis.console&&globalThis.console.log("PixiJS "+ho+" - "+t+" - http://www.pixijs.com/");ao=!0}}function lo(){return void 0===so&&(so=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:Kt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Kt.ADAPTER.getWebGLRenderingContext())return!1;var e=Kt.ADAPTER.createCanvas(),r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!r||!r.getContextAttributes().stencil);if(r){var n=r.getExtension("WEBGL_lose_context");n&&n.loseContext()}return r=null,i}catch(pm){return!1}}()),so}var co={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function po(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function fo(t){var e=t.toString(16);return"#"+(e="000000".substring(0,6-e.length)+e)}function mo(t){return"string"==typeof t&&"#"===(t=co[t.toLowerCase()]||t)[0]&&(t=t.slice(1)),parseInt(t,16)}var _o=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[W.NORMAL_NPM]=W.NORMAL,t[W.ADD_NPM]=W.ADD,t[W.SCREEN_NPM]=W.SCREEN,e[W.NORMAL]=W.NORMAL_NPM,e[W.ADD]=W.ADD_NPM,e[W.SCREEN]=W.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();function go(t,e){return _o[e?1:0][t]}function yo(t,e,r,i){return r=r||new Float32Array(4),i||void 0===i?(r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e):(r[0]=t[0],r[1]=t[1],r[2]=t[2]),r[3]=e,r}function vo(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}function bo(t,e,r,i){return(r=r||new Float32Array(4))[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,(i||void 0===i)&&(r[0]*=e,r[1]*=e,r[2]*=e),r[3]=e,r}function xo(t,e){void 0===e&&(e=null);var r=6*t;if((e=e||new Uint16Array(r)).length!==r)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+r);for(var i=0,n=0;i<r;i+=6,n+=4)e[i+0]=n+0,e[i+1]=n+1,e[i+2]=n+2,e[i+3]=n+0,e[i+4]=n+2,e[i+5]=n+3;return e}function To(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var Eo={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function So(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Mo(t){return!(t&t-1||!t)}function Po(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function Ao(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var o=n-(r=e+r>n?n-e:r);for(i=e;i<o;++i)t[i]=t[i+r];t.length=o}}function Ro(t){return 0===t?0:t<0?-1:1}var wo=0;function Io(){return++wo}var Co={};function Oo(t,e,r){if(void 0===r&&(r=3),!Co[e]){var i=(new Error).stack;void 0===i||(i=i.split("\n").splice(r).join("\n"),console.groupCollapsed),Co[e]=!0}}var Do={},Fo=Object.create(null),Lo=Object.create(null);var Bo=
/** @class */function(){function t(t,e,r){this.canvas=Kt.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=r||Kt.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{
/**
       * The width of the canvas buffer in pixels.
       * @member {number}
       */
get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{
/**
       * The height of the canvas buffer in pixels.
       * @member {number}
       */
get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0}),t}();function No(t){var e,r,i,n=t.width,o=t.height,s=t.getContext("2d",{willReadFrequently:!0}),a=s.getImageData(0,0,n,o).data,h=a.length,u={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(r=e/4%n,i=~~(e/4/n),null===u.top&&(u.top=i),(null===u.left||r<u.left)&&(u.left=r),(null===u.right||u.right<r)&&(u.right=r+1),(null===u.bottom||u.bottom<i)&&(u.bottom=i));return null!==u.top&&(n=u.right-u.left,o=u.bottom-u.top+1,l=s.getImageData(u.left,u.top,n,o)),{height:o,width:n,data:l}}var Uo,Go=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function ko(t,e){if(void 0===e&&(e=globalThis.location),0===t.indexOf("data:"))return"";e=e||globalThis.location,Uo||(Uo=document.createElement("a")),Uo.href=t;var r=ro.parse(Uo.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}function Xo(t,e){var r=Kt.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}const jo=Object.freeze(Object.defineProperty({__proto__:null,BaseTextureCache:Lo,CanvasRenderTarget:Bo,DATA_URI:Go,EventEmitter:$t,ProgramCache:Do,TextureCache:Fo,clearTextureCache:function(){var t;for(t in Fo)delete Fo[t];for(t in Lo)delete Lo[t]},correctBlendMode:go,createIndicesForQuads:xo,decomposeDataUri:function(t){var e=Go.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}},deprecation:Oo,destroyTextureCache:function(){var t;for(t in Fo)Fo[t].destroy();for(t in Lo)Lo[t].destroy()},determineCrossOrigin:ko,earcut:Me,getBufferType:To,getResolutionOfUrl:Xo,hex2rgb:po,hex2string:fo,interleaveTypedArrays:function(t,e){for(var r=0,i=0,n={},o=0;o<t.length;o++)i+=e[o],r+=t[o].length;var s=new ArrayBuffer(4*r),a=null,h=0;for(o=0;o<t.length;o++){var u=e[o],l=t[o],c=To(l);n[c]||(n[c]=new Eo[c](s)),a=n[c];for(var d=0;d<l.length;d++){a[(d/u|0)*i+h+d%u]=l[d]}h+=u}return new Float32Array(s)},isMobile:qt,isPow2:Mo,isWebGLSupported:lo,log2:Po,nextPow2:So,path:oo,premultiplyBlendMode:_o,premultiplyRgba:yo,premultiplyTint:vo,premultiplyTintToRgba:bo,removeItems:Ao,rgb2hex:function(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},sayHello:uo,sign:Ro,skipHello:function(){ao=!0},string2hex:mo,trimCanvas:No,uid:Io,url:ro},Symbol.toStringTag,{value:"Module"}));
/*!
 * @pixi/math - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Vo,Ho,Yo=2*Math.PI,zo=180/Math.PI,Wo=Math.PI/180;(Ho=Vo||(Vo={}))[Ho.POLY=0]="POLY",Ho[Ho.RECT=1]="RECT",Ho[Ho.CIRC=2]="CIRC",Ho[Ho.ELIP=3]="ELIP",Ho[Ho.RREC=4]="RREC";var qo=
/** @class */function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},t}(),Ko=[new qo,new qo,new qo,new qo],Zo=
/** @class */function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=Vo.RECT}return Object.defineProperty(t.prototype,"left",{
/** Returns the left edge of the rectangle. */
get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{
/** Returns the right edge of the rectangle. */
get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{
/** Returns the top edge of the rectangle. */
get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{
/** Returns the bottom edge of the rectangle. */
get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{
/** A constant empty rectangle. */
get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.intersects=function(t,e){if(!e){var r=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=r)return!1;var i=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>i}var n=this.left,o=this.right,s=this.top,a=this.bottom;if(o<=n||a<=s)return!1;var h=Ko[0].set(t.left,t.top),u=Ko[1].set(t.left,t.bottom),l=Ko[2].set(t.right,t.top),c=Ko[3].set(t.right,t.bottom);if(l.x<=h.x||u.y<=h.y)return!1;var d=Math.sign(e.a*e.d-e.b*e.c);if(0===d)return!1;if(e.apply(h,h),e.apply(u,u),e.apply(l,l),e.apply(c,c),Math.max(h.x,u.x,l.x,c.x)<=n||Math.min(h.x,u.x,l.x,c.x)>=o||Math.max(h.y,u.y,l.y,c.y)<=s||Math.min(h.y,u.y,l.y,c.y)>=a)return!1;var p=d*(u.y-h.y),f=d*(h.x-u.x),m=p*n+f*s,_=p*o+f*s,g=p*n+f*a,y=p*o+f*a;if(Math.max(m,_,g,y)<=p*h.x+f*h.y||Math.min(m,_,g,y)>=p*c.x+f*c.y)return!1;var v=d*(h.y-l.y),b=d*(l.x-h.x),x=v*n+b*s,T=v*o+b*s,E=v*n+b*a,S=v*o+b*a;return!(Math.max(x,T,E,S)<=v*h.x+b*h.y||Math.min(x,T,E,S)>=v*c.x+b*c.y)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},t.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),$o=
/** @class */function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=Vo.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},t.prototype.getBounds=function(){return new Zo(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},t}(),Jo=
/** @class */function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=r,this.height=i,this.type=Vo.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},t.prototype.getBounds=function(){return new Zo(this.x-this.width,this.y-this.height,this.width,this.height)},t.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),Qo=
/** @class */function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];var i=Array.isArray(e[0])?e[0]:e;if("number"!=typeof i[0]){for(var n=[],o=0,s=i.length;o<s;o++)n.push(i[o].x,i[o].y);i=n}this.points=i,this.type=Vo.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,o=i-1;n<i;o=n++){var s=this.points[2*n],a=this.points[2*n+1],h=this.points[2*o],u=this.points[2*o+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-s)+s&&(r=!r)}return r},t.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce((function(t,e){return t+", "+e}),"")+"]"},t}(),ts=
/** @class */function(){function t(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=Vo.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){var r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;var i=t-(this.x+r),n=e-(this.y+r),o=r*r;if(i*i+n*n<=o)return!0;if((i=t-(this.x+this.width-r))*i+n*n<=o)return!0;if(i*i+(n=e-(this.y+this.height-r))*n<=o)return!0;if((i=t-(this.x+r))*i+n*n<=o)return!0}return!1},t.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},t}(),es=
/** @class */function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},t.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(t.prototype,"x",{
/** Position of the observable point on the x axis. */
get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{
/** Position of the observable point on the y axis. */
get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),rs=
/** @class */function(){function t(t,e,r,i,n,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===o&&(o=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=o}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,o){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new qo;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new qo;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,o=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=o*e-this.ty*r,this.ty=o*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,o,s,a,h){return this.a=Math.cos(s+h)*n,this.b=Math.sin(s+h)*n,this.c=-Math.sin(s-a)*o,this.d=Math.cos(s-a)*o,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,o=t.pivot,s=-Math.atan2(-i,n),a=Math.atan2(r,e),h=Math.abs(s+a);return h<1e-5||Math.abs(Yo-h)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=a),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx+(o.x*e+o.y*i),t.position.y=this.ty+(o.x*r+o.y*n),t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,o=t*i-e*r;return this.a=i/o,this.b=-e/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-i*n)/o,this.ty=-(t*this.ty-e*n)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(t,"IDENTITY",{
/**
       * A default (identity) matrix
       * @readonly
       */
get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{
/**
       * A temp matrix
       * @readonly
       */
get:function(){return new t},enumerable:!1,configurable:!0}),t}(),is=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ns=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],os=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ss=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],as=[],hs=[],us=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];as.push(e);for(var r=0;r<16;r++)for(var i=us(is[t]*is[r]+os[t]*ns[r]),n=us(ns[t]*is[r]+ss[t]*ns[r]),o=us(is[t]*os[r]+os[t]*ss[r]),s=us(ns[t]*os[r]+ss[t]*ss[r]),a=0;a<16;a++)if(is[a]===i&&ns[a]===n&&os[a]===o&&ss[a]===s){e.push(a);break}}for(t=0;t<16;t++){var h=new rs;h.set(is[t],ns[t],os[t],ss[t],0,0),hs.push(h)}}();var ls={
/**
   * | Rotation | Direction |
   * |----------|-----------|
   * | 0°       | East      |
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
E:0,
/**
   * | Rotation | Direction |
   * |----------|-----------|
   * | 45°↻     | Southeast |
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
SE:1,
/**
   * | Rotation | Direction |
   * |----------|-----------|
   * | 90°↻     | South     |
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
S:2,
/**
   * | Rotation | Direction |
   * |----------|-----------|
   * | 135°↻    | Southwest |
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
SW:3,
/**
   * | Rotation | Direction |
   * |----------|-----------|
   * | 180°     | West      |
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
W:4,
/**
   * | Rotation    | Direction    |
   * |-------------|--------------|
   * | -135°/225°↻ | Northwest    |
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
NW:5,
/**
   * | Rotation    | Direction    |
   * |-------------|--------------|
   * | -90°/270°↻  | North        |
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
N:6,
/**
   * | Rotation    | Direction    |
   * |-------------|--------------|
   * | -45°/315°↻  | Northeast    |
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
NE:7,
/**
   * Reflection about Y-axis.
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
MIRROR_VERTICAL:8,
/**
   * Reflection about the main diagonal.
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
MAIN_DIAGONAL:10,
/**
   * Reflection about X-axis.
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
MIRROR_HORIZONTAL:12,
/**
   * Reflection about reverse diagonal.
   * @memberof PIXI.groupD8
   * @constant {PIXI.GD8Symmetry}
   */
REVERSE_DIAGONAL:14,
/**
   * @memberof PIXI.groupD8
   * @param {PIXI.GD8Symmetry} ind - sprite rotation angle.
   * @returns {PIXI.GD8Symmetry} The X-component of the U-axis
   *    after rotating the axes.
   */
uX:function(t){return is[t]},
/**
   * @memberof PIXI.groupD8
   * @param {PIXI.GD8Symmetry} ind - sprite rotation angle.
   * @returns {PIXI.GD8Symmetry} The Y-component of the U-axis
   *    after rotating the axes.
   */
uY:function(t){return ns[t]},
/**
   * @memberof PIXI.groupD8
   * @param {PIXI.GD8Symmetry} ind - sprite rotation angle.
   * @returns {PIXI.GD8Symmetry} The X-component of the V-axis
   *    after rotating the axes.
   */
vX:function(t){return os[t]},
/**
   * @memberof PIXI.groupD8
   * @param {PIXI.GD8Symmetry} ind - sprite rotation angle.
   * @returns {PIXI.GD8Symmetry} The Y-component of the V-axis
   *    after rotating the axes.
   */
vY:function(t){return ss[t]},
/**
   * @memberof PIXI.groupD8
   * @param {PIXI.GD8Symmetry} rotation - symmetry whose opposite
   *   is needed. Only rotations have opposite symmetries while
   *   reflections don't.
   * @returns {PIXI.GD8Symmetry} The opposite symmetry of `rotation`
   */
inv:function(t){return 8&t?15&t:7&-t},
/**
   * Composes the two D8 operations.
   *
   * Taking `^` as reflection:
   *
   * |       | E=0 | S=2 | W=4 | N=6 | E^=8 | S^=10 | W^=12 | N^=14 |
   * |-------|-----|-----|-----|-----|------|-------|-------|-------|
   * | E=0   | E   | S   | W   | N   | E^   | S^    | W^    | N^    |
   * | S=2   | S   | W   | N   | E   | S^   | W^    | N^    | E^    |
   * | W=4   | W   | N   | E   | S   | W^   | N^    | E^    | S^    |
   * | N=6   | N   | E   | S   | W   | N^   | E^    | S^    | W^    |
   * | E^=8  | E^  | N^  | W^  | S^  | E    | N     | W     | S     |
   * | S^=10 | S^  | E^  | N^  | W^  | S    | E     | N     | W     |
   * | W^=12 | W^  | S^  | E^  | N^  | W    | S     | E     | N     |
   * | N^=14 | N^  | W^  | S^  | E^  | N    | W     | S     | E     |
   *
   * [This is a Cayley table]{@link https://en.wikipedia.org/wiki/Cayley_table}
   * @memberof PIXI.groupD8
   * @param {PIXI.GD8Symmetry} rotationSecond - Second operation, which
   *   is the row in the above cayley table.
   * @param {PIXI.GD8Symmetry} rotationFirst - First operation, which
   *   is the column in the above cayley table.
   * @returns {PIXI.GD8Symmetry} Composed operation
   */
add:function(t,e){return as[t][e]},
/**
   * Reverse of `add`.
   * @memberof PIXI.groupD8
   * @param {PIXI.GD8Symmetry} rotationSecond - Second operation
   * @param {PIXI.GD8Symmetry} rotationFirst - First operation
   * @returns {PIXI.GD8Symmetry} Result
   */
sub:function(t,e){return as[t][ls.inv(e)]},
/**
   * Adds 180 degrees to rotation, which is a commutative
   * operation.
   * @memberof PIXI.groupD8
   * @param {number} rotation - The number to rotate.
   * @returns {number} Rotated number
   */
rotate180:function(t){return 4^t},
/**
   * Checks if the rotation angle is vertical, i.e. south
   * or north. It doesn't work for reflections.
   * @memberof PIXI.groupD8
   * @param {PIXI.GD8Symmetry} rotation - The number to check.
   * @returns {boolean} Whether or not the direction is vertical
   */
isVertical:function(t){return 2==(3&t)},
/**
   * Approximates the vector `V(dx,dy)` into one of the
   * eight directions provided by `groupD8`.
   * @memberof PIXI.groupD8
   * @param {number} dx - X-component of the vector
   * @param {number} dy - Y-component of the vector
   * @returns {PIXI.GD8Symmetry} Approximation of the vector into
   *  one of the eight symmetries.
   */
byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?ls.S:ls.N:2*Math.abs(e)<=Math.abs(t)?t>0?ls.E:ls.W:e>0?t>0?ls.SE:ls.SW:t>0?ls.NE:ls.NW},
/**
   * Helps sprite to compensate texture packer rotation.
   * @memberof PIXI.groupD8
   * @param {PIXI.Matrix} matrix - sprite world matrix
   * @param {PIXI.GD8Symmetry} rotation - The rotation factor to use.
   * @param {number} tx - sprite anchoring
   * @param {number} ty - sprite anchoring
   */
matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=hs[ls.inv(e)];n.tx=r,n.ty=i,t.append(n)}},cs=
/** @class */function(){function t(){this.worldTransform=new rs,this.localTransform=new rs,this.position=new es(this.onChange,this,0,0),this.scale=new es(this.onChange,this,1,1),this.pivot=new es(this.onChange,this,0,0),this.skew=new es(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{
/** The rotation of the object in radians. */
get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();
/*!
 * @pixi/display - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Kt.SORTABLE_CHILDREN=!1;var ds=
/** @class */function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Zo.EMPTY:((t=t||new Zo(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addPointMatrix=function(t,e){var r=t.a,i=t.b,n=t.c,o=t.d,s=t.tx,a=t.ty,h=r*e.x+n*e.y+s,u=i*e.x+o*e.y+a;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)},t.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,o=t[0],s=t[1];e=o<e?o:e,r=s<r?s:r,i=o>i?o:i,n=s>n?s:n,e=(o=t[2])<e?o:e,r=(s=t[3])<r?s:r,i=o>i?o:i,n=s>n?s:n,e=(o=t[4])<e?o:e,r=(s=t[5])<r?s:r,i=o>i?o:i,n=s>n?s:n,e=(o=t[6])<e?o:e,r=(s=t[7])<r?s:r,i=o>i?o:i,n=s>n?s:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},t.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},t.prototype.addFrameMatrix=function(t,e,r,i,n){var o=t.a,s=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=o*e+a*r+u,_=s*e+h*r+l;c=m<c?m:c,d=_<d?_:d,p=m>p?m:p,f=_>f?_:f,c=(m=o*i+a*r+u)<c?m:c,d=(_=s*i+h*r+l)<d?_:d,p=m>p?m:p,f=_>f?_:f,c=(m=o*e+a*n+u)<c?m:c,d=(_=s*e+h*n+l)<d?_:d,p=m>p?m:p,f=_>f?_:f,c=(m=o*i+a*n+u)<c?m:c,d=(_=s*i+h*n+l)<d?_:d,p=m>p?m:p,f=_>f?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},t.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,o=this.maxX,s=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,n=u<n?u:n,o=h>o?h:o,s=u>s?u:s}this.minX=i,this.minY=n,this.maxX=o,this.maxY=s},t.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},t.prototype.addVerticesMatrix=function(t,e,r,i,n,o){void 0===n&&(n=0),void 0===o&&(o=n);for(var s=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty,d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=r;_<i;_+=2){var g=e[_],y=e[_+1],v=s*g+h*y+l,b=u*y+a*g+c;d=Math.min(d,v-n),f=Math.max(f,v+n),p=Math.min(p,b-o),m=Math.max(m,b+o)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},t.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},t.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=o){var s=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<s?r:s,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=o>u?o:u}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=o){var s=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<s?r:s,this.minY=i<a?i:a,this.maxX=n>h?n:h,this.maxY=o>u?o:u}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,r,i,n,o){t-=n,e-=o,r+=n,i+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i},t}(),ps=function(t,e){return ps=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},ps(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function fs(t,e){function r(){this.constructor=t}ps(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var ms=
/** @class */function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new cs,e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new ds,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return fs(e,t),e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},Object.defineProperty(e.prototype,"destroyed",{
/**
       * Fired when this DisplayObject is added to a Container.
       * @instance
       * @event added
       * @param {PIXI.Container} container - The container added to.
       */
/**
       * Fired when this DisplayObject is removed from a Container.
       * @instance
       * @event removed
       * @param {PIXI.Container} container - The container removed from.
       */
/**
       * Fired when this DisplayObject is destroyed. This event is emitted once
       * destroy is finished.
       * @instance
       * @event destroyed
       */
/** Readonly flag for destroyed display objects. */
get:function(){return this._destroyed},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Zo),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new Zo),t=this._localBoundsRect),this._localBounds||(this._localBounds=new ds);var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,n=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,t);return this.parent=r,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-n,o},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,o,s,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=o,this.skew.y=s,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{
/**
       * @protected
       * @member {PIXI.Container}
       */
get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new _s),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{
/**
       * The position of the displayObject on the x axis relative to the local coordinates of the parent.
       * An alias to position.x
       */
get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{
/**
       * The position of the displayObject on the y axis relative to the local coordinates of the parent.
       * An alias to position.y
       */
get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{
/**
       * Current transform of the object based on world (parent) factors.
       * @readonly
       */
get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{
/**
       * Current transform of the object based on local factors: position, scale, other stuff.
       * @readonly
       */
get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{
/**
       * The coordinate of the object relative to the local coordinates of the parent.
       * @since 4.0.0
       */
get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{
/**
       * The scale factors of this object along the local coordinate axes.
       *
       * The default scale is (1, 1).
       * @since 4.0.0
       */
get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{
/**
       * The center of rotation, scaling, and skewing for this display object in its local space. The `position`
       * is the projection of `pivot` in the parent's local space.
       *
       * By default, the pivot is the origin (0, 0).
       * @since 4.0.0
       */
get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{
/**
       * The skew factor for the object in radians.
       * @since 4.0.0
       */
get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{
/**
       * The rotation of the object in radians.
       * 'rotation' and 'angle' have the same effect on a display object; rotation is in radians, angle is in degrees.
       */
get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{
/**
       * The angle of the object in degrees.
       * 'rotation' and 'angle' have the same effect on a display object; rotation is in radians, angle is in degrees.
       */
get:function(){return this.transform.rotation*zo},set:function(t){this.transform.rotation=t*Wo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{
/**
       * The zIndex of the displayObject.
       *
       * If a container has the sortableChildren property set to true, children will be automatically
       * sorted by zIndex value; a higher value will mean it will be moved towards the end of the array,
       * and thus rendered on top of other display objects within the same container.
       * @see PIXI.Container#sortableChildren
       */
get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{
/**
       * Indicates if the object is globally visible.
       * @readonly
       */
get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{
/**
       * Sets a mask for the displayObject. A mask is an object that limits the visibility of an
       * object to the shape of the mask applied to it. In PixiJS a regular mask must be a
       * {@link PIXI.Graphics} or a {@link PIXI.Sprite} object. This allows for much faster masking in canvas as it
       * utilities shape clipping. Furthermore, a mask of an object must be in the subtree of its parent.
       * Otherwise, `getLocalBounds` may calculate incorrect bounds, which makes the container's width and height wrong.
       * To remove a mask, set this property to `null`.
       *
       * For sprite mask both alpha and red channel are used. Black mask is the same as transparent mask.
       * @example
       * const graphics = new PIXI.Graphics();
       * graphics.beginFill(0xFF3300);
       * graphics.drawRect(50, 250, 100, 100);
       * graphics.endFill();
       *
       * const sprite = new PIXI.Sprite(texture);
       * sprite.mask = graphics;
       * @todo At the moment, PIXI.CanvasRenderer doesn't support PIXI.Sprite as mask.
       */
get:function(){return this._mask},set:function(t){if(this._mask!==t){var e;if(this._mask)(e=this._mask.isMaskData?this._mask.maskObject:this._mask)&&(e._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1));if(this._mask=t,this._mask)(e=this._mask.isMaskData?this._mask.maskObject:this._mask)&&(0===e._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}},enumerable:!1,configurable:!0}),e}($t),_s=
/** @class */function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return fs(e,t),e}(ms);function gs(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}ms.prototype.displayObjectUpdateTransform=ms.prototype.updateTransform;var ys=
/** @class */function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=Kt.SORTABLE_CHILDREN,e.sortDirty=!1,e}return fs(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(e.length>1)for(var i=0;i<e.length;i++)this.addChild(e[i]);else{var n=e[0];n.parent&&n.parent.removeChild(n),n.parent=this,this.sortDirty=!0,n.transform._parentID=-1,this.children.push(n),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",n,this,this.children.length-1),n.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);Ao(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(e.length>1)for(var i=0;i<e.length;i++)this.removeChild(e[i]);else{var n=e[0],o=this.children.indexOf(n);if(-1===o)return null;n.parent=null,n.transform._parentID=-1,Ao(this.children,o,1),this._boundsID++,this.onChildrenChange(o),n.emit("removed",this),this.emit("childRemoved",n,this,o)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Ao(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var r,i=t,n=e-i;if(n>0&&n<=e){r=this.children.splice(i,n);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(o=0;o<r.length;++o)r[o].emit("removed",this),this.emit("childRemoved",r[o],this,o);return r}if(0===n&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(gs),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.isMaskData?e._mask.maskObject:e._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,r){void 0===r&&(r=!1);var i=t.prototype.getLocalBounds.call(this,e);if(!r)for(var n=0,o=this.children.length;n<o;++n){var s=this.children[n];s.visible&&s.updateTransform()}return i},e.prototype._calculateBounds=function(){},e.prototype._renderWithCulling=function(t){var r=t.renderTexture.sourceFrame;if(r.width>0&&r.height>0){var i,n;if(this.cullArea?(i=this.cullArea,n=this.worldTransform):this._render!==e.prototype._render&&(i=this.getBounds(!0)),i&&r.intersects(i,n))this._render(t);else if(this.cullArea)return;for(var o=0,s=this.children.length;o<s;++o){var a=this.children[o],h=a.cullable;a.cullable=h||!this.cullArea,a.render(t),a.cullable=h}}},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i])}var n=e&&this._enabledFilters&&this._enabledFilters.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==vt.NONE));if(n&&t.batch.flush(),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.push(this,this._enabledFilters),r&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);i=0;for(var o=this.children.length;i<o;++i)this.children[i].render(t)}n&&t.batch.flush(),r&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},Object.defineProperty(e.prototype,"width",{
/** The width of the Container, setting this will actually modify the scale to achieve the value set. */
get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{
/** The height of the Container, setting this will actually modify the scale to achieve the value set. */
get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(ms);ys.prototype.containerUpdateTransform=ys.prototype.updateTransform;
/*!
 * @pixi/extensions - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/extensions is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var vs,bs,xs=function(){return xs=Object.assign||function(t){for(var e,r=arguments,i=1,n=arguments.length;i<n;i++)for(var o in e=r[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},xs.apply(this,arguments)};(bs=vs||(vs={})).Application="application",bs.RendererPlugin="renderer-webgl-plugin",bs.CanvasRendererPlugin="renderer-canvas-plugin",bs.Loader="loader",bs.LoadParser="load-parser",bs.ResolveParser="resolve-parser",bs.CacheParser="cache-parser",bs.DetectionParser="detection-parser";var Ts,Es,Ss=function(t){if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");var e="object"!=typeof t.extension?{type:t.extension}:t.extension;t=xs(xs({},e),{ref:t})}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t=xs({},t)).type&&(t.type=[t.type]),t},Ms={
/** @ignore */
_addHandlers:null,
/** @ignore */
_removeHandlers:null,
/** @ignore */
_queue:{},
/**
   * Remove extensions from PixiJS.
   * @param extensions - Extensions to be removed.
   * @returns {PIXI.extensions} For chaining.
   */
remove:function(){for(var t=arguments,e=this,r=[],i=0;i<arguments.length;i++)r[i]=t[i];return r.map(Ss).forEach((function(t){t.type.forEach((function(r){var i,n;return null===(n=(i=e._removeHandlers)[r])||void 0===n?void 0:n.call(i,t)}))})),this},
/**
   * Register new extensions with PixiJS.
   * @param extensions - The spread of extensions to add to PixiJS.
   * @returns {PIXI.extensions} For chaining.
   */
add:function(){for(var t=arguments,e=this,r=[],i=0;i<arguments.length;i++)r[i]=t[i];return r.map(Ss).forEach((function(t){t.type.forEach((function(r){var i=e._addHandlers,n=e._queue;i[r]?i[r](t):(n[r]=n[r]||[],n[r].push(t))}))})),this},
/**
   * Internal method to handle extensions by name.
   * @param type - The extension type.
   * @param onAdd  - Function for handling when extensions are added/registered passes {@link PIXI.ExtensionFormat}.
   * @param onRemove  - Function for handling when extensions are removed/unregistered passes {@link PIXI.ExtensionFormat}.
   * @returns {PIXI.extensions} For chaining.
   */
handle:function(t,e,r){var i=this._addHandlers=this._addHandlers||{},n=this._removeHandlers=this._removeHandlers||{};if(i[t]||n[t])throw new Error("Extension type "+t+" already has a handler");i[t]=e,n[t]=r;var o=this._queue;return o[t]&&(o[t].forEach((function(t){return e(t)})),delete o[t]),this},
/**
   * Handle a type, but using a map by `name` property.
   * @param type - Type of extension to handle.
   * @param map - The object map of named extensions.
   * @returns {PIXI.extensions} For chaining.
   */
handleByMap:function(t,e){return this.handle(t,(function(t){e[t.name]=t.ref}),(function(t){delete e[t.name]}))},
/**
   * Handle a type, but using a list of extensions.
   * @param type - Type of extension to handle.
   * @param list - The list of extensions.
   * @returns {PIXI.extensions} For chaining.
   */
handleByList:function(t,e){return this.handle(t,(function(r){var i,n;e.includes(r.ref)||(e.push(r.ref),t===vs.Loader&&(null===(n=(i=r.ref).add)||void 0===n||n.call(i)))}),(function(t){var r=e.indexOf(t.ref);-1!==r&&e.splice(r,1)}))}},Ps=
/** @class */function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,o,s,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,r,i,n,o,s,a);return u===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{
/**
       * `true` if there are no this Runner contains no listeners
       * @readonly
       */
get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{
/**
       * The name of the runner.
       * @readonly
       */
get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(Ps.prototype,{
/**
   * Alias for `emit`
   * @memberof PIXI.Runner#
   * @method dispatch
   * @see PIXI.Runner#emit
   */
dispatch:{value:Ps.prototype.emit},
/**
   * Alias for `emit`
   * @memberof PIXI.Runner#
   * @method run
   * @see PIXI.Runner#emit
   */
run:{value:Ps.prototype.emit}}),
/*!
 * @pixi/ticker - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Kt.TARGET_FPMS=.06,(Es=Ts||(Ts={}))[Es.INTERACTION=50]="INTERACTION",Es[Es.HIGH=25]="HIGH",Es[Es.NORMAL=0]="NORMAL",Es[Es.LOW=-25]="LOW",Es[Es.UTILITY=-50]="UTILITY";var As=
/** @class */function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=r,this.once=i}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Rs=
/** @class */function(){function t(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new As(null,null,1/0),this.deltaMS=1/Kt.TARGET_FPMS,this.elapsedMS=1/Kt.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=Ts.NORMAL),this._addListener(new As(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=Ts.NORMAL),this._addListener(new As(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{
/**
       * The number of listeners on this ticker, calculated by walking through linked list
       * @readonly
       * @member {number}
       */
get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Kt.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{
/**
       * The frames per second at which this ticker is running.
       * The default is approximately 60 in most modern browsers.
       * **Note:** This does not factor in the value of
       * {@link PIXI.Ticker#speed}, which is specific
       * to scaling {@link PIXI.Ticker#deltaTime}.
       * @member {number}
       * @readonly
       */
get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{
/**
       * Manages the maximum amount of milliseconds allowed to
       * elapse between invoking {@link PIXI.Ticker#update}.
       * This value is used to cap {@link PIXI.Ticker#deltaTime},
       * but does not effect the measured value of {@link PIXI.Ticker#FPS}.
       * When setting this property it is clamped to a value between
       * `0` and `PIXI.settings.TARGET_FPMS * 1000`.
       * @member {number}
       * @default 10
       */
get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,Kt.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{
/**
       * Manages the minimum amount of milliseconds required to
       * elapse between invoking {@link PIXI.Ticker#update}.
       * This will effect the measured value of {@link PIXI.Ticker#FPS}.
       * If it is set to `0`, then there is no limit; PixiJS will render as many frames as it can.
       * Otherwise it will be at least `minFPS`
       * @member {number}
       * @default 0
       */
get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{
/**
       * The shared ticker instance used by {@link PIXI.AnimatedSprite} and by
       * {@link PIXI.VideoResource} to update animation frames / video textures.
       *
       * It may also be used by {@link PIXI.Application} if created with the `sharedTicker` option property set to true.
       *
       * The property {@link PIXI.Ticker#autoStart} is set to `true` for this instance.
       * Please follow the examples for usage, including how to opt-out of auto-starting the shared ticker.
       * @example
       * let ticker = PIXI.Ticker.shared;
       * // Set this to prevent starting this ticker when listeners are added.
       * // By default this is true only for the PIXI.Ticker.shared instance.
       * ticker.autoStart = false;
       * // FYI, call this to ensure the ticker is stopped. It should be stopped
       * // if you have not attempted to render anything yet.
       * ticker.stop();
       * // Call this when you are ready for a running shared ticker.
       * ticker.start();
       * @example
       * // You may use the shared ticker to render...
       * let renderer = PIXI.autoDetectRenderer();
       * let stage = new PIXI.Container();
       * document.body.appendChild(renderer.view);
       * ticker.add(function (time) {
       *     renderer.render(stage);
       * });
       * @example
       * // Or you can just update it manually.
       * ticker.autoStart = false;
       * ticker.stop();
       * function animate(time) {
       *     ticker.update(time);
       *     renderer.render(stage);
       *     requestAnimationFrame(animate);
       * }
       * animate(performance.now());
       * @member {PIXI.Ticker}
       * @static
       */
get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{
/**
       * The system ticker instance used by {@link PIXI.InteractionManager} and by
       * {@link PIXI.BasePrepare} for core timing functionality that shouldn't usually need to be paused,
       * unlike the `shared` ticker which drives visual animations and rendering which may want to be paused.
       *
       * The property {@link PIXI.Ticker#autoStart} is set to `true` for this instance.
       * @member {PIXI.Ticker}
       * @static
       */
get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),ws=
/** @class */function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Ts.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Rs.shared:new Rs,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t.extension=vs.Application,t}();
/*!
 * @pixi/core - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Kt.PREFER_ENV=qt.any?X.WEBGL:X.WEBGL2,Kt.STRICT_TEXTURE_CACHE=!1;var Is=[];function Cs(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=Is.length-1;n>=0;--n){var o=Is[n];if(o.test&&o.test(t,r))return new o(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Os=function(t,e){return Os=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Os(t,e)};function Ds(t,e){function r(){this.constructor=t}Os(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Fs=function(){return Fs=Object.assign||function(t){for(var e,r=arguments,i=1,n=arguments.length;i<n;i++)for(var o in e=r[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Fs.apply(this,arguments)};var Ls=
/** @class */function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Ps("setRealSize"),this.onUpdate=new Ps("update"),this.onError=new Ps("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{
/**
       * Has been validated
       * @readonly
       */
get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{
/**
       * The width of the resource.
       * @readonly
       */
get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{
/**
       * The height of the resource.
       * @readonly
       */
get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,r){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),Bs=
/** @class */function(t){function e(e,r){var i=this,n=r||{},o=n.width,s=n.height;if(!o||!s)throw new Error("BufferResource width or height invalid");return(i=t.call(this,o,s)||this).data=e,i}return Ds(e,t),e.prototype.upload=function(t,e,r){var i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ct.UNPACK);var n=e.realWidth,o=e.realHeight;return r.width===n&&r.height===o?i.texSubImage2D(e.target,0,0,0,n,o,e.format,r.type,this.data):(r.width=n,r.height=o,i.texImage2D(e.target,0,r.internalFormat,n,o,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(Ls),Ns={scaleMode:ot.NEAREST,format:$.RGBA,alphaMode:ct.NPM},Us=
/** @class */function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null);var i=t.call(this)||this,n=(r=r||{}).alphaMode,o=r.mipmap,s=r.anisotropicLevel,a=r.scaleMode,h=r.width,u=r.height,l=r.wrapMode,c=r.format,d=r.type,p=r.target,f=r.resolution,m=r.resourceOptions;return!e||e instanceof Ls||((e=Cs(e,m)).internal=!0),i.resolution=f||Kt.RESOLUTION,i.width=Math.round((h||0)*i.resolution)/i.resolution,i.height=Math.round((u||0)*i.resolution)/i.resolution,i._mipmap=void 0!==o?o:Kt.MIPMAP_TEXTURES,i.anisotropicLevel=void 0!==s?s:Kt.ANISOTROPIC_LEVEL,i._wrapMode=l||Kt.WRAP_MODE,i._scaleMode=void 0!==a?a:Kt.SCALE_MODE,i.format=c||$.RGBA,i.type=d||et.UNSIGNED_BYTE,i.target=p||Q.TEXTURE_2D,i.alphaMode=void 0!==n?n:ct.UNPACK,i.uid=Io(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=h>0&&u>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(e),i}return Ds(e,t),Object.defineProperty(e.prototype,"realWidth",{
/**
       * Pixel width of the source of this texture
       * @readonly
       */
get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{
/**
       * Pixel height of the source of this texture
       * @readonly
       */
get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{
/**
       * Mipmap mode of the texture, affects downscaled images
       * @default PIXI.settings.MIPMAP_TEXTURES
       */
get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{
/**
       * The scale mode to apply when scaling this texture
       * @default PIXI.settings.SCALE_MODE
       */
get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapMode",{
/**
       * How the texture wraps
       * @default PIXI.settings.WRAP_MODE
       */
get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return r=r||this.resolution,this.setRealSize(t*r,e*r,r)},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=Mo(this.realWidth)&&Mo(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Lo[this.cacheId],delete Fo[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,r,i){void 0===i&&(i=Kt.STRICT_TEXTURE_CACHE);var n="string"==typeof t,o=null;if(n)o=t;else{if(!t._pixiId){var s=r&&r.pixiIdPrefix||"pixiid";t._pixiId=s+"_"+Io()}o=t._pixiId}var a=Lo[o];if(n&&i&&!a)throw new Error('The cacheId "'+o+'" does not exist in BaseTextureCache.');return a||((a=new e(t,r)).cacheId=o,e.addToCache(a,o)),a},e.fromBuffer=function(t,r,i,n){t=t||new Float32Array(r*i*4);var o=new Bs(t,{width:r,height:i}),s=t instanceof Float32Array?et.FLOAT:et.UNSIGNED_BYTE;return new e(o,Object.assign({},Ns,n||{width:r,height:i,type:s}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Lo[e],Lo[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Lo[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Lo[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete Lo[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}($t),Gs=
/** @class */function(t){function e(e,r){var i=this,n=r||{},o=n.width,s=n.height;(i=t.call(this,o,s)||this).items=[],i.itemDirtyIds=[];for(var a=0;a<e;a++){var h=new Us;i.items.push(h),i.itemDirtyIds.push(-2)}return i.length=e,i._load=null,i.baseTexture=null,i}return Ds(e,t),e.prototype.initFromArray=function(t,e){for(var r=0;r<this.length;r++)t[r]&&(t[r].castToBaseTexture?this.addBaseTextureAt(t[r].castToBaseTexture(),r):t[r]instanceof Ls?this.addResourceAt(t[r],r):this.addResourceAt(Cs(t[r],e),r))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],r=e.realWidth,i=e.realHeight;return t.resize(r,i),Promise.resolve(t)})),this._load},e}(Ls),ks=
/** @class */function(t){function e(e,r){var i,n,o=this,s=r||{},a=s.width,h=s.height;return Array.isArray(e)?(i=e,n=e.length):n=e,o=t.call(this,n,{width:a,height:h})||this,i&&o.initFromArray(i,r),o}return Ds(e,t),e.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Q.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,e,r){var i=this,n=i.length,o=i.itemDirtyIds,s=i.items,a=t.gl;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,n,0,e.format,r.type,null);for(var h=0;h<n;h++){var u=s[h];o[h]<u.dirtyId&&(o[h]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,
// xoffset
0,
// yoffset
h,
// zoffset
u.resource.width,u.resource.height,1,e.format,r.type,u.resource.source))}return!0},e}(Gs),Xs=
/** @class */function(t){function e(e){var r=this,i=e,n=i.naturalWidth||i.videoWidth||i.width,o=i.naturalHeight||i.videoHeight||i.height;return(r=t.call(this,n,o)||this).source=e,r.noSubImage=!1,r}return Ds(e,t),e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=ko(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,i){var n=t.gl,o=e.realWidth,s=e.realHeight;if((i=i||this.source)instanceof HTMLImageElement){if(!i.complete||0===i.naturalWidth)return!1}else if(i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ct.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==o||r.height!==s?(r.width=o,r.height=s,n.texImage2D(e.target,0,r.internalFormat,e.format,r.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,r.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source,r=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(r,i),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(Ls),js=
/** @class */function(t){function e(e){return t.call(this,e)||this}return Ds(e,t),e.test=function(t){var e=globalThis.OffscreenCanvas;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(Xs),Vs=
/** @class */function(t){function e(r,i){var n=this,o=i||{},s=o.width,a=o.height,h=o.autoLoad,u=o.linkBaseTexture;if(r&&r.length!==e.SIDES)throw new Error("Invalid length. Got "+r.length+", expected 6");n=t.call(this,6,{width:s,height:a})||this;for(var l=0;l<e.SIDES;l++)n.items[l].target=Q.TEXTURE_CUBE_MAP_POSITIVE_X+l;return n.linkBaseTexture=!1!==u,r&&n.initFromArray(r,i),!1!==h&&n.load(),n}return Ds(e,t),e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Q.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,e,r){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=Q.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this},e.prototype.upload=function(t,r,i){for(var n=this.itemDirtyIds,o=0;o<e.SIDES;o++){var s=this.items[o];(n[o]<s.dirtyId||i.dirtyId<r.dirtyId)&&(s.valid&&s.resource?(s.resource.upload(t,s,i),n[o]=s.dirtyId):n[o]<-1&&(t.gl.texImage2D(s.target,0,i.internalFormat,r.realWidth,r.realHeight,0,r.format,i.type,null),n[o]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(Gs),Hs=
/** @class */function(t){function e(e,r){var i=this;if(r=r||{},!(e instanceof HTMLImageElement)){var n=new Image;Xs.crossOrigin(n,e,r.crossorigin),n.src=e,e=n}return i=t.call(this,e)||this,!e.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=e.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==r.createBitmap?r.createBitmap:Kt.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,i.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,i.bitmap=null,i._load=null,!1!==r.autoLoad&&i.load(),i}return Ds(e,t),e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){var i=e.source;e.url=i.src;var n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})}))),this._load},e.prototype.process=function(){var t=this,e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var r=globalThis.createImageBitmap,i=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then((function(t){return t.blob()})).then((function(i){return r(i,0,0,e.width,e.height,{premultiplyAlpha:null===t.alphaMode||t.alphaMode===ct.UNPACK?"premultiply":"none"})})).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process},e.prototype.upload=function(e,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,i,this.bitmap),!this.preserveBitmap){var n=!0,o=r._glTextures;for(var s in o){var a=o[s];if(a!==i&&a.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},e}(Xs),Ys=
/** @class */function(t){function e(e,r){var i=this;return r=r||{},(i=t.call(this,Kt.ADAPTER.createCanvas())||this)._width=0,i._height=0,i.svg=e,i.scale=r.scale||1,i._overrideWidth=r.width,i._overrideHeight=r.height,i._resolve=null,i._crossorigin=r.crossorigin,i._load=null,!1!==r.autoLoad&&i.load(),i}return Ds(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(r){if(t._resolve=function(){t.resize(t.source.width,t.source.height),r(t)},e.SVG_XML.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var t=this,e=new Image;Xs.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(r){t._resolve&&(e.onerror=null,t.onError.emit(r))},e.onload=function(){if(t._resolve){var r=e.width,i=e.height;if(!r||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=r*t.scale,o=i*t.scale;(t._overrideWidth||t._overrideHeight)&&(n=t._overrideWidth||t._overrideHeight/i*r,o=t._overrideHeight||t._overrideWidth/r*i),n=Math.round(n),o=Math.round(o);var s=t.source;s.width=n,s.height=o,s._pixiId="canvas_"+Io(),s.getContext("2d").drawImage(e,0,0,r,i,0,0,n,o),t._resolve(),t._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,r){return"svg"===r||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&e.SVG_XML.test(t)},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(Xs),zs=
/** @class */function(t){function e(r,i){var n=this;if(i=i||{},!(r instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),"string"==typeof r&&(r=[r]);var s=r[0].src||r[0];Xs.crossOrigin(o,s,i.crossorigin);for(var a=0;a<r.length;++a){var h=document.createElement("source"),u=r[a],l=u.src,c=u.mime,d=(l=l||r[a]).split("?").shift().toLowerCase(),p=d.slice(d.lastIndexOf(".")+1);c=c||e.MIME_TYPES[p]||"video/"+p,h.src=l,h.type=c,o.appendChild(h)}r=o}return(n=t.call(this,r)||this).noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=i.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=!1!==i.autoPlay,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),!1!==i.autoLoad&&n.load(),n}return Ds(e,t),e.prototype.update=function(e){if(!this.destroyed){var r=Rs.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()},e.prototype._isSourceReady=function(){return this.source.readyState>2},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Rs.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Rs.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&(Rs.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{
/** Should the base texture automatically update itself, set to true by default. */
get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Rs.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Rs.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{
/**
       * How many times a second to update the texture from the video. Leave at 0 to update at every render.
       * A lower fps can help performance, as updating the texture at 60fps on a 30ps video may not be efficient.
       */
get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,r){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(Xs),Ws=
/** @class */function(t){function e(e){return t.call(this,e)||this}return Ds(e,t),e.test=function(t){return!!globalThis.createImageBitmap&&"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap},e}(Xs);Is.push(Hs,Ws,js,zs,Ys,Bs,Vs,ks);var qs={__proto__:null,Resource:Ls,BaseImageResource:Xs,INSTALLED:Is,autoDetectResource:Cs,AbstractMultiResource:Gs,ArrayResource:ks,BufferResource:Bs,CanvasResource:js,CubeResource:Vs,ImageResource:Hs,SVGResource:Ys,VideoResource:zs,ImageBitmapResource:Ws},Ks=
/** @class */function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ds(e,t),e.prototype.upload=function(t,e,r){var i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ct.UNPACK);var n=e.realWidth,o=e.realHeight;return r.width===n&&r.height===o?i.texSubImage2D(e.target,0,0,0,n,o,e.format,r.type,this.data):(r.width=n,r.height=o,i.texImage2D(e.target,0,r.internalFormat,n,o,0,e.format,r.type,this.data)),!0},e}(Bs),Zs=
/** @class */function(){function t(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Ps("disposeFramebuffer"),this.multisample=Et.NONE}return Object.defineProperty(t.prototype,"colorTexture",{
/**
       * Reference to the colorTexture.
       * @readonly
       */
get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new Us(null,{scaleMode:ot.NEAREST,resolution:1,mipmap:ut.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Us(new Ks(null,{width:this.width,height:this.height}),{scaleMode:ot.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:ut.OFF,format:$.DEPTH_COMPONENT,type:et.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){n=this.depthTexture.resolution;this.depthTexture.setSize(t/n,e/n)}}},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},t}(),$s=
/** @class */function(t){function e(e){void 0===e&&(e={});var r=this;"number"==typeof e&&(e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});return e.width=e.width||100,e.height=e.height||100,e.multisample=void 0!==e.multisample?e.multisample:Et.NONE,(r=t.call(this,null,e)||this).mipmap=ut.OFF,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new Zs(r.realWidth,r.realHeight).addColorTexture(0,r),r.framebuffer.multisample=e.multisample,r.maskStack=[],r.filterStack=[{}],r}return Ds(e,t),e.prototype.resize=function(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(Us),Js=
/** @class */function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var o=t.width/2/i,s=t.height/2/n,a=t.x/i+o,h=t.y/n+s;r=ls.add(r,ls.NW),this.x0=a+o*ls.uX(r),this.y0=h+s*ls.uY(r),r=ls.add(r,2),this.x1=a+o*ls.uX(r),this.y1=h+s*ls.uY(r),r=ls.add(r,2),this.x2=a+o*ls.uX(r),this.y2=h+s*ls.uY(r),r=ls.add(r,2),this.x3=a+o*ls.uX(r),this.y3=h+s*ls.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},t}(),Qs=new Js;function ta(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}var ea=
/** @class */function(t){function e(r,i,n,o,s,a){var h=t.call(this)||this;if(h.noFrame=!1,i||(h.noFrame=!0,i=new Zo(0,0,1,1)),r instanceof e&&(r=r.baseTexture),h.baseTexture=r,h._frame=i,h.trim=o,h.valid=!1,h._uvs=Qs,h.uvMatrix=null,h.orig=n||i,h._rotate=Number(s||0),!0===s)h._rotate=2;else if(h._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return h.defaultAnchor=a?new qo(a.x,a.y):new qo(0,0),h._updateID=0,h.textureCacheIds=[],r.valid?h.noFrame?r.valid&&h.onBaseTextureUpdated(r):h.frame=i:r.once("loaded",h.onBaseTextureUpdated,h),h.noFrame&&r.on("update",h.onBaseTextureUpdated,h),h}return Ds(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&r.url&&Fo[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),r=this._frame===this.orig?t:this.orig.clone(),i=new e(this.baseTexture,!this.noFrame&&t,r,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i},e.prototype.updateUvs=function(){this._uvs===Qs&&(this._uvs=new Js),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=Kt.STRICT_TEXTURE_CACHE);var n="string"==typeof t,o=null;if(n)o=t;else if(t instanceof Us){if(!t.cacheId){var s=r&&r.pixiIdPrefix||"pixiid";t.cacheId=s+"-"+Io(),Us.addToCache(t,t.cacheId)}o=t.cacheId}else{if(!t._pixiId){s=r&&r.pixiIdPrefix||"pixiid";t._pixiId=s+"_"+Io()}o=t._pixiId}var a=Fo[o];if(n&&i&&!a)throw new Error('The cacheId "'+o+'" does not exist in TextureCache.');return a||t instanceof Us?!a&&t instanceof Us&&(a=new e(t),e.addToCache(a,o)):(r.resolution||(r.resolution=Xo(t)),(a=new e(new Us(t,r))).baseTexture.cacheId=o,Us.addToCache(a.baseTexture,o),e.addToCache(a,o)),a},e.fromURL=function(t,r){var i=Object.assign({autoLoad:!1},null==r?void 0:r.resourceOptions),n=e.from(t,Object.assign({resourceOptions:i},r),!1),o=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):o.load().then((function(){return Promise.resolve(n)}))},e.fromBuffer=function(t,r,i,n){return new e(Us.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i,n){var o=new Us(t,Object.assign({scaleMode:Kt.SCALE_MODE,resolution:Xo(r)},n)),s=o.resource;s instanceof Hs&&(s.url=r);var a=new e(o);return i||(i=r),Us.addToCache(a.baseTexture,i),e.addToCache(a,i),i!==r&&(Us.addToCache(a.baseTexture,r),e.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise((function(t){a.baseTexture.once("loaded",(function(){return t(a)}))}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Fo[e],Fo[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Fo[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Fo[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)Fo[t.textureCacheIds[i]]===t&&delete Fo[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{
/**
       * Returns resolution of baseTexture
       * @readonly
       */
get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{
/**
       * The frame specifies the region of the base texture that this texture uses.
       * Please call `updateUvs()` after you change coordinates of `frame` manually.
       */
get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,o=e+i>this.baseTexture.width,s=r+n>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{
/**
       * Indicates whether the texture is rotated inside the atlas
       * set to 2 to compensate for texture packer rotation
       * set to 6 to compensate for spine packer rotation
       * can be used to rotate or mirror sprites
       * See {@link PIXI.groupD8} for explanation
       */
get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{
/** The width of the Texture in pixels. */
get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{
/** The height of the Texture in pixels. */
get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(e,"EMPTY",{
/** An empty texture, used often to not have to create multiple empty textures. Can not be destroyed. */
get:function(){return e._EMPTY||(e._EMPTY=new e(new Us),ta(e._EMPTY),ta(e._EMPTY.baseTexture)),e._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(e,"WHITE",{
/** A white texture of 16x16 size, used for graphics and other things Can not be destroyed. */
get:function(){if(!e._WHITE){var t=Kt.ADAPTER.createCanvas(16,16),r=t.getContext("2d");t.width=16,t.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),e._WHITE=new e(Us.from(t)),ta(e._WHITE),ta(e._WHITE.baseTexture)}return e._WHITE},enumerable:!1,configurable:!0}),e}($t),ra=
/** @class */function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return Ds(e,t),Object.defineProperty(e.prototype,"framebuffer",{
/**
       * Shortcut to `this.baseTexture.framebuffer`, saves baseTexture cast.
       * @readonly
       */
get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{
/**
       * Shortcut to `this.framebuffer.multisample`.
       * @default PIXI.MSAA_QUALITY.NONE
       */
get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,r){void 0===r&&(r=!0);var i=this.baseTexture.resolution,n=Math.round(t*i)/i,o=Math.round(e*i)/i;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,r&&this.baseTexture.resize(n,o),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){for(var r=arguments,i=[],n=1;n<arguments.length;n++)i[n-1]=r[n];return"number"==typeof t&&(Oo(0,"Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:i[0],scaleMode:i[1],resolution:i[2]}),new e(new $s(t))},e}(ea),ia=
/** @class */function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return t.prototype.createTexture=function(t,e,r){void 0===r&&(r=Et.NONE);var i=new $s(Object.assign({width:t,height:e,resolution:1,multisample:r},this.textureOptions));return new ra(i)},t.prototype.getOptimalTexture=function(t,e,r,i){var n;void 0===r&&(r=1),void 0===i&&(i=Et.NONE),t=Math.ceil(t*r-1e-6),e=Math.ceil(e*r-1e-6),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?n=i>1?-i:-1:(n=((65535&(t=So(t)))<<16|65535&(e=So(e)))>>>0,i>1&&(n+=4294967296*i)),this.texturePool[n]||(this.texturePool[n]=[]);var o=this.texturePool[n].pop();return o||(o=this.createTexture(t,e,i)),o.filterPoolKey=n,o.setResolution(r),o},t.prototype.getFilterTexture=function(t,e,r){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution,r||Et.NONE);return i.filterFrame=t.filterFrame,i},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},t.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){for(var e in this.enableFullScreen=t.width>0&&t.height>0,this.texturePool)if(Number(e)<0){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},t.SCREEN_KEY=-1,t}(),na=
/** @class */function(){function t(t,e,r,i,n,o,s){void 0===e&&(e=0),void 0===r&&(r=!1),void 0===i&&(i=et.FLOAT),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=o,this.instance=s}return t.prototype.destroy=function(){this.buffer=null},t.from=function(e,r,i,n,o){return new t(e,r,i,n,o)},t}(),oa=0,sa=
/** @class */function(){function t(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=oa++,this.disposeRunner=new Ps("disposeBuffer")}return t.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(t.prototype,"index",{get:function(){return this.type===Mt.ELEMENT_ARRAY_BUFFER},
/**
       * Flags whether this is an index buffer.
       *
       * Index buffers are of type `ELEMENT_ARRAY_BUFFER`. Note that setting this property to false will make
       * the buffer of type `ARRAY_BUFFER`.
       *
       * For backwards compatibility.
       */
set:function(t){this.type=t?Mt.ELEMENT_ARRAY_BUFFER:Mt.ARRAY_BUFFER},enumerable:!1,configurable:!0}),t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)},t}(),aa={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var ha={5126:4,5123:2,5121:1},ua=0,la={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},ca=
/** @class */function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=ua++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Ps("disposeGeometry"),this.refCount=0}return t.prototype.addAttribute=function(t,e,r,i,n,o,s,a){if(void 0===r&&(r=0),void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof sa||(e instanceof Array&&(e=new Float32Array(e)),e=new sa(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,i,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new na(l,r,i,n,o,s,a),this.instanced=this.instanced||a,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},t.prototype.addIndex=function(t){return t instanceof sa||(t instanceof Array&&(t=new Uint16Array(t)),t=new sa(t)),t.type=Mt.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},t.prototype.getIndex=function(){return this.indexBuffer},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new sa;for(t in this.attributes){var n=this.attributes[t],o=this.buffers[n.buffer];e.push(o.data),r.push(n.size*ha[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},o=0;o<t.length;o++)i+=e[o],r+=t[o].length;var s=new ArrayBuffer(4*r),a=null,h=0;for(o=0;o<t.length;o++){var u=e[o],l=t[o],c=To(l);n[c]||(n[c]=new aa[c](s)),a=n[c];for(var d=0;d<l.length;d++)a[(d/u|0)*i+h+d%u]=l[d];h+=u}return new Float32Array(s)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},t.prototype.clone=function(){for(var e=new t,r=0;r<this.buffers.length;r++)e.buffers[r]=new sa(this.buffers[r].data.slice(0));for(var r in this.attributes){var i=this.attributes[r];e.attributes[r]=new na(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Mt.ELEMENT_ARRAY_BUFFER),e},t.merge=function(e){for(var r,i=new t,n=[],o=[],s=[],a=0;a<e.length;a++){r=e[a];for(var h=0;h<r.buffers.length;h++)o[h]=o[h]||0,o[h]+=r.buffers[h].data.length,s[h]=0}for(a=0;a<r.buffers.length;a++)n[a]=new(la[To(r.buffers[a].data)])(o[a]),i.buffers[a]=new sa(n[a]);for(a=0;a<e.length;a++){r=e[a];for(h=0;h<r.buffers.length;h++)n[h].set(r.buffers[h].data,s[h]),s[h]+=r.buffers[h].data.length}if(i.attributes=r.attributes,r.indexBuffer){i.indexBuffer=i.buffers[r.buffers.indexOf(r.indexBuffer)],i.indexBuffer.type=Mt.ELEMENT_ARRAY_BUFFER;var u=0,l=0,c=0,d=0;for(a=0;a<r.buffers.length;a++)if(r.buffers[a]!==r.indexBuffer){d=a;break}for(var a in r.attributes){var p=r.attributes[a];(0|p.buffer)===d&&(l+=p.size*ha[p.type]/4)}for(a=0;a<e.length;a++){var f=e[a].indexBuffer.data;for(h=0;h<f.length;h++)i.indexBuffer.data[h+c]+=u;u+=e[a].buffers[d].data.length/l,c+=f.length}}return i},t}(),da=
/** @class */function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return Ds(e,t),e}(ca),pa=
/** @class */function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new sa(e.vertices),e.uvBuffer=new sa(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return Ds(e,t),e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(ca),fa=0,ma=
/** @class */function(){function t(t,e,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=fa++,this.static=!!e,this.ubo=!!r,t instanceof sa?(this.buffer=t,this.buffer.type=Mt.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new sa(new Float32Array(1)),this.buffer.type=Mt.UNIFORM_BUFFER,this.autoManage=!0))}return t.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},t.prototype.add=function(e,r,i){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new t(r,i)},t.from=function(e,r,i){return new t(e,r,i)},t.uboFrom=function(e,r){return new t(e,null==r||r,!0)},t}(),_a=
/** @class */function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Et.NONE,this.sourceFrame=new Zo,this.destinationFrame=new Zo,this.bindingSourceFrame=new Zo,this.bindingDestinationFrame=new Zo,this.filters=[],this.transform=null}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},t}(),ga=[new qo,new qo,new qo,new qo],ya=new rs,va=
/** @class */function(){function t(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new ia,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new da,this.quadUv=new pa,this.tempRect=new Zo,this.activeState={},this.globalUniforms=new ma({outputFrame:new Zo,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,
// legacy variables
filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t.prototype.push=function(t,e){for(var r,i,n=this.renderer,o=this.defaultFilterStack,s=this.statePool.pop()||new _a,a=this.renderer.renderTexture,h=e[0].resolution,u=e[0].multisample,l=e[0].padding,c=e[0].autoFit,d=null===(r=e[0].legacy)||void 0===r||r,p=1;p<e.length;p++){var f=e[p];h=Math.min(h,f.resolution),u=Math.min(u,f.multisample),l=this.useMaxPadding?Math.max(l,f.padding):l+f.padding,c=c&&f.autoFit,d=d||null===(i=f.legacy)||void 0===i||i}1===o.length&&(this.defaultFilterStack[0].renderTexture=a.current),o.push(s),s.resolution=h,s.multisample=u,s.legacy=d,s.target=t,s.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),s.sourceFrame.pad(l);var m=this.tempRect.copyFrom(a.sourceFrame);n.projection.transform&&this.transformAABB(ya.copyFrom(n.projection.transform).invert(),m),c?(s.sourceFrame.fit(m),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(m)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,a.current?a.current.resolution:n.resolution,a.sourceFrame,a.destinationFrame,n.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,h,u),s.filters=e,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;var _=this.tempRect;_.x=0,_.y=0,_.width=s.sourceFrame.width,_.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(a.sourceFrame),s.bindingDestinationFrame.copyFrom(a.destinationFrame),s.transform=n.projection.transform,n.projection.transform=null,a.bind(s.renderTexture,s.sourceFrame,_),n.framebuffer.clear(0,0,0,0)},t.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,o=i.inputPixel,s=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*e.resolution),o[1]=Math.round(n[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],s[0]=.5*o[2],s[1]=.5*o[3],s[2]=e.sourceFrame.width*n[2]-.5*o[2],s[3]=e.sourceFrame.height*n[3]-.5*o[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,pt.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){1===c&&e.multisample>1&&((l=this.getOptimalFilterTexture(u.width,u.height,e.resolution)).filterFrame=u.filterFrame),r[c].apply(this,u,l,pt.CLEAR,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,pt.BLEND,e),c>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.bindAndClear=function(t,e){void 0===e&&(e=pt.CLEAR);var r=this.renderer,i=r.renderTexture,n=r.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,i.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var s=1&n.stateId||this.forceClear;(e===pt.CLEAR||e===pt.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)},t.prototype.applyFilter=function(t,e,r,i){var n=this.renderer;n.state.set(t.state),this.bindAndClear(r,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(K.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(K.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,o=e._texture.orig,s=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(rs.TEMP_MATRIX);return a.invert(),s.prepend(a),s.scale(1/o.width,1/o.height),s.translate(e.anchor.x,e.anchor.y),s},t.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,r,i){return void 0===r&&(r=1),void 0===i&&(i=Et.NONE),this.texturePool.getOptimalTexture(t,e,r,i)},t.prototype.getFilterTexture=function(t,e,r){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var n=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,r||Et.NONE);return n.filterFrame=t.filterFrame,n},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t.prototype.transformAABB=function(t,e){var r=ga[0],i=ga[1],n=ga[2],o=ga[3];r.set(e.left,e.top),i.set(e.left,e.bottom),n.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(r,r),t.apply(i,i),t.apply(n,n),t.apply(o,o);var s=Math.min(r.x,i.x,n.x,o.x),a=Math.min(r.y,i.y,n.y,o.y),h=Math.max(r.x,i.x,n.x,o.x),u=Math.max(r.y,i.y,n.y,o.y);e.x=s,e.y=a,e.width=h-s,e.height=u-a},t.prototype.roundFrame=function(t,e,r,i,n){if(!(t.width<=0||t.height<=0||r.width<=0||r.height<=0)){if(n){var o=n.a,s=n.b,a=n.c,h=n.d;if((Math.abs(s)>1e-4||Math.abs(a)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(h)>1e-4))return}(n=n?ya.copyFrom(n):ya.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}},t}(),ba=
/** @class */function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),xa=
/** @class */function(){function t(t){this.renderer=t,this.emptyRenderer=new ba(t),this.currentRenderer=this.emptyRenderer}return t.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},t.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,o=t.ids,s=t.count,a=0,h=0;h<s;h++){var u=n[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)o[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){o[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},t.prototype.destroy=function(){this.renderer=null},t}(),Ta=0,Ea=
/** @class */function(){function t(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(t.prototype,"isLost",{
/**
       * `true` if the context is lost
       * @readonly
       */
get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Ta++},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Ta++,this.renderer.runners.contextChange.emit(t)},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var r;if(Kt.PREFER_ENV>=X.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var t=this.gl,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),
// Floats and half-floats
floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{
// Floats and half-floats
colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},t.prototype.handleContextLost=function(t){var e=this;t.preventDefault(),setTimeout((function(){e.gl.isContextLost()&&e.extensions.loseContext&&e.extensions.loseContext.restoreContext()}),0)},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(t){var e=t.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),e&&e.stencil;var i=r||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i},t}(),Sa=
/** @class */
function(){return function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Et.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}(),Ma=new Zo,Pa=
/** @class */function(){function t(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Zs(10,10),this.msaaSamples=null}return t.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Zo,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;Kt.PREFER_ENV===X.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},t.prototype.bind=function(t,e,r){void 0===r&&(r=0);var i=this.gl;if(t){var n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==r&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=r),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,r)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var o=0;o<t.colorTextures.length;o++){var s=t.colorTextures[o];this.renderer.texture.unbind(s.parentTextureArray||s)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var a=e.width>>r,h=e.height>>r,u=a/e.width;this.setViewport(e.x*u,e.y*u,a,h)}else{a=t.width>>r,h=t.height>>r;this.setViewport(0,0,a,h)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(t,e,r,i){var n=this.viewport;t=Math.round(t),e=Math.round(e),r=Math.round(r),i=Math.round(i),n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},Object.defineProperty(t.prototype,"size",{
/**
       * Get the size of the current width and height. Returns object with `width` and `height` values.
       * @readonly
       */
get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(t,e,r,i,n){void 0===n&&(n=Y.COLOR|Y.DEPTH);var o=this.gl;o.clearColor(t,e,r,i),o.clear(n)},t.prototype.initFramebuffer=function(t){var e=this.gl,r=new Sa(e.createFramebuffer());return r.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(t),t.disposeRunner.add(this),r},t.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,r.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,e.RGBA8,t.width,t.height)),r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),r.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var i=t.colorTextures,n=i.length;e.drawBuffers||(n=Math.min(n,1));for(var o=0;o<n;o++){var s=i[o],a=s.parentTextureArray||s;this.renderer.texture.bind(a,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t,e){var r=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures,o=n.length;r.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?(i.msaaBuffer=i.msaaBuffer||r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.RGBA8,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,i.msaaBuffer)):i.msaaBuffer&&(r.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));for(var s=[],a=0;a<o;a++){var h=n[a],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),0===a&&i.msaaBuffer||(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+a,h.target,u._glTextures[this.CONTEXT_UID].texture,e),s.push(r.COLOR_ATTACHMENT0+a))}if((s.length>1&&r.drawBuffers(s),t.depthTexture)&&this.writeDepthTexture){var l=t.depthTexture;this.renderer.texture.bind(l,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?i.stencil&&(r.deleteRenderbuffer(i.stencil),i.stencil=null):(i.stencil=i.stencil||r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,i.stencil))},t.prototype.canMultisampleFramebuffer=function(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture},t.prototype.detectSamples=function(t){var e=this.msaaSamples,r=Et.NONE;if(t<=1||null===e)return r;for(var i=0;i<e.length;i++)if(e[i]<=t){r=e[i];break}return 1===r&&(r=Et.NONE),r},t.prototype.blit=function(t,e,r){var i=this,n=i.current,o=i.renderer,s=i.gl,a=i.CONTEXT_UID;if(2===o.context.webGLVersion&&n){var h=n.glFramebuffers[a];if(h){if(!t){if(!h.msaaBuffer)return;var u=n.colorTextures[0];if(!u)return;h.blitFramebuffer||(h.blitFramebuffer=new Zs(n.width,n.height),h.blitFramebuffer.addColorTexture(0,u)),(t=h.blitFramebuffer).colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),t.width===n.width&&t.height===n.height||(t.width=n.width,t.height=n.height,t.dirtyId++,t.dirtySize++)}e||((e=Ma).width=n.width,e.height=n.height),r||(r=e);var l=e.width===r.width&&e.height===r.height;this.bind(t),s.bindFramebuffer(s.READ_FRAMEBUFFER,h.framebuffer),s.blitFramebuffer(e.left,e.top,e.right,e.bottom,r.left,r.top,r.right,r.bottom,s.COLOR_BUFFER_BIT,l?s.NEAREST:s.LINEAR)}}},t.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&i.deleteRenderbuffer(r.msaaBuffer),r.stencil&&i.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&r.blitFramebuffer.dispose()}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},t.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.stencil=!0;var r=t.width,i=t.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,n.DEPTH24_STENCIL8,r,i):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Zo},t.prototype.destroy=function(){this.renderer=null},t}(),Aa={5126:4,5123:2,5121:1},Ra=
/** @class */function(){function t(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return t.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){var r=this.renderer.context.extensions.vertexArrayObject;Kt.PREFER_ENV===X.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=function(){return r.createVertexArrayOES()},t.bindVertexArray=function(t){return r.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return r.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(2!==e.webGLVersion){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,o){return i.drawElementsInstancedANGLE(t,e,r,n,o)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);var o=i[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,r=0;r<t.buffers.length;r++){var i=t.buffers[r];e.update(i)}},t.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var o in r)i[o]&&n.push(o,i[o].location);return n.join("-")},t.prototype.initGeometryVao=function(t,e,r){void 0===r&&(r=!0);var i=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,s=e.program;s.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,s);var a=this.getSignature(t,s),h=t.glVertexArrayObjects[this.CONTEXT_UID],u=h[a];if(u)return h[s.id]=u,u;var l=t.buffers,c=t.attributes,d={},p={};for(var f in l)d[f]=0,p[f]=0;for(var f in c)!c[f].size&&s.attributeData[f]?c[f].size=s.attributeData[f].size:c[f].size,d[c[f].buffer]+=c[f].size*Aa[c[f].type];for(var f in c){var m=c[f],_=m.size;void 0===m.stride&&(d[m.buffer]===_*Aa[m.type]?m.stride=0:m.stride=d[m.buffer]),void 0===m.start&&(m.start=p[m.buffer],p[m.buffer]+=_*Aa[m.type])}u=i.createVertexArray(),i.bindVertexArray(u);for(var g=0;g<l.length;g++){var y=l[g];o.bind(y),r&&y._glBuffers[n].refCount++}return this.activateVao(t,s),this._activeVao=u,h[s.id]=u,h[a]=u,u},t.prototype.disposeGeometry=function(t,e){var r;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,o=t.buffers,s=null===(r=this.renderer)||void 0===r?void 0:r.buffer;if(t.disposeRunner.remove(this),i){if(s)for(var a=0;a<o.length;a++){var h=o[a]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,0!==h.refCount||e||s.dispose(o[a],e))}if(!e)for(var u in i)if("g"===u[0]){var l=i[u];this._activeVao===l&&this.unbind(),n.deleteVertexArray(l)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t)},t.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,s=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);var a=null;for(var h in s){var u=s[h],l=o[u.buffer],c=l._glBuffers[i];if(e.attributeData[h]){a!==c&&(n.bind(l),a=c);var d=e.attributeData[h].location;if(r.enableVertexAttribArray(d),r.vertexAttribPointer(d,u.size,u.type||r.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(d,1)}}}},t.prototype.draw=function(t,e,r,i){var n=this.gl,o=this._activeGeometry;if(o.indexBuffer){var s=o.indexBuffer.data.BYTES_PER_ELEMENT,a=2===s?n.UNSIGNED_SHORT:n.UNSIGNED_INT;(2===s||4===s&&this.canUseUInt32ElementIndex)&&(o.instanced?n.drawElementsInstanced(t,e||o.indexBuffer.data.length,a,(r||0)*s,i||1):n.drawElements(t,e||o.indexBuffer.data.length,a,(r||0)*s))}else o.instanced?n.drawArraysInstanced(t,r,e||o.getSize(),i||1):n.drawArrays(t,r,e||o.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t.prototype.destroy=function(){this.renderer=null},t}(),wa=
/** @class */function(){function t(t){void 0===t&&(t=null),this.type=vt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Kt.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return Object.defineProperty(t.prototype,"filter",{
/**
       * The sprite mask filter.
       * If set to `null`, the default sprite mask filter is used.
       * @default null
       */
get:function(){return this._filters?this._filters[0]:null},set:function(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=vt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},t.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},t}();function Ia(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function Ca(t,e){var r=t.getShaderSource(e).split("\n").map((function(t,e){return e+": "+t})),i=t.getShaderInfoLog(e).split("\n"),n={},o=i.map((function(t){return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(t){return!(!t||n[t])&&(n[t]=!0,!0)})),s=[""];o.forEach((function(t){r[t-1]="%c"+r[t-1]+"%c",s.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var a=r.join("\n");s[0]=a}function Oa(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}function Da(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Oa(2*e);case"bvec3":return Oa(3*e);case"bvec4":return Oa(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Fa,La={},Ba=La;function Na(){if(Ba===La||Ba&&Ba.isContextLost()){var t=Kt.ADAPTER.createCanvas(),e=void 0;Kt.PREFER_ENV>=X.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),Ba=e}return Ba}function Ua(t,e,r){if("precision"!==t.substring(0,9)){var i=e;return e===gt.HIGH&&r!==gt.HIGH&&(i=gt.MEDIUM),"precision "+i+" float;\n"+t}return r!==gt.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var Ga={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function ka(t){return Ga[t]}var Xa=null,ja={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Va(t,e){if(!Xa){var r=Object.keys(ja);Xa={};for(var i=0;i<r.length;++i){var n=r[i];Xa[t[n]]=ja[n]}}return Xa[e]}var Ha=[
// a float cache layer
{test:function(t){return"float"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},
// handling samplers
{test:function(t,e){return!("sampler2D"!==t.type&&"samplerCube"!==t.type&&"sampler2DArray"!==t.type||1!==t.size||t.isArray||null!=e&&void 0===e.castToBaseTexture)},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},
// uploading pixi matrix object to mat3
{test:function(t,e){return"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '},codeUbo:function(t){return"\n                var "+t+"_matrix = uv."+t+".toArray(true);\n\n                data[offset] = "+t+"_matrix[0];\n                data[offset+1] = "+t+"_matrix[1];\n                data[offset+2] = "+t+"_matrix[2];\n        \n                data[offset + 4] = "+t+"_matrix[3];\n                data[offset + 5] = "+t+"_matrix[4];\n                data[offset + 6] = "+t+"_matrix[5];\n        \n                data[offset + 8] = "+t+"_matrix[6];\n                data[offset + 9] = "+t+"_matrix[7];\n                data[offset + 10] = "+t+"_matrix[8];\n            "}},
// uploading a pixi point as a vec2 with caching layer
{test:function(t,e){return"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'},codeUbo:function(t){return"\n                v = uv."+t+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},
// caching layer for a vec2
{test:function(t){return"vec2"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},
// upload a pixi rectangle as a vec4 with caching layer
{test:function(t,e){return"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(t){return"\n                    v = uv."+t+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},
// a caching layer for vec4 uploading
{test:function(t){return"vec4"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],Ya={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},za={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Wa,qa=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Ka(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}function Za(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=qa.replace(/%forloop%/gi,Ka(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}var $a=0,Ja={},Qa=
/** @class */function(){function t(e,r,i){void 0===i&&(i="pixi-shader"),this.id=$a++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Ja[i]?(Ja[i]++,i+="-"+Ja[i]):Ja[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Ua(this.vertexSrc,Kt.PRECISION_VERTEX,gt.HIGH),this.fragmentSrc=Ua(this.fragmentSrc,Kt.PRECISION_FRAGMENT,function(){if(!Fa){Fa=gt.MEDIUM;var t=Na();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Fa=e.precision?gt.HIGH:gt.MEDIUM}}return Fa}())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(t,"defaultVertexSrc",{
/**
       * The default vertex shader source.
       * @constant
       */
get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{
/**
       * The default fragment shader source.
       * @constant
       */
get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),t.from=function(e,r,i){var n=e+r,o=Do[n];return o||(Do[n]=o=new t(e,r,i)),o},t}(),th=
/** @class */function(){function t(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof ma?e:new ma(e):new ma({}),this.disposeRunner=new Ps("disposeShader")}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()},Object.defineProperty(t.prototype,"uniforms",{
/**
       * Shader uniform values, shortcut for `uniformGroup.uniforms`.
       * @readonly
       */
get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,r,i){return new t(Qa.from(e,r),i)},t}(),eh=
/** @class */function(){function t(){this.data=0,this.blendMode=W.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(t.prototype,"blend",{
/**
       * Activates blending of the computed fragment color values.
       * @default true
       */
get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{
/**
       * Activates adding an offset to depth values of polygon's fragments
       * @default false
       */
get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"culling",{
/**
       * Activates culling of polygons.
       * @default false
       */
get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{
/**
       * Activates depth comparisons and updates to the depth buffer.
       * @default false
       */
get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthMask",{
/**
       * Enables or disables writing to the depth buffer.
       * @default true
       */
get:function(){return!!(32&this.data)},set:function(t){!!(32&this.data)!==t&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clockwiseFrontFace",{
/**
       * Specifies whether or not front or back-facing polygons can be culled.
       * @default false
       */
get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{
/**
       * The blend mode to be applied when this state is set. Apply a value of `PIXI.BLEND_MODES.NORMAL` to reset the blend mode.
       * Setting this mode to anything other than NO_BLEND will automatically switch blending on.
       * @default PIXI.BLEND_MODES.NORMAL
       */
get:function(){return this._blendMode},set:function(t){this.blend=t!==W.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonOffset",{
/**
       * The polygon offset. Setting this property to anything other than 0 will automatically enable polygon offset fill.
       * @default 0
       */
get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},t.for2d=function(){var e=new t;return e.depthTest=!1,e.blend=!0,e},t}(),rh=
/** @class */function(t){function e(r,i,n){var o=this,s=Qa.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);return(o=t.call(this,s,n)||this).padding=0,o.resolution=Kt.FILTER_RESOLUTION,o.multisample=Kt.FILTER_MULTISAMPLE,o.enabled=!0,o.autoFit=!0,o.state=new eh,o}return Ds(e,t),e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i)},Object.defineProperty(e.prototype,"blendMode",{
/**
       * Sets the blend mode of the filter.
       * @default PIXI.BLEND_MODES.NORMAL
       */
get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{
/**
       * The resolution of the filter. Setting this to be lower will lower the quality but
       * increase the performance of the filter.
       */
get:function(){return this._resolution},set:function(t){this._resolution=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{
/**
       * The default vertex shader source
       * @constant
       */
get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{
/**
       * The default fragment shader source
       * @constant
       */
get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),e}(th),ih=new rs,nh=
/** @class */function(){function t(t,e){this._texture=t,this.mapCoord=new rs,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{
/** Texture property. */
get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],o=t[i+1];e[i]=n*r.a+o*r.c+r.tx,e[i+1]=n*r.b+o*r.d+r.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(ih.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(ih));var o=e.baseTexture,s=this.uClampFrame,a=this.clampMargin/o.resolution,h=this.clampOffset;return s[0]=(e._frame.x+a+h)/o.width,s[1]=(e._frame.y+a+h)/o.height,s[2]=(e._frame.x+e._frame.width-a+h)/o.width,s[3]=(e._frame.y+e._frame.height-a+h)/o.height,this.uClampOffset[0]=h/o.realWidth,this.uClampOffset[1]=h/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&0===e.rotate,!0},t}(),oh=
/** @class */function(t){function e(e,r,i){var n=this,o=null;return"string"!=typeof e&&void 0===r&&void 0===i&&(o=e,e=void 0,r=void 0,i=void 0),(n=t.call(this,e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",r||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",i)||this).maskSprite=o,n.maskMatrix=new rs,n}return Ds(e,t),Object.defineProperty(e.prototype,"maskSprite",{
/**
       * Sprite mask
       * @type {PIXI.DisplayObject}
       */
get:function(){return this._maskSprite},set:function(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),e.prototype.apply=function(t,e,r,i){var n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new nh(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,r,i))},e}(rh),sh=
/** @class */function(){function t(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},t.prototype.push=function(t,e){var r=e;if(!r.isMaskData){var i=this.maskDataPool.pop()||new wa;i.pooled=!0,i.maskObject=e,r=i}var n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(n),r._colorMask=n?n._colorMask:15,r.autoDetect&&this.detect(r),r._target=t,r.type!==vt.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case vt.SCISSOR:this.renderer.scissor.push(r);break;case vt.STENCIL:this.renderer.stencil.push(r);break;case vt.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case vt.COLOR:this.pushColorMask(r)}r.type===vt.SPRITE&&this.maskStack.push(r)},t.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case vt.SCISSOR:this.renderer.scissor.pop(e);break;case vt.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case vt.SPRITE:this.popSpriteMask(e);break;case vt.COLOR:this.popColorMask(e)}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){var r=this.maskStack[this.maskStack.length-1];r.type===vt.SPRITE&&r._filters&&(r._filters[0].maskSprite=r.maskObject)}}},t.prototype.detect=function(t){var e=t.maskObject;e?e.isSprite?t.type=vt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=vt.SCISSOR:t.type=vt.STENCIL:t.type=vt.COLOR},t.prototype.pushSpriteMask=function(t){var e,r,i=t.maskObject,n=t._target,o=t._filters;o||(o=this.alphaMaskPool[this.alphaMaskIndex])||(o=this.alphaMaskPool[this.alphaMaskIndex]=[new oh]);var s,a,h=this.renderer,u=h.renderTexture;if(u.current){var l=u.current;s=t.resolution||l.resolution,a=null!==(e=t.multisample)&&void 0!==e?e:l.multisample}else s=t.resolution||h.resolution,a=null!==(r=t.multisample)&&void 0!==r?r:h.multisample;o[0].resolution=s,o[0].multisample=a,o[0].maskSprite=i;var c=n.filterArea;n.filterArea=i.getBounds(!0),h.filter.push(n,o),n.filterArea=c,t._filters||this.alphaMaskIndex++},t.prototype.popSpriteMask=function(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},t.prototype.pushColorMask=function(t){var e=t._colorMask,r=t._colorMask=e&t.colorMask;r!==e&&this.renderer.gl.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r))},t.prototype.popColorMask=function(t){var e=t._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==e&&this.renderer.gl.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r))},t.prototype.destroy=function(){this.renderer=null},t}(),ah=
/** @class */function(){function t(t){this.renderer=t,this.maskStack=[],this.glConst=0}return t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){this.renderer=null,this.maskStack=null},t}(),hh=new rs,uh=[],lh=
/** @class */function(t){function e(e){var r=t.call(this,e)||this;return r.glConst=Kt.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,r}return Ds(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.calcScissorRect=function(t){var e;if(!t._scissorRectLocal){var r=t._scissorRect,i=t.maskObject,n=this.renderer,o=n.renderTexture,s=i.getBounds(!0,null!==(e=uh.pop())&&void 0!==e?e:new Zo);this.roundFrameToPixels(s,o.current?o.current.resolution:n.resolution,o.sourceFrame,o.destinationFrame,n.projection.transform),r&&s.fit(r),t._scissorRectLocal=s}},e.isMatrixRotated=function(t){if(!t)return!1;var e=t.a,r=t.b,i=t.c,n=t.d;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)},e.prototype.testScissor=function(t){var r=t.maskObject;if(!r.isFastRect||!r.isFastRect())return!1;if(e.isMatrixRotated(r.worldTransform))return!1;if(e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var i=t._scissorRectLocal;return i.width>0&&i.height>0},e.prototype.roundFrameToPixels=function(t,r,i,n,o){e.isMatrixRotated(o)||((o=o?hh.copyFrom(o):hh.identity()).translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.renderer.filter.transformAABB(o,t),t.fit(n),t.x=Math.round(t.x*r),t.y=Math.round(t.y*r),t.width=Math.round(t.width*r),t.height=Math.round(t.height*r))},e.prototype.push=function(t){t._scissorRectLocal||this.calcScissorRect(t);var e=this.renderer.gl;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;t&&uh.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t,e=this.maskStack[this.maskStack.length-1]._scissorRect;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)},e}(ah),ch=
/** @class */function(t){function e(e){var r=t.call(this,e)||this;return r.glConst=Kt.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,r}return Ds(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),t._stencilCounter++;var n=t._colorMask;0!==n&&(t._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,i,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==n&&(t._colorMask=n,r.colorMask(!!(1&n),!!(2&n),!!(4&n),!!(8&n))),this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;if(0===this.getStackLength())e.disable(e.STENCIL_TEST);else{var r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,i=r?r._colorMask:15;0!==i&&(r._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==i&&(r._colorMask=i,e.colorMask(!!(1&i),!!(2&i),!!(4&i),!!(8&i))),this._useCurrent()}},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e}(ah),dh=
/** @class */function(){function t(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new rs,this.transform=null}return t.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix,o=i?-1:1;n.identity(),n.a=1/e.width*2,n.d=o*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-o-e.y*n.d},t.prototype.setTransform=function(t){},t.prototype.destroy=function(){this.renderer=null},t}(),ph=new Zo,fh=new Zo,mh=
/** @class */function(){function t(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Zo,this.destinationFrame=new Zo,this.viewportFrame=new Zo}return t.prototype.bind=function(t,e,r){void 0===t&&(t=null);var i,n,o,s=this.renderer;this.current=t,t?(o=(i=t.baseTexture).resolution,e||(ph.width=t.frame.width,ph.height=t.frame.height,e=ph),r||(fh.x=t.frame.x,fh.y=t.frame.y,fh.width=e.width,fh.height=e.height,r=fh),n=i.framebuffer):(o=s.resolution,e||(ph.width=s.screen.width,ph.height=s.screen.height,e=ph),r||((r=ph).width=e.width,r.height=e.height));var a=this.viewportFrame;a.x=r.x*o,a.y=r.y*o,a.width=r.width*o,a.height=r.height*o,t||(a.y=s.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(n,a),this.renderer.projection.update(r,e,o,!n),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(r)},t.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor;var r=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer.screen,n=r.width!==i.width||r.height!==i.height;if(n){var o=this.viewportFrame,s=o.x,a=o.y,h=o.width,u=o.height;s=Math.round(s),a=Math.round(a),h=Math.round(h),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(s,a,h,u)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),n&&this.renderer.scissor.pop()},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t.prototype.destroy=function(){this.renderer=null},t}();function _h(t,e,r,i,n){r.buffer.update(n)}var gh={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},yh={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function vh(t){for(var e=t.map((function(t){return{data:t,offset:0,dataLen:0,dirty:0}})),r=0,i=0,n=0,o=0;o<e.length;o++){var s=e[o];if(r=yh[s.data.type],s.data.size>1&&(r=Math.max(r,16)*s.data.size),s.dataLen=r,i%r!=0&&i<16){var a=i%r%16;i+=a,n+=a}i+r>16?(n=16*Math.ceil(n/16),s.offset=n,n+=r,i=r):(s.offset=n,i+=r,n+=r)}return{uboElements:e,size:n=16*Math.ceil(n/16)}}function bh(t,e){var r=[];for(var i in t)e[i]&&r.push(e[i]);return r.sort((function(t,e){return t.index-e.index})),r}function xh(t,e){if(!t.autoManage)return{size:0,syncFunc:_h};for(var r=vh(bh(t.uniforms,e)),i=r.uboElements,n=r.size,o=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],s=0;s<i.length;s++){for(var a=i[s],h=t.uniforms[a.data.name],u=a.data.name,l=!1,c=0;c<Ha.length;c++){var d=Ha[c];if(d.codeUbo&&d.test(a.data,h)){o.push("offset = "+a.offset/4+";",Ha[c].codeUbo(a.data.name,h)),l=!0;break}}if(!l)if(a.data.size>1){var p=ka(a.data.type),f=Math.max(yh[a.data.type]/16,1),m=p/f,_=(4-m%4)%4;o.push("\n                cv = ud."+u+".value;\n                v = uv."+u+";\n                offset = "+a.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+a.data.size*f+"; i++)\n                {\n                    for(var j = 0; j < "+m+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+_+";\n                }\n\n                ")}else{var g=gh[a.data.type];o.push("\n                cv = ud."+u+".value;\n                v = uv."+u+";\n                offset = "+a.offset/4+";\n                "+g+";\n                ")}}return o.push("\n       renderer.buffer.update(buffer);\n    "),{size:n,
// eslint-disable-next-line no-new-func
syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join("\n"))}}var Th=
/** @class */
function(){return function(){}}(),Eh=
/** @class */function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},t}();function Sh(t,e){var r=Ia(t,t.VERTEX_SHADER,e.vertexSrc),i=Ia(t,t.FRAGMENT_SHADER,e.fragmentSrc),n=t.createProgram();if(t.attachShader(n,r),t.attachShader(n,i),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||function(t,e,r,i){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||Ca(t,r),t.getShaderParameter(i,t.COMPILE_STATUS)||Ca(t,i),t.getProgramInfoLog(e))}(t,n,r,i),e.attributeData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),n=0;n<i;n++){var o=e.getActiveAttrib(t,n);if(0!==o.name.indexOf("gl_")){var s=Va(e,o.type),a={type:s,name:o.name,size:ka(s),location:e.getAttribLocation(t,o.name)};r[o.name]=a}}return r}(n,t),e.uniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var o=e.getActiveUniform(t,n),s=o.name.replace(/\[.*?\]$/,""),a=!!o.name.match(/\[.*?\]$/),h=Va(e,o.type);r[s]={name:s,index:n,type:h,size:o.size,isArray:a,value:Da(h,o.size)}}return r}(n,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var o=Object.keys(e.attributeData);o.sort((function(t,e){return t>e?1:-1}));for(var s=0;s<o.length;s++)e.attributeData[o[s]].location=s,t.bindAttribLocation(n,s,o[s]);t.linkProgram(n)}t.deleteShader(r),t.deleteShader(i);var a={};for(var s in e.uniformData){var h=e.uniformData[s];a[s]={location:t.getUniformLocation(n,s),value:Da(h.type,h.size)}}return new Eh(n,a)}var Mh=0,Ph={textureCount:0,uboCount:0},Ah=
/** @class */function(){function t(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Mh++}return t.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Wa)return Wa;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Wa=!0===t({a:"b"},"a","b")}catch(pm){Wa=!1}return Wa}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},t.prototype.bind=function(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(Ph.textureCount=0,Ph.uboCount=0,this.syncUniformGroup(t.uniformGroup,Ph)),i},t.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t,e){var r=this.getGlProgram();t.static&&t.dirtyId===r.uniformDirtyGroups[t.id]||(r.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},t.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var r,i=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var n in t.uniforms){var o=e[n];if(o){for(var s=t.uniforms[n],a=!1,h=0;h<Ha.length;h++)if(Ha[h].test(o,s)){i.push(Ha[h].code(n,s)),a=!0;break}if(!a){var u=(1!==o.size||o.isArray?za:Ya)[o.type].replace("location",'ud["'+n+'"].location');i.push('\n            cu = ud["'+n+'"];\n            cv = cu.value;\n            v = uv["'+n+'"];\n            '+u+";")}}else(null===(r=t.uniforms[n])||void 0===r?void 0:r.group)&&(t.uniforms[n].ubo?i.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+n+", '"+n+"');\n                    "):i.push("\n                        renderer.shader.syncUniformGroup(uv."+n+", syncData);\n                    "))}return new Function("ud","uv","renderer","syncData",i.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},t.prototype.syncUniformBufferGroup=function(t,e){var r=this.getGlProgram();if(!t.static||0!==t.dirtyId||!r.uniformGroups[t.id]){t.dirtyId=0;var i=r.uniformGroups[t.id]||this.createSyncBufferGroup(t,r,e);t.buffer.update(),i(r.uniformData,t.uniforms,this.renderer,Ph,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,r.uniformBufferBindings[e])},t.prototype.createSyncBufferGroup=function(t,e,r){var i=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var n=this.gl.getUniformBlockIndex(e.program,r);e.uniformBufferBindings[r]=this.shader.uniformBindCount,i.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;var o=this.getSignature(t,this.shader.program.uniformData,"ubo"),s=this._uboCache[o];if(s||(s=this._uboCache[o]=xh(t,this.shader.program.uniformData)),t.autoManage){var a=new Float32Array(s.size/4);t.buffer.update(a)}return e.uniformGroups[t.id]=s.syncFunc,e.uniformGroups[t.id]},t.prototype.getSignature=function(t,e,r){var i=t.uniforms,n=[r+"-"];for(var o in i)n.push(o),e[o]&&n.push(e[o].type);return n.join("-")},t.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateProgram=function(t){var e=this.gl,r=t.program,i=Sh(e,r);return r.glPrograms[this.renderer.CONTEXT_UID]=i,i},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.disposeShader=function(t){this.shader===t&&(this.shader=null)},t.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},t}();var Rh=
/** @class */function(){function t(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=W.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new eh,this.defaultState.blend=!0}return t.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[W.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.ADD]=[t.ONE,t.ONE],e[W.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.NONE]=[0,0],e[W.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[W.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[W.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[W.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[W.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[W.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[W.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[W.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[W.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[W.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},t.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(r=0;r<this.checks.length;r++)this.checks[r](this,t)},t.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setDepthMask=function(t){this.gl.depthMask(t)},t.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},t.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},t.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},t.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},t.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},t.prototype.destroy=function(){this.gl=null},t}(),wh=
/** @class */function(){function t(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=Kt.GC_MAX_IDLE,this.checkCountMax=Kt.GC_MAX_CHECK_COUNT,this.mode=Kt.GC_MODE}return t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==mt.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){var o=0;for(i=0;i<e.length;i++)null!==e[i]&&(e[o++]=e[i]);e.length=o}},t.prototype.unload=function(t){var e=this.renderer.texture,r=t._texture;r&&!r.framebuffer&&e.destroyTexture(r);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},t.prototype.destroy=function(){this.renderer=null},t}();var Ih=
/** @class */
function(){return function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=et.UNSIGNED_BYTE,this.internalFormat=$.RGBA,this.samplerType=0}}(),Ch=
/** @class */function(){function t(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Us,this.hasIntegerTextures=!1}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){var e,r,i,n,o,s,a,h,u,l,c,d,p,f,m,_,g,y,v,b,x,T,E;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?((e={})[et.UNSIGNED_BYTE]=((r={})[$.RGBA]=t.RGBA8,r[$.RGB]=t.RGB8,r[$.RG]=t.RG8,r[$.RED]=t.R8,r[$.RGBA_INTEGER]=t.RGBA8UI,r[$.RGB_INTEGER]=t.RGB8UI,r[$.RG_INTEGER]=t.RG8UI,r[$.RED_INTEGER]=t.R8UI,r[$.ALPHA]=t.ALPHA,r[$.LUMINANCE]=t.LUMINANCE,r[$.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,r),e[et.BYTE]=((i={})[$.RGBA]=t.RGBA8_SNORM,i[$.RGB]=t.RGB8_SNORM,i[$.RG]=t.RG8_SNORM,i[$.RED]=t.R8_SNORM,i[$.RGBA_INTEGER]=t.RGBA8I,i[$.RGB_INTEGER]=t.RGB8I,i[$.RG_INTEGER]=t.RG8I,i[$.RED_INTEGER]=t.R8I,i),e[et.UNSIGNED_SHORT]=((n={})[$.RGBA_INTEGER]=t.RGBA16UI,n[$.RGB_INTEGER]=t.RGB16UI,n[$.RG_INTEGER]=t.RG16UI,n[$.RED_INTEGER]=t.R16UI,n[$.DEPTH_COMPONENT]=t.DEPTH_COMPONENT16,n),e[et.SHORT]=((o={})[$.RGBA_INTEGER]=t.RGBA16I,o[$.RGB_INTEGER]=t.RGB16I,o[$.RG_INTEGER]=t.RG16I,o[$.RED_INTEGER]=t.R16I,o),e[et.UNSIGNED_INT]=((s={})[$.RGBA_INTEGER]=t.RGBA32UI,s[$.RGB_INTEGER]=t.RGB32UI,s[$.RG_INTEGER]=t.RG32UI,s[$.RED_INTEGER]=t.R32UI,s[$.DEPTH_COMPONENT]=t.DEPTH_COMPONENT24,s),e[et.INT]=((a={})[$.RGBA_INTEGER]=t.RGBA32I,a[$.RGB_INTEGER]=t.RGB32I,a[$.RG_INTEGER]=t.RG32I,a[$.RED_INTEGER]=t.R32I,a),e[et.FLOAT]=((h={})[$.RGBA]=t.RGBA32F,h[$.RGB]=t.RGB32F,h[$.RG]=t.RG32F,h[$.RED]=t.R32F,h[$.DEPTH_COMPONENT]=t.DEPTH_COMPONENT32F,h),e[et.HALF_FLOAT]=((u={})[$.RGBA]=t.RGBA16F,u[$.RGB]=t.RGB16F,u[$.RG]=t.RG16F,u[$.RED]=t.R16F,u),e[et.UNSIGNED_SHORT_5_6_5]=((l={})[$.RGB]=t.RGB565,l),e[et.UNSIGNED_SHORT_4_4_4_4]=((c={})[$.RGBA]=t.RGBA4,c),e[et.UNSIGNED_SHORT_5_5_5_1]=((d={})[$.RGBA]=t.RGB5_A1,d),e[et.UNSIGNED_INT_2_10_10_10_REV]=((p={})[$.RGBA]=t.RGB10_A2,p[$.RGBA_INTEGER]=t.RGB10_A2UI,p),e[et.UNSIGNED_INT_10F_11F_11F_REV]=((f={})[$.RGB]=t.R11F_G11F_B10F,f),e[et.UNSIGNED_INT_5_9_9_9_REV]=((m={})[$.RGB]=t.RGB9_E5,m),e[et.UNSIGNED_INT_24_8]=((_={})[$.DEPTH_STENCIL]=t.DEPTH24_STENCIL8,_),e[et.FLOAT_32_UNSIGNED_INT_24_8_REV]=((g={})[$.DEPTH_STENCIL]=t.DEPTH32F_STENCIL8,g),E=e):((y={})[et.UNSIGNED_BYTE]=((v={})[$.RGBA]=t.RGBA,v[$.RGB]=t.RGB,v[$.ALPHA]=t.ALPHA,v[$.LUMINANCE]=t.LUMINANCE,v[$.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,v),y[et.UNSIGNED_SHORT_5_6_5]=((b={})[$.RGB]=t.RGB,b),y[et.UNSIGNED_SHORT_4_4_4_4]=((x={})[$.RGBA]=t.RGBA,x),y[et.UNSIGNED_SHORT_5_5_5_1]=((T={})[$.RGBA]=t.RGBA,T),E=y),E}(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new Ih(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Ih(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(r=0;r<this.boundTextures.length;r++)this.bind(null,r)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if((t=null==t?void 0:t.castToBaseTexture())&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)):i.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<r.length;i++)r[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(t.target,this.emptyTextures[t.target].texture),r[i]=null)},t.prototype.ensureSamplerType=function(t){var e=this,r=e.boundTextures,i=e.hasIntegerTextures,n=e.CONTEXT_UID;if(i)for(var o=t-1;o>=0;--o){var s=r[o];if(s)s._glTextures[n].samplerType!==it.FLOAT&&this.renderer.texture.unbind(s)}},t.prototype.initTexture=function(t){var e=new Ih(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){var r,i;e.internalFormat=null!==(i=null===(r=this.internalFormats[t.type])||void 0===r?void 0:r[t.format])&&void 0!==i?i:t.format,2===this.webGLVersion&&t.type===et.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e))e.samplerType!==it.FLOAT&&(this.hasIntegerTextures=!0);else{var i=t.realWidth,n=t.realHeight,o=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,o.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&Ao(this.managedTextures,i,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==ut.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=at.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&t.mipmap!==ut.ON_MANUAL&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===ot.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===ot.LINEAR){var n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===ot.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===ot.LINEAR?r.LINEAR:r.NEAREST)},t.prototype.destroy=function(){this.renderer=null},t}(),Oh={__proto__:null,FilterSystem:va,BatchSystem:xa,ContextSystem:Ea,FramebufferSystem:Pa,GeometrySystem:Ra,MaskSystem:sh,ScissorSystem:lh,StencilSystem:ch,ProjectionSystem:dh,RenderTextureSystem:mh,ShaderSystem:Ah,StateSystem:Rh,TextureGCSystem:wh,TextureSystem:Ch},Dh=new rs,Fh=
/** @class */function(t){function e(e,r){void 0===e&&(e=V.UNKNOWN);var i=t.call(this)||this;return r=Object.assign({},Kt.RENDER_OPTIONS,r),i.options=r,i.type=e,i.screen=new Zo(0,0,r.width,r.height),i.view=r.view||Kt.ADAPTER.createCanvas(),i.resolution=r.resolution||Kt.RESOLUTION,i.useContextAlpha=r.useContextAlpha,i.autoDensity=!!r.autoDensity,i.preserveDrawingBuffer=r.preserveDrawingBuffer,i.clearBeforeRender=r.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=r.backgroundColor||i._backgroundColor,i.backgroundAlpha=r.backgroundAlpha,void 0!==r.transparent&&(Oo(0,"Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=r.transparent,i.backgroundAlpha=r.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i}return Ds(e,t),e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(e.prototype,"width",{
/**
       * Same as view.width, actual number of pixels in the canvas by horizontal.
       * @member {number}
       * @readonly
       * @default 800
       */
get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{
/**
       * Same as view.height, actual number of pixels in the canvas by vertical.
       * @member {number}
       * @readonly
       * @default 600
       */
get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(e*this.resolution);var r=this.view.width/this.resolution,i=this.view.height/this.resolution;this.screen.width=r,this.screen.height=i,this.autoDensity&&(this.view.style.width=r+"px",this.view.style.height=i+"px"),this.emit("resize",r,i)},e.prototype.generateTexture=function(t,e,r,i){void 0===e&&(e={}),"number"==typeof e&&(Oo(0,"generateTexture options (scaleMode, resolution, region) are now object options."),e={scaleMode:e,resolution:r,region:i});var n=e.region,o=function(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]])}return r}(e,["region"]);0===(i=n||t.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var s=ra.create(Fs({width:i.width,height:i.height},o));return Dh.tx=-i.x,Dh.ty=-i.y,this.render(t,{renderTexture:s,clear:!1,transform:Dh,skipUpdateTransform:!!t.parent}),s},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var r=this;r.plugins=null,r.type=V.UNKNOWN,r.view=null,r.screen=null,r._tempDisplayObjectParent=null,r.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{
/**
       * The background color to fill if not transparent
       * @member {number}
       */
get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=fo(t),po(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{
/**
       * The background color alpha. Setting this to 0 will make the canvas transparent.
       * @member {number}
       */
get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),e}($t),Lh=
/** @class */
function(){return function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}(),Bh=
/** @class */function(){function t(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return t.prototype.destroy=function(){this.renderer=null},t.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},t.prototype.bind=function(t){var e=this.gl,r=this.CONTEXT_UID,i=t._glBuffers[r]||this.createGLBuffer(t);e.bindBuffer(t.type,i.buffer)},t.prototype.bindBufferBase=function(t,e){var r=this.gl,i=this.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var n=t._glBuffers[i]||this.createGLBuffer(t);this.boundBufferBases[e]=t,r.bindBufferBase(r.UNIFORM_BUFFER,e,n.buffer)}},t.prototype.bindBufferRange=function(t,e,r){var i=this.gl,n=this.CONTEXT_UID;r=r||0;var o=t._glBuffers[n]||this.createGLBuffer(t);i.bindBufferRange(i.UNIFORM_BUFFER,e||0,o.buffer,256*r,256)},t.prototype.update=function(t){var e=this.gl,r=this.CONTEXT_UID,i=t._glBuffers[r];if(t._updateID!==i.updateID)if(i.updateID=t._updateID,e.bindBuffer(t.type,i.buffer),i.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{var n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;i.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}},t.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),r=0;r<e.length;r++)this.dispose(this.managedBuffers[e[r]],t)},t.prototype.createGLBuffer=function(t){var e=this.CONTEXT_UID,r=this.gl;return t._glBuffers[e]=new Lh(r.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]},t}(),Nh=
/** @class */function(t){function e(r){var i=t.call(this,V.WEBGL,r)||this;return r=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new Ps("destroy"),contextChange:new Ps("contextChange"),reset:new Ps("reset"),update:new Ps("update"),postrender:new Ps("postrender"),prerender:new Ps("prerender"),resize:new Ps("resize")},i.runners.contextChange.add(i),i.globalUniforms=new ma({projectionMatrix:new rs},!0),i.addSystem(sh,"mask").addSystem(Ea,"context").addSystem(Rh,"state").addSystem(Ah,"shader").addSystem(Ch,"texture").addSystem(Bh,"buffer").addSystem(Ra,"geometry").addSystem(Pa,"framebuffer").addSystem(lh,"scissor").addSystem(ch,"stencil").addSystem(dh,"projection").addSystem(wh,"textureGC").addSystem(va,"filter").addSystem(mh,"renderTexture").addSystem(xa,"batch"),i.initPlugins(e.__plugins),i.multisample=void 0,r.context?i.context.initFromContext(r.context):i.context.initFromOptions({alpha:!!i.useContextAlpha,antialias:r.antialias,premultipliedAlpha:i.useContextAlpha&&"notMultiplied"!==i.useContextAlpha,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,uo(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return Ds(e,t),e.create=function(t){if(lo())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.contextChange=function(){var t,e=this.gl;if(1===this.context.webGLVersion){var r=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,r)}else{r=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r)}t>=Et.HIGH?this.multisample=Et.HIGH:t>=Et.MEDIUM?this.multisample=Et.MEDIUM:t>=Et.LOW?this.multisample=Et.LOW:this.multisample=Et.NONE},e.prototype.addSystem=function(t,e){var r=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var i in this[e]=r,this.runners)this.runners[i].add(r);return this},e.prototype.render=function(t,e){var r,i,n,o;if(e&&(e instanceof ra?(Oo(0,"Renderer#render arguments changed, use options instead."),r=e,i=arguments[2],n=arguments[3],o=arguments[4]):(r=e.renderTexture,i=e.clear,n=e.transform,o=e.skipUpdateTransform)),this.renderingToScreen=!r,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=n,!this.context.isLost){if(r||(this._lastObjectRendered=t),!o){var s=t.enableTempParent();t.updateTransform(),t.disableTempParent(s)}this.renderTexture.bind(r),this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),r&&r.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.generateTexture=function(e,r,i,n){void 0===r&&(r={});var o=t.prototype.generateTexture.call(this,e,r,i,n);return this.framebuffer.blit(),o},e.prototype.resize=function(e,r){t.prototype.resize.call(this,e,r),this.runners.resize.emit(this.screen.height,this.screen.width)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(e){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();t.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(e.prototype,"extract",{
/**
       * Please use `plugins.extract` instead.
       * @member {PIXI.Extract} extract
       * @deprecated since 6.0.0
       * @readonly
       */
get:function(){return Oo(0,"Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,e){Oo(0,"Renderer.registerPlugin() has been deprecated, please use extensions.add() instead."),Ms.add({name:t,type:vs.RendererPlugin,ref:e})},e.__plugins={},e}(Fh);function Uh(t){return Nh.create(t)}Ms.handleByMap(vs.RendererPlugin,Nh.__plugins);var Gh="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",kh="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",Xh=
/** @class */function(){function t(t){Oo(0,"System class is deprecated, implemement ISystem interface instead."),this.renderer=t}return t.prototype.destroy=function(){this.renderer=null},t}(),jh=
/** @class */
function(){return function(){this.texArray=null,this.blend=0,this.type=K.TRIANGLES,this.start=0,this.size=0,this.data=null}}(),Vh=
/** @class */function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),Hh=
/** @class */function(){function t(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{
/** View on the raw binary data as a `Int8Array`. */
get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{
/** View on the raw binary data as a `Uint8Array`. */
get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{
/**  View on the raw binary data as a `Int16Array`. */
get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{
/** View on the raw binary data as a `Uint16Array`. */
get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{
/** View on the raw binary data as a `Int32Array`. */
get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),Yh=
/** @class */function(t){function e(e){var r=t.call(this,e)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=eh.for2d(),r.size=4*Kt.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),e.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return Ds(e,t),e.prototype.contextChange=function(){var t=this.renderer.gl;Kt.PREFER_ENV===X.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Kt.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=Za(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,r=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new jh);for(;r.length<n;)r.push(new Vh);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,r=this.MAX_TEXTURES,i=e._textureArrayPool,n=this.renderer.batch,o=this._tempBoundTextures,s=this.renderer.textureGC.count,a=++Us._globalBatch,h=0,u=i[0],l=0;n.copyBoundTextures(o,r);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=r&&(n.boundArray(u,o,a,r),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=s,u.elements[u.count++]=d)}u.count>0&&(n.boundArray(u,o,a,r),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(c=0;c<o.length;c++)o[c]=null;Us._globalBatch=a},e.prototype.buildDrawCalls=function(t,r,i){var n=this,o=n._bufferedElements,s=n._attributeBuffer,a=n._indexBuffer,h=n.vertexSize,u=e._drawCallPool,l=this._dcIndex,c=this._aIndex,d=this._iIndex,p=u[l];p.start=this._iIndex,p.texArray=t;for(var f=r;f<i;++f){var m=o[f],_=m._texture.baseTexture,g=_o[_.alphaMode?1:0][m.blendMode];o[f]=null,r<f&&p.blend!==g&&(p.size=d-p.start,r=f,(p=u[++l]).texArray=t,p.start=d),this.packInterleavedGeometry(m,s,a,c,d),c+=m.vertexData.length/2*h,d+=m.indices.length,p.blend=g}r<i&&(p.size=d-p.start,++l),this._dcIndex=l,this._aIndex=c,this._iIndex=d},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this,e=t._packedGeometries,r=t._attributeBuffer,i=t._indexBuffer;Kt.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,o=e._drawCallPool,s=null,a=0;a<t;a++){var h=o[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;s!==u&&(s=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,n.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),Kt.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=So(Math.ceil(t/8)),r=Po(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new Hh(i*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=So(Math.ceil(t/12)),r=Po(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},e.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var o=e.uint32View,s=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?vo(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)s[i++]=l[f],s[i++]=l[f+1],s[i++]=h[f],s[i++]=h[f+1],o[i++]=p,s[i++]=c;for(f=0;f<u.length;f++)r[n++]=a+u[f]},e._drawCallPool=[],e._textureArrayPool=[],e}(ba),zh=
/** @class */function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=ma.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Qa(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new rs,default:this.defaultGroupCache[t]};return new th(this.programCache[t],n)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"},t}(),Wh=
/** @class */function(t){function e(e){void 0===e&&(e=!1);var r=t.call(this)||this;return r._buffer=new sa(null,e,!1),r._indexBuffer=new sa(null,e,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,et.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,et.FLOAT).addAttribute("aColor",r._buffer,4,!0,et.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,et.FLOAT).addIndex(r._indexBuffer),r}return Ds(e,t),e}(ca),qh="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Kh="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Zh=
/** @class */function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:qh,fragment:Kh,geometryClass:Wh,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,o=e.geometryClass;
/** @class */
return function(t){function e(e){var s=t.call(this,e)||this;return s.shaderGenerator=new zh(r,i),s.geometryClass=o,s.vertexSize=n,s}return Ds(e,t),e}(Yh)},Object.defineProperty(t,"defaultVertexSrc",{
/**
       * The default vertex shader source
       * @readonly
       */
get:function(){return qh},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{
/**
       * The default fragment shader source
       * @readonly
       */
get:function(){return Kh},enumerable:!1,configurable:!0}),t}(),$h=Zh.create();Object.assign($h,{extension:{name:"batch",type:vs.RendererPlugin}});var Jh={},Qh=function(t){Object.defineProperty(Jh,t,{get:function(){return Oo(0,"PIXI.systems."+t+" has moved to PIXI."+t),qs[t]}})};for(var tu in qs)Qh(tu);var eu={},ru=function(t){Object.defineProperty(eu,t,{get:function(){return Oo(0,"PIXI.resources."+t+" has moved to PIXI."+t),Oh[t]}})};for(var tu in Oh)ru(tu);var iu={
/**
   *  Flag for if the object is accessible. If true AccessibilityManager will overlay a
   *   shadow div with attributes set
   * @member {boolean}
   * @memberof PIXI.DisplayObject#
   */
accessible:!1,
/**
   * Sets the title attribute of the shadow div
   * If accessibleTitle AND accessibleHint has not been this will default to 'displayObject [tabIndex]'
   * @member {?string}
   * @memberof PIXI.DisplayObject#
   */
accessibleTitle:null,
/**
   * Sets the aria-label attribute of the shadow div
   * @member {string}
   * @memberof PIXI.DisplayObject#
   */
accessibleHint:null,
/**
   * @member {number}
   * @memberof PIXI.DisplayObject#
   * @private
   * @todo Needs docs.
   */
tabIndex:0,
/**
   * @member {boolean}
   * @memberof PIXI.DisplayObject#
   * @todo Needs docs.
   */
_accessibleActive:!1,
/**
   * @member {boolean}
   * @memberof PIXI.DisplayObject#
   * @todo Needs docs.
   */
_accessibleDiv:null,
/**
   * Specify the type of div the accessible layer is. Screen readers treat the element differently
   * depending on this type. Defaults to button.
   * @member {string}
   * @memberof PIXI.DisplayObject#
   * @default 'button'
   */
accessibleType:"button",
/**
   * Specify the pointer-events the accessible div will use
   * Defaults to auto.
   * @member {string}
   * @memberof PIXI.DisplayObject#
   * @default 'auto'
   */
accessiblePointerEvents:"auto",
/**
   * Setting to false will prevent any children inside this container to
   * be accessible. Defaults to true.
   * @member {boolean}
   * @memberof PIXI.DisplayObject#
   * @default true
   */
accessibleChildren:!0,renderId:-1};
/*!
 * @pixi/accessibility - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/accessibility is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ms.mixin(iu);var nu=100,ou=
/** @class */function(){function t(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(qt.tablet||qt.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width=nu+"px",e.style.height=nu+"px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(t.prototype,"isActive",{
/**
       * Value of `true` if accessibility is currently active and accessibility layers are showing.
       * @member {boolean}
       * @readonly
       */
get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMobileAccessibility",{
/**
       * Value of `true` if accessibility is enabled for touch devices.
       * @member {boolean}
       * @readonly
       */
get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",(function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},t.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},t.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(t=this.renderer.view.parentNode)||void 0===t||t.appendChild(this.div))},t.prototype.deactivate=function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(t=this.div.parentNode)||void 0===t||t.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var e=t.children;if(e)for(var r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}},t.prototype.update=function(){var t=performance.now();if(!(qt.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),r=e.left,i=e.top,n=e.width,o=e.height,s=this.renderer,a=s.width,h=s.height,u=s.resolution,l=n/a*u,c=o/h*u,d=this.div;d.style.left=r+"px",d.style.top=i+"px",d.style.width=a+"px",d.style.height=h+"px";for(var p=0;p<this.children.length;p++){var f=this.children[p];if(f.renderId!==this.renderId)f._accessibleActive=!1,Ao(this.children,p,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,p--;else{d=f._accessibleDiv;var m=f.hitArea,_=f.worldTransform;f.hitArea?(d.style.left=(_.tx+m.x*_.a)*l+"px",d.style.top=(_.ty+m.y*_.d)*c+"px",d.style.width=m.width*_.a*l+"px",d.style.height=m.height*_.d*c+"px"):(m=f.getBounds(),this.capHitArea(m),d.style.left=m.x*l+"px",d.style.top=m.y*c+"px",d.style.width=m.width*l+"px",d.style.height=m.height*c+"px",d.title!==f.accessibleTitle&&null!==f.accessibleTitle&&(d.title=f.accessibleTitle),d.getAttribute("aria-label")!==f.accessibleHint&&null!==f.accessibleHint&&d.setAttribute("aria-label",f.accessibleHint)),f.accessibleTitle===d.title&&f.tabIndex===d.tabIndex||(d.title=f.accessibleTitle,d.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}},t.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,r=e.width,i=e.height;t.x+t.width>r&&(t.width=r-t.x),t.y+t.height>i&&(t.height=i-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width=nu+"px",e.style.height=nu+"px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,r=t.target.displayObject,i=e.eventData;e.dispatchEvent(r,"click",i),e.dispatchEvent(r,"pointertap",i),e.dispatchEvent(r,"tap",i)},t.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,r=t.target.displayObject,i=e.eventData;e.dispatchEvent(r,"mouseover",i)},t.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,r=t.target.displayObject,i=e.eventData;e.dispatchEvent(r,"mouseout",i)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},t.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t.extension={name:"accessibility",type:[vs.RendererPlugin,vs.CanvasRendererPlugin]},t}(),su=
/** @class */function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new qo,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{
/**
       * The unique identifier of the pointer. It will be the same as `identifier`.
       * @readonly
       * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerId
       */
get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,r){return t.worldTransform.applyInverse(r||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),au=function(t,e){return au=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},au(t,e)};var hu=
/** @class */function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),uu=
/** @class */function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{
/**
       * Unique pointer id of the event
       * @readonly
       * @private
       * @member {number}
       */
get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{
/**
       * State of the tracking data, expressed as bit flags
       * @private
       * @member {number}
       */
get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{
/**
       * Is the tracked event inactive (not over or down)?
       * @private
       * @member {number}
       */
get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{
/**
       * Is the tracked event over the DisplayObject?
       * @private
       * @member {boolean}
       */
get:function(){return!!(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{
/**
       * Did the right mouse button come down in the DisplayObject?
       * @private
       * @member {boolean}
       */
get:function(){return!!(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{
/**
       * Did the left mouse button come down in the DisplayObject?
       * @private
       * @member {boolean}
       */
get:function(){return!!(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),lu=
/** @class */function(){function t(){this._tempPoint=new qo}return t.prototype.recursiveFindHit=function(t,e,r,i,n){var o;if(!e||!e.visible)return!1;var s=t.data.global,a=!1,h=n=e.interactive||n,u=!0;if(e.hitArea)i&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?a=!0:(i=!1,u=!1)),h=!1;else if(e._mask&&i){var l=e._mask.isMaskData?e._mask.maskObject:e._mask;l&&!(null===(o=l.containsPoint)||void 0===o?void 0:o.call(l,s))&&(i=!1)}if(u&&e.interactiveChildren&&e.children)for(var c=e.children,d=c.length-1;d>=0;d--){var p=c[d],f=this.recursiveFindHit(t,p,r,i,h);if(f){if(!p.parent)continue;h=!1,f&&(t.target&&(i=!1),a=!0)}}return n&&(i&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(a=!0),e.interactive&&(a&&!t.target&&(t.target=e),r&&r(t,e,!!a))),a},t.prototype.findHit=function(t,e,r,i){this.recursiveFindHit(t,e,r,i,!1)},t}(),cu={interactive:!1,interactiveChildren:!0,hitArea:null,
/**
   * If enabled, the mouse cursor use the pointer behavior when hovered over the displayObject if it is interactive
   * Setting this changes the 'cursor' property to `'pointer'`.
   * @example
   * const sprite = new PIXI.Sprite(texture);
   * sprite.interactive = true;
   * sprite.buttonMode = true;
   * @member {boolean}
   * @memberof PIXI.DisplayObject#
   */
get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},
/**
   * This defines what cursor mode is used when the mouse cursor
   * is hovered over the displayObject.
   * @example
   * const sprite = new PIXI.Sprite(texture);
   * sprite.interactive = true;
   * sprite.cursor = 'wait';
   * @see https://developer.mozilla.org/en/docs/Web/CSS/cursor
   * @member {string}
   * @memberof PIXI.DisplayObject#
   */
cursor:null,
/**
   * Internal set of all active pointers, by identifier
   * @member {Map<number, InteractionTrackingData>}
   * @memberof PIXI.DisplayObject#
   * @private
   */
get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},
/**
   * Map of all tracked pointers, by identifier. Use trackedPointers to access.
   * @private
   * @type {Map<number, InteractionTrackingData>}
   */
_trackedPointers:void 0};ms.mixin(cu);var du={target:null,data:{global:null}},pu=
/** @class */function(t){function e(e,r){var i=t.call(this)||this;return r=r||{},i.renderer=e,i.autoPreventDefault=void 0===r.autoPreventDefault||r.autoPreventDefault,i.interactionFrequency=r.interactionFrequency||10,i.mouse=new su,i.mouse.identifier=1,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[1]=i.mouse,i.interactionDataPool=[],i.eventData=new hu,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!("PointerEvent"in globalThis),i.supportsTouchEvents="ontouchstart"in globalThis,i.supportsPointerEvents=!!globalThis.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new lu,i._tempDisplayObject=new _s,i._eventListenerOptions={capture:!0,passive:!1},i._useSystemTicker=void 0===r.useSystemTicker||r.useSystemTicker,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return function(t,e){function r(){this.constructor=t}au(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),Object.defineProperty(e.prototype,"useSystemTicker",{
/**
       * Should the InteractionManager automatically add {@link tickerUpdate} to {@link PIXI.Ticker.system}.
       * @default true
       */
get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{
/**
       * Last rendered object or temp object.
       * @readonly
       * @protected
       */
get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,e){return du.target=null,du.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(du,e,null,!0),du.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(Rs.system.add(this.tickerUpdate,this,Ts.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(Rs.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var r=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){t=t||"default";var e=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(e=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var r=this.cursorStyles[t];if(r)switch(typeof r){case"string":e&&(this.interactionDOMElement.style.cursor=r);break;case"function":r(t);break;case"object":e&&Object.assign(this.interactionDOMElement.style,r)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,r){r.stopPropagationHint&&t!==r.stopsPropagatingAt||(r.currentTarget=t,r.type=e,t.emit(e,r),t[e]&&t[e](r))},e.prototype.delayDispatchEvent=function(t,e,r){this.delayedEvents.push({displayObject:t,eventString:e,eventData:r})},e.prototype.mapPositionToPoint=function(t,e,r){var i;i=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var n=1/this.resolution;t.x=(e-i.left)*(this.interactionDOMElement.width/i.width)*n,t.y=(r-i.top)*(this.interactionDOMElement.height/i.height)*n},e.prototype.processInteractive=function(t,e,r,i){var n=this.search.findHit(t,e,r,i),o=this.delayedEvents;if(!o.length)return n;t.stopPropagationHint=!1;var s=o.length;this.delayedEvents=[];for(var a=0;a<s;a++){var h=o[a],u=h.displayObject,l=h.eventString,c=h.eventData;c.stopsPropagatingAt===u&&(c.stopPropagationHint=!0),this.dispatchEvent(u,l,c)}return n},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var r=e.length,i=0;i<r;i++){var n=e[i],o=this.getInteractionDataForPointerId(n),s=this.configureInteractionEventForDOMEvent(this.eventData,n,o);if(s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===n.pointerType)this.emit("touchstart",s);else if("mouse"===n.pointerType||"pen"===n.pointerType){var a=2===n.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,r){var i=t.data,n=t.data.identifier;if(r)if(e.trackedPointers[n]||(e.trackedPointers[n]=new uu(n)),this.dispatchEvent(e,"pointerdown",t),"touch"===i.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===i.pointerType||"pen"===i.pointerType){var o=2===i.button;o?e.trackedPointers[n].rightDown=!0:e.trackedPointers[n].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,r){var i=this.normalizeToPointerData(t),n=i.length,o=t.target;t.composedPath&&t.composedPath().length>0&&(o=t.composedPath()[0]);for(var s=o!==this.interactionDOMElement?"outside":"",a=0;a<n;a++){var h=i[a],u=this.getInteractionDataForPointerId(h),l=this.configureInteractionEventForDOMEvent(this.eventData,h,u);if(l.data.originalEvent=t,this.processInteractive(l,this.lastObjectRendered,r,e||!s),this.emit(e?"pointercancel":"pointerup"+s,l),"mouse"===h.pointerType||"pen"===h.pointerType){var c=2===h.button;this.emit(c?"rightup"+s:"mouseup"+s,l)}else"touch"===h.pointerType&&(this.emit(e?"touchcancel":"touchend"+s,l),this.releaseInteractionDataForPointerId(h.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var r=t.data,i=t.data.identifier;void 0!==e.trackedPointers[i]&&(delete e.trackedPointers[i],this.dispatchEvent(e,"pointercancel",t),"touch"===r.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,r){var i=t.data,n=t.data.identifier,o=e.trackedPointers[n],s="touch"===i.pointerType,a="mouse"===i.pointerType||"pen"===i.pointerType,h=!1;if(a){var u=2===i.button,l=uu.FLAGS,c=u?l.RIGHT_DOWN:l.LEFT_DOWN,d=void 0!==o&&o.flags&c;r?(this.dispatchEvent(e,u?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,u?"rightclick":"click",t),h=!0)):d&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),o&&(u?o.rightDown=!1:o.leftDown=!1)}r?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),o&&(a&&!h||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[n]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var r=e.length,i=0;i<r;i++){var n=e[i],o=this.getInteractionDataForPointerId(n),s=this.configureInteractionEventForDOMEvent(this.eventData,n,o);s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",s),"touch"===n.pointerType&&this.emit("touchmove",s),"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,r){var i=t.data,n="touch"===i.pointerType,o="mouse"===i.pointerType||"pen"===i.pointerType;o&&this.processPointerOverOut(t,e,r),this.moveWhenInside&&!r||(this.dispatchEvent(e,"pointermove",t),n&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var r=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,r);i.data.originalEvent=e,this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(r.identifier)}},e.prototype.processPointerOverOut=function(t,e,r){var i=t.data,n=t.data.identifier,o="mouse"===i.pointerType||"pen"===i.pointerType,s=e.trackedPointers[n];r&&!s&&(s=e.trackedPointers[n]=new uu(n)),void 0!==s&&(r&&this.mouseOverRenderer?(s.over||(s.over=!0,this.delayDispatchEvent(e,"pointerover",t),o&&this.delayDispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[n]))},e.prototype.onPointerOver=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0],r=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,r);i.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",i)}},e.prototype.getInteractionDataForPointerId=function(t){var e,r=t.pointerId;return 1===r||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[r]?e=this.activeInteractionData[r]:((e=this.interactionDataPool.pop()||new su).identifier=r,this.activeInteractionData[r]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,r){return t.data=r,this.mapPositionToPoint(r.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=r.global.x,e.globalY=r.global.y),r.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var r=0,i=t.changedTouches.length;r<i;r++){var n=t.changedTouches[r];void 0===n.button&&(n.button=t.touches.length?1:0),void 0===n.buttons&&(n.buttons=t.touches.length?1:0),void 0===n.isPrimary&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,e.push(n)}else if(globalThis.MouseEvent&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof globalThis.PointerEvent))e.push(t);else{var o=t;void 0===o.isPrimary&&(o.isPrimary=!0),void 0===o.width&&(o.width=1),void 0===o.height&&(o.height=1),void 0===o.tiltX&&(o.tiltX=0),void 0===o.tiltY&&(o.tiltY=0),void 0===o.pointerType&&(o.pointerType="mouse"),void 0===o.pointerId&&(o.pointerId=1),void 0===o.pressure&&(o.pressure=.5),void 0===o.twist&&(o.twist=0),void 0===o.tangentialPressure&&(o.tangentialPressure=0),o.isNormalized=!0,e.push(o)}return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e.extension={name:"interaction",type:[vs.RendererPlugin,vs.CanvasRendererPlugin]},e}($t),fu=new Zo,mu=
/** @class */function(){function t(t){this.renderer=t}return t.prototype.image=function(t,e,r){var i=new Image;return i.src=this.base64(t,e,r),i},t.prototype.base64=function(t,e,r){return this.canvas(t).toDataURL(e,r)},t.prototype.canvas=function(e,r){var i=this._rawPixels(e,r),n=i.pixels,o=i.width,s=i.height,a=i.flipY,h=new Bo(o,s,1),u=h.context.getImageData(0,0,o,s);if(t.arrayPostDivide(n,u.data),h.context.putImageData(u,0,0),a){var l=new Bo(h.width,h.height,1);l.context.scale(1,-1),l.context.drawImage(h.canvas,0,-s),h.destroy(),h=l}return h.canvas},t.prototype.pixels=function(e,r){var i=this._rawPixels(e,r).pixels;return t.arrayPostDivide(i,i),i},t.prototype._rawPixels=function(t,e){var r,i,n=this.renderer,o=!1,s=!1;if(t)if(t instanceof ra)i=t;else{var a=n.context.webGLVersion>=2?n.multisample:Et.NONE;if(i=this.renderer.generateTexture(t,{multisample:a}),a!==Et.NONE){var h=ra.create({width:i.width,height:i.height});n.framebuffer.bind(i.framebuffer),n.framebuffer.blit(h.framebuffer),n.framebuffer.bind(null),i.destroy(!0),i=h}s=!0}i?(r=i.baseTexture.resolution,e=null!=e?e:i.frame,o=!1,n.renderTexture.bind(i)):(r=n.resolution,e||((e=fu).width=n.width,e.height=n.height),o=!0,n.renderTexture.bind(null));var u=Math.round(e.width*r),l=Math.round(e.height*r),c=new Uint8Array(4*u*l),d=n.gl;return d.readPixels(Math.round(e.x*r),Math.round(e.y*r),u,l,d.RGBA,d.UNSIGNED_BYTE,c),s&&i.destroy(!0),{pixels:c,width:u,height:l,flipY:o}},t.prototype.destroy=function(){this.renderer=null},t.arrayPostDivide=function(t,e){for(var r=0;r<t.length;r+=4){var i=e[r+3]=t[r+3];0!==i?(e[r]=Math.round(Math.min(255*t[r]/i,255)),e[r+1]=Math.round(Math.min(255*t[r+1]/i,255)),e[r+2]=Math.round(Math.min(255*t[r+2]/i,255))):(e[r]=t[r],e[r+1]=t[r+1],e[r+2]=t[r+2])}},t.extension={name:"extract",type:vs.RendererPlugin},t}(),_u=
/** @class */function(){function t(t,e,r){void 0===e&&(e=!1),this._fn=t,this._once=e,this._thisArg=r,this._next=this._prev=this._owner=null}return t.prototype.detach=function(){return null!==this._owner&&(this._owner.detach(this),!0)},t}();function gu(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var yu,vu=
/** @class */function(){function t(){this._head=this._tail=void 0}return t.prototype.handlers=function(t){void 0===t&&(t=!1);var e=this._head;if(t)return!!e;for(var r=[];e;)r.push(e),e=e._next;return r},t.prototype.has=function(t){if(!(t instanceof _u))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},t.prototype.dispatch=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];var i=this._head;if(!i)return!1;for(;i;)i._once&&this.detach(i),i._fn.apply(i._thisArg,e),i=i._next;return!0},t.prototype.add=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return gu(this,new _u(t,!1,e))},t.prototype.once=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return gu(this,new _u(t,!0,e))},t.prototype.detach=function(t){if(!(t instanceof _u))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this},t.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},t}();function bu(t,e){e=e||{};for(var r={
// eslint-disable-next-line max-len
key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{
// eslint-disable-next-line max-len
strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
// eslint-disable-next-line max-len
loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=r.parser[e.strictMode?"strict":"loose"].exec(t),n={},o=14;o--;)n[r.key[o]]=i[o]||"";return n[r.q.name]={},n[r.key[12]].replace(r.q.parser,(function(t,e,i){e&&(n[r.q.name][e]=i)})),n}var xu=null;function Tu(){}function Eu(t,e,r){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=r)}function Su(t){return t.toString().replace("object ","")}var Mu,Pu,Au,Ru,wu,Iu=
/** @class */function(){function t(e,r,i){if(this._dequeue=Tu,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,"string"!=typeof e||"string"!=typeof r)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===r.indexOf("data:")),this.name=e,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Tu,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new vu,this.onProgress=new vu,this.onComplete=new vu,this.onAfterMiddleware=new vu}return t.setExtensionLoadType=function(e,r){Eu(t._loadTypeMap,e,r)},t.setExtensionXhrType=function(e,r){Eu(t._xhrTypeMap,e,r)},Object.defineProperty(t.prototype,"isDataUrl",{
/**
       * When the resource starts to load.
       * @memberof PIXI.LoaderResource
       * @callback OnStartSignal
       * @param {PIXI.Resource} resource - The resource that the event happened on.
       */
/**
       * When the resource reports loading progress.
       * @memberof PIXI.LoaderResource
       * @callback OnProgressSignal
       * @param {PIXI.Resource} resource - The resource that the event happened on.
       * @param {number} percentage - The progress of the load in the range [0, 1].
       */
/**
       * When the resource finishes loading.
       * @memberof PIXI.LoaderResource
       * @callback OnCompleteSignal
       * @param {PIXI.Resource} resource - The resource that the event happened on.
       */
/**
       * @memberof PIXI.LoaderResource
       * @typedef {object} IMetadata
       * @property {HTMLImageElement|HTMLAudioElement|HTMLVideoElement} [loadElement=null] - The
       *      element to use for loading, instead of creating one.
       * @property {boolean} [skipSource=false] - Skips adding source(s) to the load element. This
       *      is useful if you want to pass in a `loadElement` that you already added load sources to.
       * @property {string|string[]} [mimeType] - The mime type to use for the source element
       *      of a video/audio elment. If the urls are an array, you can pass this as an array as well
       *      where each index is the mime type to use for the corresponding url index.
       */
/**
       * Stores whether or not this url is a data url.
       * @readonly
       * @member {boolean}
       */
get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isComplete",{
/**
       * Describes if this resource has finished loading. Is true when the resource has completely
       * loaded.
       * @readonly
       * @member {boolean}
       */
get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{
/**
       * Describes if this resource is currently loading. Is true when the resource starts loading,
       * and is false again when complete.
       * @readonly
       * @member {boolean}
       */
get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),t.prototype.complete=function(){this._clearEvents(),this._finish()},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.prototype.load=function(e){var r=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(r)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:void 0===yu&&(yu=!(!globalThis.XDomainRequest||"withCredentials"in new XMLHttpRequest)),yu&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return!!(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==globalThis.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==globalThis.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(t,this.url[r],Array.isArray(e)?e[r]:e));else{e=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;"use-credentials"===this.crossOrigin&&(e.withCredentials=!0),e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new globalThis.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},t.prototype._createSource=function(t,e,r){r||(r=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=r,i},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._onTimeout=function(){this.abort("Load timed out.")},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(Su(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(Su(t)+" Request timed out.")},t.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(Su(t)+" Request was aborted by the user.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,r="",i=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(r=e.responseText),0===i&&(r.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2===(i/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=t.TYPE.JSON}catch(pm){return void this.abort("Error trying to parse loaded json: "+pm)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var n=new DOMParser;this.data=n.parseFromString(r,"text/xml")}else{var o=document.createElement("div");o.innerHTML=r,this.data=o}this.type=t.TYPE.XML}catch(s){return void this.abort("Error trying to parse loaded xml: "+s)}else this.data=e.response||r;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";e=e||globalThis.location,xu||(xu=document.createElement("a")),xu.href=t;var r=bu(xu.href,{strictMode:!0}),i=!r.port&&""===e.port||r.port===e.port,n=r.protocol?r.protocol+":":"";return r.host===e.hostname&&i&&n===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(t){void 0===t&&(t=this.url);var e="";if(this.isDataUrl){var r=t.indexOf("/");e=t.substring(r+1,t.indexOf(";",r))}else{var i=t.indexOf("?"),n=t.indexOf("#"),o=Math.min(i>-1?i:t.length,n>-1?n:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},t}();function Cu(){}function Ou(t){return function(){for(var e=arguments,r=[],i=0;i<arguments.length;i++)r[i]=e[i];if(null===t)throw new Error("Callback was already called.");var n=t;t=null,n.apply(this,r)}}Mu=Iu||(Iu={}),(Pu=Mu.STATUS_FLAGS||(Mu.STATUS_FLAGS={}))[Pu.NONE=0]="NONE",Pu[Pu.DATA_URL=1]="DATA_URL",Pu[Pu.COMPLETE=2]="COMPLETE",Pu[Pu.LOADING=4]="LOADING",(Au=Mu.TYPE||(Mu.TYPE={}))[Au.UNKNOWN=0]="UNKNOWN",Au[Au.JSON=1]="JSON",Au[Au.XML=2]="XML",Au[Au.IMAGE=3]="IMAGE",Au[Au.AUDIO=4]="AUDIO",Au[Au.VIDEO=5]="VIDEO",Au[Au.TEXT=6]="TEXT",(Ru=Mu.LOAD_TYPE||(Mu.LOAD_TYPE={}))[Ru.XHR=1]="XHR",Ru[Ru.IMAGE=2]="IMAGE",Ru[Ru.AUDIO=3]="AUDIO",Ru[Ru.VIDEO=4]="VIDEO",(wu=Mu.XHR_RESPONSE_TYPE||(Mu.XHR_RESPONSE_TYPE={})).DEFAULT="text",wu.BUFFER="arraybuffer",wu.BLOB="blob",wu.DOCUMENT="document",wu.JSON="json",wu.TEXT="text",Mu._loadTypeMap={
// images
gif:Mu.LOAD_TYPE.IMAGE,png:Mu.LOAD_TYPE.IMAGE,bmp:Mu.LOAD_TYPE.IMAGE,jpg:Mu.LOAD_TYPE.IMAGE,jpeg:Mu.LOAD_TYPE.IMAGE,tif:Mu.LOAD_TYPE.IMAGE,tiff:Mu.LOAD_TYPE.IMAGE,webp:Mu.LOAD_TYPE.IMAGE,tga:Mu.LOAD_TYPE.IMAGE,avif:Mu.LOAD_TYPE.IMAGE,svg:Mu.LOAD_TYPE.IMAGE,"svg+xml":Mu.LOAD_TYPE.IMAGE,
// audio
mp3:Mu.LOAD_TYPE.AUDIO,ogg:Mu.LOAD_TYPE.AUDIO,wav:Mu.LOAD_TYPE.AUDIO,
// videos
mp4:Mu.LOAD_TYPE.VIDEO,webm:Mu.LOAD_TYPE.VIDEO},Mu._xhrTypeMap={
// xml
xhtml:Mu.XHR_RESPONSE_TYPE.DOCUMENT,html:Mu.XHR_RESPONSE_TYPE.DOCUMENT,htm:Mu.XHR_RESPONSE_TYPE.DOCUMENT,xml:Mu.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Mu.XHR_RESPONSE_TYPE.DOCUMENT,svg:Mu.XHR_RESPONSE_TYPE.DOCUMENT,
// This was added to handle Tiled Tileset XML, but .tsx is also a TypeScript React Component.
// Since it is way less likely for people to be loading TypeScript files instead of Tiled files,
// this should probably be fine.
tsx:Mu.XHR_RESPONSE_TYPE.DOCUMENT,
// images
gif:Mu.XHR_RESPONSE_TYPE.BLOB,png:Mu.XHR_RESPONSE_TYPE.BLOB,bmp:Mu.XHR_RESPONSE_TYPE.BLOB,jpg:Mu.XHR_RESPONSE_TYPE.BLOB,jpeg:Mu.XHR_RESPONSE_TYPE.BLOB,tif:Mu.XHR_RESPONSE_TYPE.BLOB,tiff:Mu.XHR_RESPONSE_TYPE.BLOB,webp:Mu.XHR_RESPONSE_TYPE.BLOB,tga:Mu.XHR_RESPONSE_TYPE.BLOB,avif:Mu.XHR_RESPONSE_TYPE.BLOB,
// json
json:Mu.XHR_RESPONSE_TYPE.JSON,
// text
text:Mu.XHR_RESPONSE_TYPE.TEXT,txt:Mu.XHR_RESPONSE_TYPE.TEXT,
// fonts
ttf:Mu.XHR_RESPONSE_TYPE.BUFFER,otf:Mu.XHR_RESPONSE_TYPE.BUFFER},Mu.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var Du=
/** @class */
function(){return function(t,e){this.data=t,this.callback=e}}(),Fu=
/** @class */function(){function t(t,e){var r=this;if(void 0===e&&(e=1),this.workers=0,this.saturated=Cu,this.unsaturated=Cu,this.empty=Cu,this.drain=Cu,this.error=Cu,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(t,e,i){if(i&&"function"!=typeof i)throw new Error("task callback must be a function");if(r.started=!0,null==t&&r.idle())setTimeout((function(){return r.drain()}),1);else{var n=new Du(t,"function"==typeof i?i:Cu);e?r._tasks.unshift(n):r._tasks.push(n),setTimeout(r.process,1)}},this.process=function(){for(;!r.paused&&r.workers<r.concurrency&&r._tasks.length;){var t=r._tasks.shift();0===r._tasks.length&&r.empty(),r.workers+=1,r.workers===r.concurrency&&r.saturated(),r._worker(t.data,Ou(r._next(t)))}},this._worker=t,0===e)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return t.prototype._next=function(t){var e=this;return function(){for(var r=arguments,i=[],n=0;n<arguments.length;n++)i[n]=r[n];e.workers-=1,t.callback.apply(t,i),null!=i[0]&&e.error(i[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},t.prototype.push=function(t,e){this._insert(t,!1,e)},t.prototype.kill=function(){this.workers=0,this.drain=Cu,this.started=!1,this._tasks=[]},t.prototype.unshift=function(t,e){this._insert(t,!0,e)},t.prototype.length=function(){return this._tasks.length},t.prototype.running=function(){return this.workers},t.prototype.idle=function(){return this._tasks.length+this.workers===0},t.prototype.pause=function(){!0!==this.paused&&(this.paused=!0)},t.prototype.resume=function(){if(!1!==this.paused){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},t.eachSeries=function(t,e,r,i){var n=0,o=t.length;!function s(a){a||n===o?r&&r(a):i?setTimeout((function(){e(t[n++],s)}),1):e(t[n++],s)}()},t.queue=function(e,r){return new t(e,r)},t}(),Lu=/(#[\w-]+)?$/,Bu=
/** @class */function(){function t(e,r){var i=this;void 0===e&&(e=""),void 0===r&&(r=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},this.resources={},this.baseUrl=e,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},this._queue=Fu.queue(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new vu,this.onError=new vu,this.onLoad=new vu,this.onStart=new vu,this.onComplete=new vu;for(var n=0;n<t._plugins.length;++n){var o=t._plugins[n],s=o.pre,a=o.use;s&&this.pre(s),a&&this.use(a)}this._protected=!1}return t.prototype._add=function(t,e,r,i){if(this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new Iu(t,e,r),"function"==typeof i&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var n=r.parentResource,o=[],s=0;s<n.children.length;++s)n.children[s].isComplete||o.push(n.children[s]);var a=n.progressChunk*(o.length+1)/(o.length+2);n.children.push(this.resources[t]),n.progressChunk=a;for(s=0;s<o.length;++s)o[s].progressChunk=a;this.resources[t].progressChunk=a}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},t.prototype.load=function(t){if(Oo(0,"@pixi/loaders is being replaced with @pixi/assets in the next major release."),"function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Object.defineProperty(t.prototype,"concurrency",{
/**
       * The number of resources to load concurrently.
       * @default 10
       */
get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),t.prototype._prepareUrl=function(t){var e,r=bu(t,{strictMode:!0});if(e=r.protocol||!r.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var i=Lu.exec(e)[0];-1!==(e=e.slice(0,e.length-i.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=i}return e},t.prototype._loadResource=function(t,e){var r=this;t._dequeue=e,Fu.eachSeries(this._beforeMiddleware,(function(e,i){e.call(r,t,(function(){i(t.isComplete?{}:null)}))}),(function(){t.isComplete?r._onLoad(t):(t._onLoadBinding=t.onComplete.once(r._onLoad,r),t.load())}),!0)},t.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),Fu.eachSeries(this._afterMiddleware,(function(r,i){r.call(e,t,i)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},t.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(t,"shared",{
/** A premade instance of the loader that can be used to load resources. */
get:function(){var e=t._shared;return e||((e=new t)._protected=!0,t._shared=e),e},enumerable:!1,configurable:!0}),t.registerPlugin=function(e){return Oo(0,"Loader.registerPlugin() is deprecated, use extensions.add() instead."),Ms.add({type:vs.Loader,ref:e}),t},t._plugins=[],t}();Ms.handleByList(vs.Loader,Bu._plugins),Bu.prototype.add=function(t,e,r,i){if(Array.isArray(t)){for(var n=0;n<t.length;++n)this.add(t[n]);return this}if("object"==typeof t&&(r=t,i=e||r.callback||r.onComplete,e=r.url,t=r.name||r.key||r.url),"string"!=typeof e&&(i=r,r=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");return"function"==typeof r&&(i=r,r=null),this._add(t,e,r,i)};var Nu=
/** @class */function(){function t(){}return t.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?Bu.shared:new Bu},t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.extension=vs.Application,t}(),Uu=
/** @class */function(){function t(){}return t.add=function(){Iu.setExtensionLoadType("svg",Iu.LOAD_TYPE.XHR),Iu.setExtensionXhrType("svg",Iu.XHR_RESPONSE_TYPE.TEXT)},t.use=function(t,e){if(!t.data||t.type!==Iu.TYPE.IMAGE&&"svg"!==t.extension)e();else{var r=t.data,i=t.url,n=t.name,o=t.metadata;ea.fromLoader(r,i,n,o).then((function(r){t.texture=r,e()})).catch(e)}},t.extension=vs.Loader,t}(),Gu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ku(t,e){if(t.data){if(t.xhr&&t.xhrType===Iu.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var r=globalThis.URL||globalThis.webkitURL,i=r.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=i,t.type=Iu.TYPE.IMAGE,void(t.data.onload=function(){r.revokeObjectURL(i),t.data.onload=null,e()})}}else{var n=t.xhr.getResponseHeader("content-type");if(n&&0===n.indexOf("image"))return t.data=new Image,t.data.src="data:"+n+";base64,"+function(t){for(var e="",r=0;r<t.length;){for(var i=[0,0,0],n=[0,0,0,0],o=0;o<i.length;++o)r<t.length?i[o]=255&t.charCodeAt(r++):i[o]=0;switch(n[0]=i[0]>>2,n[1]=(3&i[0])<<4|i[1]>>4,n[2]=(15&i[1])<<2|i[2]>>6,n[3]=63&i[2],r-(t.length-1)){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64}for(o=0;o<n.length;++o)e+=Gu.charAt(n[o])}return e}(t.xhr.responseText),t.type=Iu.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}var Xu,ju,Vu,Hu=
/** @class */function(){function t(){}return t.extension=vs.Loader,t.use=ku,t}();Ms.add(Uu,Hu),(Vu=ju||(ju={}))[Vu.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",Vu[Vu.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",Vu[Vu.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",Vu[Vu.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",Vu[Vu.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",Vu[Vu.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",Vu[Vu.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",Vu[Vu.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",Vu[Vu.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",Vu[Vu.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",Vu[Vu.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",Vu[Vu.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",Vu[Vu.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",Vu[Vu.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",Vu[Vu.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",Vu[Vu.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",Vu[Vu.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",Vu[Vu.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",Vu[Vu.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",Vu[Vu.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",Vu[Vu.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",Vu[Vu.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",Vu[Vu.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",Vu[Vu.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",Vu[Vu.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",Vu[Vu.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",Vu[Vu.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR";var Yu=(// WEBGL_compressed_texture_s3tc
(Xu={})[ju.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,Xu[ju.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,Xu[ju.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,Xu[ju.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,// WEBGL_compressed_texture_s3tc
Xu[ju.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,Xu[ju.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,Xu[ju.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,Xu[ju.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,// WEBGL_compressed_texture_etc
Xu[ju.COMPRESSED_R11_EAC]=.5,Xu[ju.COMPRESSED_SIGNED_R11_EAC]=.5,Xu[ju.COMPRESSED_RG11_EAC]=1,Xu[ju.COMPRESSED_SIGNED_RG11_EAC]=1,Xu[ju.COMPRESSED_RGB8_ETC2]=.5,Xu[ju.COMPRESSED_RGBA8_ETC2_EAC]=1,Xu[ju.COMPRESSED_SRGB8_ETC2]=.5,Xu[ju.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,Xu[ju.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Xu[ju.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,// WEBGL_compressed_texture_pvrtc
Xu[ju.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,Xu[ju.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,Xu[ju.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,Xu[ju.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,// WEBGL_compressed_texture_etc1
Xu[ju.COMPRESSED_RGB_ETC1_WEBGL]=.5,// @see https://www.khronos.org/registry/OpenGL/extensions/AMD/AMD_compressed_ATC_texture.txt
// WEBGL_compressed_texture_atc
Xu[ju.COMPRESSED_RGB_ATC_WEBGL]=.5,Xu[ju.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,Xu[ju.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,// @see https://registry.khronos.org/OpenGL/extensions/KHR/KHR_texture_compression_astc_hdr.txt
// WEBGL_compressed_texture_astc
/* eslint-disable-next-line camelcase */
Xu[ju.COMPRESSED_RGBA_ASTC_4x4_KHR]=1,Xu),zu=function(t,e){return zu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},zu(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Wu(t,e){function r(){this.constructor=t}zu(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function qu(t,e,r,i){return new(r||(r=Promise))((function(n,o){function s(t){try{h(i.next(t))}catch(pm){o(pm)}}function a(t){try{h(i.throw(t))}catch(pm){o(pm)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}h((i=i.apply(t,e||[])).next())}))}function Ku(t,e){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(pm){o=[6,pm],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var Zu,$u,Ju=
/** @class */function(t){function e(e,r){void 0===r&&(r={width:1,height:1,autoLoad:!0});var i,n,o=this;return"string"==typeof e?(i=e,n=new Uint8Array):(i=null,n=e),(o=t.call(this,n,r)||this).origin=i,o.buffer=n?new Hh(n):null,o.origin&&!1!==r.autoLoad&&o.load(),n&&n.length&&(o.loaded=!0,o.onBlobLoaded(o.buffer.rawBinaryData)),o}return Wu(e,t),e.prototype.onBlobLoaded=function(t){},e.prototype.load=function(){return qu(this,void 0,Promise,(function(){var t;return Ku(this,(function(e){switch(e.label){case 0:return[4,fetch(this.origin)];case 1:return[4,e.sent().blob()];case 2:return[4,e.sent().arrayBuffer()];case 3:return t=e.sent(),this.data=new Uint32Array(t),this.buffer=new Hh(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),[2,this]}}))}))},e}(Bs),Qu=
/** @class */function(t){function e(r,i){var n=t.call(this,r,i)||this;return n.format=i.format,n.levels=i.levels||1,n._width=i.width,n._height=i.height,n._extension=e._formatToExtension(n.format),(i.levelBuffers||n.buffer)&&(n._levelBuffers=i.levelBuffers||e._createLevelBuffers(r instanceof Uint8Array?r:n.buffer.uint8View,n.format,n.levels,4,4,
// PVRTC has 8x4 blocks in 2bpp mode
n.width,n.height)),n}return Wu(e,t),e.prototype.upload=function(t,e,r){var i=t.gl;if(!t.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var n=0,o=this.levels;n<o;n++){var s=this._levelBuffers[n],a=s.levelID,h=s.levelWidth,u=s.levelHeight,l=s.levelBuffer;i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,h,u,0,l)}return!0},e.prototype.onBlobLoaded=function(){this._levelBuffers=e._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,
// PVRTC has 8x4 blocks in 2bpp mode
this.width,this.height)},e._formatToExtension=function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},e._createLevelBuffers=function(t,e,r,i,n,o,s){for(var a=new Array(r),h=t.byteOffset,u=o,l=s,c=u+i-1&~(i-1),d=l+n-1&~(n-1),p=c*d*Yu[e],f=0;f<r;f++)a[f]={levelID:f,levelWidth:r>1?u:c,levelHeight:r>1?l:d,levelBuffer:new Uint8Array(t.buffer,h,p)},h+=p,p=(c=(u=u>>1||1)+i-1&~(i-1))*(d=(l=l>>1||1)+n-1&~(n-1))*Yu[e];return a},e}(Ju),tl=
/** @class */function(){function t(){}return t.use=function(e,r){var i=e.data;if(e.type===Iu.TYPE.JSON&&i&&i.cacheID&&i.textures){for(var n=i.textures,o=void 0,s=void 0,a=0,h=n.length;a<h;a++){var u=n[a],l=u.src,c=u.format;if(c||(s=l),t.textureFormats[c]){o=l;break}}if(!(o=o||s))return void r(new Error("Cannot load compressed-textures in "+e.url+", make sure you provide a fallback"));if(o===e.url)return void r(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var d={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},p=ro.resolve(e.url.replace(this.baseUrl,""),o),f=i.cacheID;this.add(f,p,d,(function(t){if(t.error)r(t.error);else{var i=t.texture,n=void 0===i?null:i,o=t.textures,s=void 0===o?{}:o;Object.assign(e,{texture:n,textures:s}),r()}}))}else r()},Object.defineProperty(t,"textureExtensions",{
/**  Map of available texture extensions. */
get:function(){if(!t._textureExtensions){var e=Kt.ADAPTER.createCanvas().getContext("webgl");if(!e)return{};var r={s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};t._textureExtensions=r}return t._textureExtensions},enumerable:!1,configurable:!0}),Object.defineProperty(t,"textureFormats",{
/** Map of available texture formats. */
get:function(){if(!t._textureFormats){var e=t.textureExtensions;for(var r in t._textureFormats={},e){var i=e[r];i&&Object.assign(t._textureFormats,Object.getPrototypeOf(i))}}return t._textureFormats},enumerable:!1,configurable:!0}),t.extension=vs.Loader,t}();function el(t,e,r){var i={textures:{},texture:null};return e?(e.map((function(t){return new ea(new Us(t,Object.assign({mipmap:ut.OFF,alphaMode:ct.NO_PREMULTIPLIED_ALPHA},r)))})).forEach((function(e,r){var n=e.baseTexture,o=t+"-"+(r+1);Us.addToCache(n,o),ea.addToCache(e,o),0===r&&(Us.addToCache(n,t),ea.addToCache(e,t),i.texture=e),i.textures[o]=e})),i):i}var rl,il,nl,ol,sl=124,al=3,hl=4,ul=7,ll=19,cl=2,dl=0,pl=1,fl=2,ml=3;(il=rl||(rl={}))[il.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",il[il.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",il[il.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",il[il.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",il[il.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",il[il.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",il[il.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",il[il.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",il[il.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",il[il.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",il[il.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",il[il.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",il[il.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",il[il.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",il[il.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",il[il.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",il[il.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",il[il.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",il[il.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",il[il.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",il[il.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",il[il.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",il[il.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",il[il.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",il[il.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",il[il.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",il[il.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",il[il.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",il[il.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",il[il.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",il[il.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",il[il.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",il[il.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",il[il.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",il[il.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",il[il.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",il[il.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",il[il.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",il[il.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",il[il.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",il[il.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",il[il.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",il[il.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",il[il.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",il[il.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",il[il.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",il[il.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",il[il.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",il[il.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",il[il.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",il[il.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",il[il.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",il[il.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",il[il.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",il[il.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",il[il.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",il[il.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",il[il.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",il[il.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",il[il.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",il[il.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",il[il.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",il[il.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",il[il.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",il[il.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",il[il.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",il[il.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",il[il.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",il[il.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",il[il.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",il[il.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",il[il.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",il[il.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",il[il.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",il[il.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",il[il.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",il[il.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",il[il.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",il[il.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",il[il.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",il[il.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",il[il.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",il[il.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",il[il.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",il[il.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",il[il.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",il[il.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",il[il.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",il[il.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",il[il.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",il[il.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",il[il.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",il[il.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",il[il.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",il[il.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",il[il.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",il[il.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",il[il.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",il[il.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",il[il.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",il[il.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",il[il.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",il[il.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",il[il.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",il[il.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",il[il.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",il[il.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",il[il.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",il[il.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",il[il.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",il[il.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",il[il.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",il[il.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",il[il.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",il[il.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",il[il.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",il[il.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",il[il.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",il[il.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",il[il.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",il[il.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",il[il.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT",(ol=nl||(nl={}))[ol.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",ol[ol.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",ol[ol.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D";var _l,gl,yl,vl=((Zu={})[827611204]=ju.COMPRESSED_RGBA_S3TC_DXT1_EXT,Zu[861165636]=ju.COMPRESSED_RGBA_S3TC_DXT3_EXT,Zu[894720068]=ju.COMPRESSED_RGBA_S3TC_DXT5_EXT,Zu),bl=(// WEBGL_compressed_texture_s3tc
($u={})[rl.DXGI_FORMAT_BC1_TYPELESS]=ju.COMPRESSED_RGBA_S3TC_DXT1_EXT,$u[rl.DXGI_FORMAT_BC1_UNORM]=ju.COMPRESSED_RGBA_S3TC_DXT1_EXT,$u[rl.DXGI_FORMAT_BC2_TYPELESS]=ju.COMPRESSED_RGBA_S3TC_DXT3_EXT,$u[rl.DXGI_FORMAT_BC2_UNORM]=ju.COMPRESSED_RGBA_S3TC_DXT3_EXT,$u[rl.DXGI_FORMAT_BC3_TYPELESS]=ju.COMPRESSED_RGBA_S3TC_DXT5_EXT,$u[rl.DXGI_FORMAT_BC3_UNORM]=ju.COMPRESSED_RGBA_S3TC_DXT5_EXT,// WEBGL_compressed_texture_s3tc_srgb
$u[rl.DXGI_FORMAT_BC1_UNORM_SRGB]=ju.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,$u[rl.DXGI_FORMAT_BC2_UNORM_SRGB]=ju.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,$u[rl.DXGI_FORMAT_BC3_UNORM_SRGB]=ju.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,$u);function xl(t){var e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");var r=new Uint32Array(t,0,sl/Uint32Array.BYTES_PER_ELEMENT),i=r[al],n=r[hl],o=r[ul],s=new Uint32Array(t,ll*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),a=s[1];if(4&a){var h=s[cl];if(808540228!==h){var u=vl[h],l=new Uint8Array(t,128);return[new Qu(l,{format:u,width:n,height:i,levels:o})]}var c=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),d=c[dl],p=c[pl],f=c[fl],m=c[ml],_=bl[d];if(void 0===_)throw new Error("DDSParser cannot parse texture data with DXGI format "+d);if(4===f)throw new Error("DDSParser does not support cubemap textures");if(p===nl.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSParser does not supported 3D texture data");var g=new Array;if(1===m)g.push(new Uint8Array(t,148));else{for(var y=Yu[_],v=0,b=n,x=i,T=0;T<o;T++){v+=Math.max(1,b+3&-4)*Math.max(1,x+3&-4)*y,b>>>=1,x>>>=1}var E=148;for(T=0;T<m;T++)g.push(new Uint8Array(t,E,v)),E+=v}return g.map((function(t){return new Qu(t,{format:_,width:n,height:i,levels:o})}))}if(64&a)throw new Error("DDSParser does not support uncompressed texture data.");if(512&a)throw new Error("DDSParser does not supported YUV uncompressed texture data.");if(131072&a)throw new Error("DDSParser does not support single-channel (lumninance) texture data!");if(2&a)throw new Error("DDSParser does not support single-channel (alpha) texture data!");throw new Error("DDSParser failed to load a texture file due to an unknown reason!")}var Tl=[171,75,84,88,32,49,49,187,13,10,26,10],El=12,Sl=16,Ml=24,Pl=28,Al=36,Rl=40,wl=44,Il=48,Cl=52,Ol=56,Dl=60,Fl=64,Ll=((_l={})[et.UNSIGNED_BYTE]=1,_l[et.UNSIGNED_SHORT]=2,_l[et.INT]=4,_l[et.UNSIGNED_INT]=4,_l[et.FLOAT]=4,_l[et.HALF_FLOAT]=8,_l),Bl=((gl={})[$.RGBA]=4,gl[$.RGB]=3,gl[$.RG]=2,gl[$.RED]=1,gl[$.LUMINANCE]=1,gl[$.LUMINANCE_ALPHA]=2,gl[$.ALPHA]=1,gl),Nl=((yl={})[et.UNSIGNED_SHORT_4_4_4_4]=2,yl[et.UNSIGNED_SHORT_5_5_5_1]=2,yl[et.UNSIGNED_SHORT_5_6_5]=2,yl);function Ul(t,e,r){void 0===r&&(r=!1);var i=new DataView(e);if(!function(t,e){for(var r=0;r<Tl.length;r++)if(e.getUint8(r)!==Tl[r])return!1;return!0}(0,i))return null;var n=67305985===i.getUint32(El,!0),o=i.getUint32(Sl,n),s=i.getUint32(Ml,n),a=i.getUint32(Pl,n),h=i.getUint32(Al,n),u=i.getUint32(Rl,n)||1,l=i.getUint32(wl,n)||1,c=i.getUint32(Il,n)||1,d=i.getUint32(Cl,n),p=i.getUint32(Ol,n),f=i.getUint32(Dl,n);if(0===u||1!==l)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==c)throw new Error("WebGL does not support array textures");var m,_=h+3&-4,g=u+3&-4,y=new Array(c),v=h*u;if(0===o&&(v=_*g),void 0===(m=0!==o?Ll[o]?Ll[o]*Bl[s]:Nl[o]:Yu[a]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var b=r?function(t,e,r){var i=new Map,n=0;for(;n<e;){var o=t.getUint32(Fl+n,r),s=Fl+n+4,a=3-(o+3)%4;if(0===o||o>e-n)break;for(var h=0;h<o&&0!==t.getUint8(s+h);h++);if(-1===h)break;var u=(new TextDecoder).decode(new Uint8Array(t.buffer,s,h)),l=new DataView(t.buffer,s+h+1,o-h-1);i.set(u,l),n+=4+o+a}return i}(i,f,n):null,x=v*m,T=h,E=u,S=_,M=g,P=Fl+f,A=0;A<p;A++){for(var R=i.getUint32(P,n),w=P+4,I=0;I<c;I++){var C=y[I];C||(C=y[I]=new Array(p)),C[A]={levelID:A,
// don't align mipWidth when texture not compressed! (glType not zero)
levelWidth:p>1||0!==o?T:S,levelHeight:p>1||0!==o?E:M,levelBuffer:new Uint8Array(e,w,x)},w+=x}P=(P+=R+4)%4!=0?P+4-P%4:P,x=(S=(T=T>>1||1)+4-1&-4)*(M=(E=E>>1||1)+4-1&-4)*m}return 0!==o?{uncompressed:y.map((function(t){var e=t[0].levelBuffer,r=!1;return o===et.FLOAT?e=new Float32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4):o===et.UNSIGNED_INT?(r=!0,e=new Uint32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)):o===et.INT&&(r=!0,e=new Int32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)),{resource:new Bs(e,{width:t[0].levelWidth,height:t[0].levelHeight}),type:o,format:r?Gl(s):s}})),kvData:b}:{compressed:y.map((function(t){return new Qu(null,{format:a,width:h,height:u,levels:p,levelBuffers:t})})),kvData:b}}function Gl(t){switch(t){case $.RGBA:return $.RGBA_INTEGER;case $.RGB:return $.RGB_INTEGER;case $.RG:return $.RG_INTEGER;case $.RED:return $.RED_INTEGER;default:return t}}Iu.setExtensionXhrType("dds",Iu.XHR_RESPONSE_TYPE.BUFFER);var kl=
/** @class */function(){function t(){}return t.use=function(t,e){if("dds"===t.extension&&t.data)try{Object.assign(t,el(t.name||t.url,xl(t.data),t.metadata))}catch(r){return void e(r)}e()},t.extension=vs.Loader,t}();Iu.setExtensionXhrType("ktx",Iu.XHR_RESPONSE_TYPE.BUFFER);var Xl=
/** @class */function(){function t(){}return t.use=function(t,e){if("ktx"===t.extension&&t.data)try{var r=t.name||t.url,i=Ul(0,t.data,this.loadKeyValueData),n=i.compressed,o=i.uncompressed,s=i.kvData;if(n){var a=el(r,n,t.metadata);if(s&&a.textures)for(var h in a.textures)a.textures[h].baseTexture.ktxKeyValueData=s;Object.assign(t,a)}else if(o){var u={};o.forEach((function(t,e){var i=new ea(new Us(t.resource,{mipmap:ut.OFF,alphaMode:ct.NO_PREMULTIPLIED_ALPHA,type:t.type,format:t.format})),n=r+"-"+(e+1);s&&(i.baseTexture.ktxKeyValueData=s),Us.addToCache(i.baseTexture,n),ea.addToCache(i,n),0===e&&(u[r]=i,Us.addToCache(i.baseTexture,r),ea.addToCache(i,r)),u[n]=i})),Object.assign(t,{textures:u})}}catch(l){return void e(l)}e()},t.extension=vs.Loader,t.loadKeyValueData=!1,t}(),jl=function(t,e){return jl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},jl(t,e)};
/*!
 * @pixi/particle-container - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/particle-container is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Vl(t,e){function r(){this.constructor=t}jl(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Hl,Yl,zl,Wl,ql=
/** @class */function(t){function e(e,r,i,n){void 0===e&&(e=1500),void 0===i&&(i=16384),void 0===n&&(n=!1);var o=t.call(this)||this;return i>16384&&(i=16384),o._properties=[!1,!0,!1,!1,!1],o._maxSize=e,o._batchSize=i,o._buffers=null,o._bufferUpdateIDs=[],o._updateID=0,o.interactiveChildren=!1,o.blendMode=W.NORMAL,o.autoResize=n,o.roundPixels=!0,o.baseTexture=null,o.setProperties(r),o._tint=0,o.tintRgb=new Float32Array(4),o.tint=16777215,o}return Vl(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(e.prototype,"tint",{
/**
       * The tint applied to the container. This is a hex value.
       * A value of 0xFFFFFF will remove any tint effect.
       * IMPORTANT: This is a WebGL only feature and will be ignored by the canvas renderer.
       * @default 0xFFFFFF
       */
get:function(){return this._tint},set:function(t){this._tint=t,po(t,this.tintRgb)},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},e}(ys),Kl=
/** @class */function(){function t(t,e,r){this.geometry=new ca,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;++i){var n=t[i];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||et.FLOAT,offset:n.offset},e[i]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new sa(xo(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r){(s=this.dynamicProperties[r]).offset=e,e+=s.size,this.dynamicStride+=s.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new sa(this.dynamicData,!1,!1);var n=0;this.staticStride=0;for(r=0;r<this.staticProperties.length;++r){(s=this.staticProperties[r]).offset=n,n+=s.size,this.staticStride+=s.size}var o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new sa(this.staticData,!0,!1);for(r=0;r<this.dynamicProperties.length;++r){var s=this.dynamicProperties[r];t.addAttribute(s.attributeName,this.dynamicBuffer,0,s.type===et.UNSIGNED_BYTE,s.type,4*this.dynamicStride,4*s.offset)}for(r=0;r<this.staticProperties.length;++r){s=this.staticProperties[r];t.addAttribute(s.attributeName,this.staticBuffer,0,s.type===et.UNSIGNED_BYTE,s.type,4*this.staticStride,4*s.offset)}},t.prototype.uploadDynamic=function(t,e,r){for(var i=0;i<this.dynamicProperties.length;i++){var n=this.dynamicProperties[i];n.uploadFunction(t,e,r,n.type===et.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++},t.prototype.uploadStatic=function(t,e,r){for(var i=0;i<this.staticProperties.length;i++){var n=this.staticProperties[i];n.uploadFunction(t,e,r,n.type===et.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++},t.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},t}(),Zl=
/** @class */function(t){function e(e){var r=t.call(this,e)||this;return r.shader=null,r.properties=null,r.tempMatrix=new rs,r.properties=[
// verticesData
{attributeName:"aVertexPosition",size:2,uploadFunction:r.uploadVertices,offset:0},
// positionData
{attributeName:"aPositionCoord",size:2,uploadFunction:r.uploadPosition,offset:0},
// rotationData
{attributeName:"aRotation",size:1,uploadFunction:r.uploadRotation,offset:0},
// uvsData
{attributeName:"aTextureCoord",size:2,uploadFunction:r.uploadUvs,offset:0},
// tintData
{attributeName:"aColor",size:1,type:et.UNSIGNED_BYTE,uploadFunction:r.uploadTint,offset:0}],r.shader=th.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),r.state=eh.for2d(),r}return Vl(e,t),e.prototype.render=function(t){var e=t.children,r=t._maxSize,i=t._batchSize,n=this.renderer,o=e.length;if(0!==o){o>r&&!t.autoResize&&(o=r);var s=t._buffers;s||(s=t._buffers=this.generateBuffers(t));var a=e[0]._texture.baseTexture,h=a.alphaMode>0;this.state.blendMode=go(t.blendMode,h),n.state.set(this.state);var u=n.gl,l=t.worldTransform.copyTo(this.tempMatrix);l.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=l.toArray(!0),this.shader.uniforms.uColor=yo(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,h),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);for(var c=!1,d=0,p=0;d<o;d+=i,p+=1){var f=o-d;f>i&&(f=i),p>=s.length&&s.push(this._generateOneMoreBuffer(t));var m=s[p];m.uploadDynamic(e,d,f);var _=t._bufferUpdateIDs[p]||0;(c=c||m._updateID<_)&&(m._updateID=t._updateID,m.uploadStatic(e,d,f)),n.geometry.bind(m.geometry),u.drawElements(u.TRIANGLES,6*f,u.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],r=t._maxSize,i=t._batchSize,n=t._properties,o=0;o<r;o+=i)e.push(new Kl(this.properties,n,i));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,r=t._properties;return new Kl(this.properties,r,e)},e.prototype.uploadVertices=function(t,e,r,i,n,o){for(var s=0,a=0,h=0,u=0,l=0;l<r;++l){var c=t[e+l],d=c._texture,p=c.scale.x,f=c.scale.y,m=d.trim,_=d.orig;m?(s=(a=m.x-c.anchor.x*_.width)+m.width,h=(u=m.y-c.anchor.y*_.height)+m.height):(s=_.width*(1-c.anchor.x),a=_.width*-c.anchor.x,h=_.height*(1-c.anchor.y),u=_.height*-c.anchor.y),i[o]=a*p,i[o+1]=u*f,i[o+n]=s*p,i[o+n+1]=u*f,i[o+2*n]=s*p,i[o+2*n+1]=h*f,i[o+3*n]=a*p,i[o+3*n+1]=h*f,o+=4*n}},e.prototype.uploadPosition=function(t,e,r,i,n,o){for(var s=0;s<r;s++){var a=t[e+s].position;i[o]=a.x,i[o+1]=a.y,i[o+n]=a.x,i[o+n+1]=a.y,i[o+2*n]=a.x,i[o+2*n+1]=a.y,i[o+3*n]=a.x,i[o+3*n+1]=a.y,o+=4*n}},e.prototype.uploadRotation=function(t,e,r,i,n,o){for(var s=0;s<r;s++){var a=t[e+s].rotation;i[o]=a,i[o+n]=a,i[o+2*n]=a,i[o+3*n]=a,o+=4*n}},e.prototype.uploadUvs=function(t,e,r,i,n,o){for(var s=0;s<r;++s){var a=t[e+s]._texture._uvs;a?(i[o]=a.x0,i[o+1]=a.y0,i[o+n]=a.x1,i[o+n+1]=a.y1,i[o+2*n]=a.x2,i[o+2*n+1]=a.y2,i[o+3*n]=a.x3,i[o+3*n+1]=a.y3,o+=4*n):(i[o]=0,i[o+1]=0,i[o+n]=0,i[o+n+1]=0,i[o+2*n]=0,i[o+2*n+1]=0,i[o+3*n]=0,i[o+3*n+1]=0,o+=4*n)}},e.prototype.uploadTint=function(t,e,r,i,n,o){for(var s=0;s<r;++s){var a=t[e+s],h=a._texture.baseTexture.alphaMode>0,u=a.alpha,l=u<1&&h?vo(a._tintRGB,u):a._tintRGB+(255*u<<24);i[o]=l,i[o+n]=l,i[o+2*n]=l,i[o+3*n]=l,o+=4*n}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e.extension={name:"particle",type:vs.RendererPlugin},e}(ba);(Yl=Hl||(Hl={})).MITER="miter",Yl.BEVEL="bevel",Yl.ROUND="round",(Wl=zl||(zl={})).BUTT="butt",Wl.ROUND="round",Wl.SQUARE="square";var $l={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},Jl=
/** @class */function(){function t(){this.color=16777215,this.alpha=1,this.texture=ea.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=ea.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),Ql=function(t,e){return Ql=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Ql(t,e)};function tc(t,e){function r(){this.constructor=t}Ql(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function ec(t,e){var r,i;void 0===e&&(e=!1);var n=t.length;if(!(n<6)){for(var o=0,s=0,a=t[n-2],h=t[n-1];s<n;s+=2){var u=t[s],l=t[s+1];o+=(u-a)*(l+h),a=u,h=l}if(!e&&o>0||e&&o<=0){var c=n/2;for(s=c+c%2;s<n;s+=2){var d=n-s-2,p=n-s-1,f=s,m=s+1;r=[t[f],t[d]],t[d]=r[0],t[f]=r[1],i=[t[m],t[p]],t[p]=i[0],t[m]=i[1]}}}}var rc={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var r=t.points,i=t.holes,n=e.points,o=e.indices;if(r.length>=6){ec(r,!1);for(var s=[],a=0;a<i.length;a++){var h=i[a];ec(h.points,!0),s.push(r.length/2),r=r.concat(h.points)}var u=Me(r,s,2);if(!u)return;var l=n.length/2;for(a=0;a<u.length;a+=3)o.push(u[a]+l),o.push(u[a+1]+l),o.push(u[a+2]+l);for(a=0;a<r.length;a++)n.push(r[a])}}},ic={build:function(t){var e,r,i,n,o,s,a=t.points;if(t.type===Vo.CIRC){var h=t.shape;e=h.x,r=h.y,o=s=h.radius,i=n=0}else if(t.type===Vo.ELIP){var u=t.shape;e=u.x,r=u.y,o=u.width,s=u.height,i=n=0}else{var l=t.shape,c=l.width/2,d=l.height/2;e=l.x+c,r=l.y+d,i=c-(o=s=Math.max(0,Math.min(l.radius,Math.min(c,d)))),n=d-s}if(o>=0&&s>=0&&i>=0&&n>=0){var p=Math.ceil(2.3*Math.sqrt(o+s)),f=8*p+(i?4:0)+(n?4:0);if(a.length=f,0!==f){if(0===p)return a.length=8,a[0]=a[6]=e+i,a[1]=a[3]=r+n,a[2]=a[4]=e-i,void(a[5]=a[7]=r-n);var m=0,_=4*p+(i?2:0)+2,g=_,y=f,v=e+(M=i+o),b=e-M,x=r+(P=n);if(a[m++]=v,a[m++]=x,a[--_]=x,a[--_]=b,n){var T=r-P;a[g++]=b,a[g++]=T,a[--y]=T,a[--y]=v}for(var E=1;E<p;E++){var S=Math.PI/2*(E/p);v=e+(M=i+Math.cos(S)*o),b=e-M,x=r+(P=n+Math.sin(S)*s),T=r-P;a[m++]=v,a[m++]=x,a[--_]=x,a[--_]=b,a[g++]=b,a[g++]=T,a[--y]=T,a[--y]=v}var M,P;v=e+(M=i),b=e-M,x=r+(P=n+s),T=r-P;a[m++]=v,a[m++]=x,a[--y]=T,a[--y]=v,i&&(a[m++]=b,a[m++]=x,a[--y]=T,a[--y]=b)}}else a.length=0},triangulate:function(t,e){var r=t.points,i=e.points,n=e.indices;if(0!==r.length){var o,s,a=i.length/2,h=a;if(t.type!==Vo.RREC){var u=t.shape;o=u.x,s=u.y}else{var l=t.shape;o=l.x+l.width/2,s=l.y+l.height/2}var c=t.matrix;i.push(t.matrix?c.a*o+c.c*s+c.tx:o,t.matrix?c.b*o+c.d*s+c.ty:s),a++,i.push(r[0],r[1]);for(var d=2;d<r.length;d+=2)i.push(r[d],r[d+1]),n.push(a++,h,a);n.push(h+1,h,a)}}},nc={build:function(t){var e=t.shape,r=e.x,i=e.y,n=e.width,o=e.height,s=t.points;s.length=0,s.push(r,i,r+n,i,r+n,i+o,r,i+o)},triangulate:function(t,e){var r=t.points,i=e.points,n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};function oc(t,e,r){return t+(e-t)*r}function sc(t,e,r,i,n,o,s){void 0===s&&(s=[]);for(var a=s,h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0;f<=20;++f)h=oc(t,r,m=f/20),u=oc(e,i,m),l=oc(r,n,m),c=oc(i,o,m),d=oc(h,l,m),p=oc(u,c,m),0===f&&a[a.length-2]===d&&a[a.length-1]===p||a.push(d,p);return a}var ac={build:function(t){if(Mc.nextRoundedRectBehavior)ic.build(t);else{var e=t.shape,r=t.points,i=e.x,n=e.y,o=e.width,s=e.height,a=Math.max(0,Math.min(e.radius,Math.min(o,s)/2));r.length=0,a?(sc(i,n+a,i,n,i+a,n,r),sc(i+o-a,n,i+o,n,i+o,n+a,r),sc(i+o,n+s-a,i+o,n+s,i+o-a,n+s,r),sc(i+a,n+s,i,n+s,i,n+s-a,r)):r.push(i,n,i+o,n,i+o,n+s,i,n+s)}},triangulate:function(t,e){if(Mc.nextRoundedRectBehavior)ic.triangulate(t,e);else{for(var r=t.points,i=e.points,n=e.indices,o=i.length/2,s=Me(r,null,2),a=0,h=s.length;a<h;a+=3)n.push(s[a]+o),n.push(s[a+1]+o),n.push(s[a+2]+o);for(a=0,h=r.length;a<h;a++)i.push(r[a],r[++a])}}};function hc(t,e,r,i,n,o,s,a){var h,u;s?(h=i,u=-r):(h=-i,u=r);var l=t-r*n+h,c=e-i*n+u,d=t+r*o+h,p=e+i*o+u;return a.push(l,c),a.push(d,p),2}function uc(t,e,r,i,n,o,s,a){var h=r-t,u=i-e,l=Math.atan2(h,u),c=Math.atan2(n-t,o-e);a&&l<c?l+=2*Math.PI:!a&&l>c&&(c+=2*Math.PI);var d=l,p=c-l,f=Math.abs(p),m=Math.sqrt(h*h+u*u),_=1+(15*f*Math.sqrt(m)/Math.PI|0),g=p/_;if(d+=g,a){s.push(t,e),s.push(r,i);for(var y=1,v=d;y<_;y++,v+=g)s.push(t,e),s.push(t+Math.sin(v)*m,e+Math.cos(v)*m);s.push(t,e),s.push(n,o)}else{s.push(r,i),s.push(t,e);for(y=1,v=d;y<_;y++,v+=g)s.push(t+Math.sin(v)*m,e+Math.cos(v)*m),s.push(t,e);s.push(n,o),s.push(t,e)}return 2*_}function lc(t,e){t.lineStyle.native?function(t,e){var r=0,i=t.shape,n=t.points||i.points,o=i.type!==Vo.POLY||i.closeStroke;if(0!==n.length){var s=e.points,a=e.indices,h=n.length/2,u=s.length/2,l=u;for(s.push(n[0],n[1]),r=1;r<h;r++)s.push(n[2*r],n[2*r+1]),a.push(l,l+1),l++;o&&a.push(l,u)}}(t,e):function(t,e){var r=t.shape,i=t.points||r.points.slice(),n=e.closePointEps;if(0!==i.length){var o=t.lineStyle,s=new qo(i[0],i[1]),a=new qo(i[i.length-2],i[i.length-1]),h=r.type!==Vo.POLY||r.closeStroke,u=Math.abs(s.x-a.x)<n&&Math.abs(s.y-a.y)<n;if(h){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var l=.5*(s.x+a.x),c=.5*(a.y+s.y);i.unshift(l,c),i.push(l,c)}var d=e.points,p=i.length/2,f=i.length,m=d.length/2,_=o.width/2,g=_*_,y=o.miterLimit*o.miterLimit,v=i[0],b=i[1],x=i[2],T=i[3],E=0,S=0,M=-(b-T),P=v-x,A=0,R=0,w=Math.sqrt(M*M+P*P);M/=w,P/=w,M*=_,P*=_;var I=o.alignment,C=2*(1-I),O=2*I;h||(o.cap===zl.ROUND?f+=uc(v-M*(C-O)*.5,b-P*(C-O)*.5,v-M*C,b-P*C,v+M*O,b+P*O,d,!0)+2:o.cap===zl.SQUARE&&(f+=hc(v,b,M,P,C,O,!0,d))),d.push(v-M*C,b-P*C),d.push(v+M*O,b+P*O);for(var D=1;D<p-1;++D){v=i[2*(D-1)],b=i[2*(D-1)+1],x=i[2*D],T=i[2*D+1],E=i[2*(D+1)],S=i[2*(D+1)+1],M=-(b-T),P=v-x,M/=w=Math.sqrt(M*M+P*P),P/=w,M*=_,P*=_,A=-(T-S),R=x-E,A/=w=Math.sqrt(A*A+R*R),R/=w,A*=_,R*=_;var F=x-v,L=b-T,B=x-E,N=S-T,U=F*B+L*N,G=L*B-N*F,k=G<0;if(Math.abs(G)<.001*Math.abs(U))d.push(x-M*C,T-P*C),d.push(x+M*O,T+P*O),U>=0&&(o.join===Hl.ROUND?f+=uc(x,T,x-M*C,T-P*C,x-A*C,T-R*C,d,!1)+4:f+=2,d.push(x-A*O,T-R*O),d.push(x+A*C,T+R*C));else{var X=(-M+v)*(-P+T)-(-M+x)*(-P+b),j=(-A+E)*(-R+T)-(-A+x)*(-R+S),V=(F*j-B*X)/G,H=(N*X-L*j)/G,Y=(V-x)*(V-x)+(H-T)*(H-T),z=x+(V-x)*C,W=T+(H-T)*C,q=x-(V-x)*O,K=T-(H-T)*O,Z=k?C:O;Y<=Math.min(F*F+L*L,B*B+N*N)+Z*Z*g?o.join===Hl.BEVEL||Y/g>y?(k?(d.push(z,W),d.push(x+M*O,T+P*O),d.push(z,W),d.push(x+A*O,T+R*O)):(d.push(x-M*C,T-P*C),d.push(q,K),d.push(x-A*C,T-R*C),d.push(q,K)),f+=2):o.join===Hl.ROUND?k?(d.push(z,W),d.push(x+M*O,T+P*O),f+=uc(x,T,x+M*O,T+P*O,x+A*O,T+R*O,d,!0)+4,d.push(z,W),d.push(x+A*O,T+R*O)):(d.push(x-M*C,T-P*C),d.push(q,K),f+=uc(x,T,x-M*C,T-P*C,x-A*C,T-R*C,d,!1)+4,d.push(x-A*C,T-R*C),d.push(q,K)):(d.push(z,W),d.push(q,K)):(d.push(x-M*C,T-P*C),d.push(x+M*O,T+P*O),o.join===Hl.ROUND?f+=k?uc(x,T,x+M*O,T+P*O,x+A*O,T+R*O,d,!0)+2:uc(x,T,x-M*C,T-P*C,x-A*C,T-R*C,d,!1)+2:o.join===Hl.MITER&&Y/g<=y&&(k?(d.push(q,K),d.push(q,K)):(d.push(z,W),d.push(z,W)),f+=2),d.push(x-A*C,T-R*C),d.push(x+A*O,T+R*O),f+=2)}}v=i[2*(p-2)],b=i[2*(p-2)+1],x=i[2*(p-1)],M=-(b-(T=i[2*(p-1)+1])),P=v-x,M/=w=Math.sqrt(M*M+P*P),P/=w,M*=_,P*=_,d.push(x-M*C,T-P*C),d.push(x+M*O,T+P*O),h||(o.cap===zl.ROUND?f+=uc(x-M*(C-O)*.5,T-P*(C-O)*.5,x-M*C,T-P*C,x+M*O,T+P*O,d,!1)+2:o.cap===zl.SQUARE&&(f+=hc(x,T,M,P,C,O,!1,d)));var $=e.indices,J=$l.epsilon*$l.epsilon;for(D=m;D<f+m-2;++D)v=d[2*D],b=d[2*D+1],x=d[2*(D+1)],T=d[2*(D+1)+1],E=d[2*(D+2)],S=d[2*(D+2)+1],Math.abs(v*(T-S)+x*(S-b)+E*(b-T))<J||$.push(D,D+1,D+2)}}(t,e)}var cc,dc=
/** @class */function(){function t(){}return t.curveTo=function(t,e,r,i,n,o){var s=o[o.length-2],a=o[o.length-1]-e,h=s-t,u=i-e,l=r-t,c=Math.abs(a*l-h*u);if(c<1e-8||0===n)return o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e),null;var d=a*a+h*h,p=u*u+l*l,f=a*u+h*l,m=n*Math.sqrt(d)/c,_=n*Math.sqrt(p)/c,g=m*f/d,y=_*f/p,v=m*l+_*h,b=m*u+_*a,x=h*(_+g),T=a*(_+g),E=l*(m+y),S=u*(m+y);return{cx:v+t,cy:b+e,radius:n,startAngle:Math.atan2(T-b,x-v),endAngle:Math.atan2(S-b,E-v),anticlockwise:h*u>l*a}},t.arc=function(t,e,r,i,n,o,s,a,h){for(var u=s-o,l=$l._segmentsCount(Math.abs(u)*n,40*Math.ceil(Math.abs(u)/Yo)),c=u/(2*l),d=2*c,p=Math.cos(c),f=Math.sin(c),m=l-1,_=m%1/m,g=0;g<=m;++g){var y=c+o+d*(g+_*g),v=Math.cos(y),b=-Math.sin(y);h.push((p*v+f*b)*n+r,(p*-b+f*v)*n+i)}},t}(),pc=
/** @class */function(){function t(){}return t.curveLength=function(t,e,r,i,n,o,s,a){for(var h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0,_=0,g=0,y=0,v=t,b=e,x=1;x<=10;++x)g=v-(m=(f=(p=(d=1-(u=x/10))*d)*d)*t+3*p*u*r+3*d*(l=u*u)*n+(c=l*u)*s),y=b-(_=f*e+3*p*u*i+3*d*l*o+c*a),v=m,b=_,h+=Math.sqrt(g*g+y*y);return h},t.curveTo=function(e,r,i,n,o,s,a){var h=a[a.length-2],u=a[a.length-1];a.length-=2;var l=$l._segmentsCount(t.curveLength(h,u,e,r,i,n,o,s)),c=0,d=0,p=0,f=0,m=0;a.push(h,u);for(var _=1,g=0;_<=l;++_)p=(d=(c=1-(g=_/l))*c)*c,m=(f=g*g)*g,a.push(p*h+3*d*g*e+3*c*f*i+m*o,p*u+3*d*g*r+3*c*f*n+m*s)},t}(),fc=
/** @class */function(){function t(){}return t.curveLength=function(t,e,r,i,n,o){var s=t-2*r+n,a=e-2*i+o,h=2*r-2*t,u=2*i-2*e,l=4*(s*s+a*a),c=4*(s*h+a*u),d=h*h+u*u,p=2*Math.sqrt(l+c+d),f=Math.sqrt(l),m=2*l*f,_=2*Math.sqrt(d),g=c/f;return(m*p+f*c*(p-_)+(4*d*l-c*c)*Math.log((2*f+g+p)/(g+_)))/(4*m)},t.curveTo=function(e,r,i,n,o){for(var s=o[o.length-2],a=o[o.length-1],h=$l._segmentsCount(t.curveLength(s,a,e,r,i,n)),u=0,l=0,c=1;c<=h;++c){var d=c/h;u=s+(e-s)*d,l=a+(r-a)*d,o.push(u+(e+(i-e)*d-u)*d,l+(r+(n-r)*d-l)*d)}},t}(),mc=
/** @class */function(){function t(){this.reset()}return t.prototype.begin=function(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),_c=((cc={})[Vo.POLY]=rc,cc[Vo.CIRC]=ic,cc[Vo.ELIP]=ic,cc[Vo.RECT]=nc,cc[Vo.RREC]=ac,cc),gc=[],yc=[],vc=
/** @class */function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=i,this.type=t.type}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),bc=new qo,xc=
/** @class */function(t){function e(){var e=t.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new ds,e.boundsDirty=-1,e}return tc(e,t),Object.defineProperty(e.prototype,"bounds",{
/**
       * Get the current bounds of the graphic geometry.
       * @readonly
       */
get:function(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),yc.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),gc.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null);var n=new vc(t,e,r,i);return this.graphicsData.push(n),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var r=new vc(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,r=0;r<e.length;++r){var i=e[r];if(i.fillStyle.visible&&(i.shape&&(i.matrix?i.matrix.applyInverse(t,bc):bc.copyFrom(t),i.shape.contains(bc.x,bc.y)))){var n=!1;if(i.holes)for(var o=0;o<i.holes.length;o++){if(i.holes[o].shape.contains(bc.x,bc.y)){n=!0;break}}if(!n)return!0}}return!1},e.prototype.updateBatches=function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,e=this.graphicsData,r=null,i=null;this.batches.length>0&&(i=(r=this.batches[this.batches.length-1]).style);for(var n=this.shapeIndex;n<e.length;n++){this.shapeIndex++;var o=e[n],s=o.fillStyle,a=o.lineStyle;_c[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(s.visible||a.visible)&&this.processHoles(o.holes);for(var h=0;h<2;h++){var u=0===h?s:a;if(u.visible){var l=u.texture.baseTexture,c=this.indices.length,d=this.points.length/2;l.wrapMode=at.REPEAT,0===h?this.processFill(o):this.processLine(o);var p=this.points.length/2-d;0!==p&&(r&&!this._compareStyles(i,u)&&(r.end(c,d),r=null),r||((r=gc.pop()||new mc).begin(u,c,d),this.batches.push(r),i=u),this.addUvs(this.points,t,u.texture,d,p,u.matrix))}}}var f=this.indices.length,m=this.points.length/2;if(r&&r.end(f,m),0!==this.batches.length){var _=m>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&_===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=_?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var r=this.graphicsData[t],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,r=t.length;e<r;e++)for(var i=t[e],n=0;n<i.size;n++){var o=i.start+n;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,r=0;r<t.length;r++)if(t[r].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++Us._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),yc.push(this.drawCalls[e]);this.drawCalls.length=0;var r=this.colors,i=this.textureIds,n=yc.pop();n||((n=new jh).texArray=new Vh),n.texArray.count=0,n.start=0,n.size=0,n.type=K.TRIANGLES;var o=0,s=null,a=0,h=!1,u=K.TRIANGLES,l=0;this.drawCalls.push(n);for(e=0;e<this.batches.length;e++){var c=this.batches[e],d=c.style,p=d.texture.baseTexture;h!==!!d.native&&(u=(h=!!d.native)?K.LINES:K.TRIANGLES,s=null,o=8,t++),s!==p&&(s=p,p._batchEnabled!==t&&(8===o&&(t++,o=0,n.size>0&&((n=yc.pop())||((n=new jh).texArray=new Vh),this.drawCalls.push(n)),n.start=l,n.size=0,n.texArray.count=0,n.type=u),p.touched=1,p._batchEnabled=t,p._batchLocation=o,p.wrapMode=at.REPEAT,n.texArray.elements[n.texArray.count++]=p,o++)),n.size+=c.size,l+=c.size,a=p._batchLocation,this.addColors(r,d.color,d.alpha,c.attribSize,c.attribStart),this.addTextureIds(i,a,c.attribSize,c.attribStart)}Us._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(3*t.length*4),o=new Float32Array(n),s=new Uint32Array(n),a=0,h=0;h<t.length/2;h++)o[a++]=t[2*h],o[a++]=t[2*h+1],o[a++]=e[2*h],o[a++]=e[2*h+1],s[a++]=r[h],o[a++]=i[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?rc.triangulate(t,this):_c[t.type].triangulate(t,this)},e.prototype.processLine=function(t){lc(t,this);for(var e=0;e<t.holes.length;e++)lc(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var r=t[e];_c[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var r=0;r<t.length/2;r++){var i=t[2*r],n=t[2*r+1];t[2*r]=e.a*i+e.c*n+e.tx,t[2*r+1]=e.b*i+e.d*n+e.ty}},e.prototype.addColors=function(t,e,r,i,n){void 0===n&&(n=0);var o=vo((e>>16)+(65280&e)+((255&e)<<16),r);t.length=Math.max(t.length,n+i);for(var s=0;s<i;s++)t[n+s]=o},e.prototype.addTextureIds=function(t,e,r,i){void 0===i&&(i=0),t.length=Math.max(t.length,i+r);for(var n=0;n<r;n++)t[i+n]=e},e.prototype.addUvs=function(t,e,r,i,n,o){void 0===o&&(o=null);for(var s=0,a=e.length,h=r.frame;s<n;){var u=t[2*(i+s)],l=t[2*(i+s)+1];if(o){var c=o.a*u+o.c*l+o.tx;l=o.b*u+o.d*l+o.ty,u=c}s++,e.push(u/h.width,l/h.height)}var d=r.baseTexture;(h.width<d.width||h.height<d.height)&&this.adjustUvs(e,r,a,n)},e.prototype.adjustUvs=function(t,e,r,i){for(var n=e.baseTexture,o=1e-6,s=r+2*i,a=e.frame,h=a.width/n.width,u=a.height/n.height,l=a.x/a.width,c=a.y/a.height,d=Math.floor(t[r]+o),p=Math.floor(t[r+1]+o),f=r+2;f<s;f+=2)d=Math.min(d,Math.floor(t[f]+o)),p=Math.min(p,Math.floor(t[f+1]+o));l-=d,c-=p;for(f=r;f<s;f+=2)t[f]=(t[f]+l)*h,t[f+1]=(t[f+1]+c)*u},e.BATCHABLE_SIZE=100,e}(Wh),Tc=
/** @class */function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=zl.BUTT,e.join=Hl.MITER,e.miterLimit=10,e}return tc(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(Jl),Ec=new Float32Array(3),Sc={},Mc=
/** @class */function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.shader=null,r.pluginName="batch",r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r._fillStyle=new Jl,r._lineStyle=new Tc,r._matrix=null,r._holeMode=!1,r.state=eh.for2d(),r._geometry=e||new xc,r._geometry.refCount++,r._transformID=-1,r.tint=16777215,r.blendMode=W.NORMAL,r}return tc(e,t),Object.defineProperty(e.prototype,"geometry",{
/**
       * Includes vertex positions, face indices, normals, colors, UVs, and
       * custom attributes within buffers, reducing the cost of passing all
       * this data to the GPU. Can be shared between multiple Mesh or Graphics objects.
       * @readonly
       */
get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},
/**
       * The blend mode to be applied to the graphic shape. Apply a value of
       * `PIXI.BLEND_MODES.NORMAL` to reset the blend mode.  Note that, since each
       * primitive in the GraphicsGeometry list is rendered sequentially, modes
       * such as `PIXI.BLEND_MODES.ADD` and `PIXI.BLEND_MODES.MULTIPLY` will
       * be applied per-primitive.
       * @default PIXI.BLEND_MODES.NORMAL
       */
set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{
/**
       * The tint applied to each graphic shape. This is a hex value. A value of
       * 0xFFFFFF will remove any tint effect.
       * @default 0xFFFFFF
       */
get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{
/**
       * The current fill style.
       * @readonly
       */
get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{
/**
       * The current line style.
       * @readonly
       */
get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,e,r,i,n){return void 0===t&&(t=null),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=.5),void 0===n&&(n=!1),"number"==typeof t&&(t={width:t,color:e,alpha:r,alignment:i,native:n}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:ea.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:zl.BUTT,join:Hl.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Qo,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Qo,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return i===t&&n===e||r.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,r,i){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),fc.curveTo(t,e,r,i,n),this},e.prototype.bezierCurveTo=function(t,e,r,i,n,o){return this._initCurve(),pc.curveTo(t,e,r,i,n,o,this.currentPath.points),this},e.prototype.arcTo=function(t,e,r,i,n){this._initCurve(t,e);var o=this.currentPath.points,s=dc.curveTo(t,e,r,i,n,o);if(s){var a=s.cx,h=s.cy,u=s.radius,l=s.startAngle,c=s.endAngle,d=s.anticlockwise;this.arc(a,h,u,l,c,d)}return this},e.prototype.arc=function(t,e,r,i,n,o){if(void 0===o&&(o=!1),i===n)return this;if(!o&&n<=i?n+=Yo:o&&i<=n&&(i+=Yo),0===n-i)return this;var s=t+Math.cos(i)*r,a=e+Math.sin(i)*r,h=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var l=Math.abs(u[u.length-2]-s),c=Math.abs(u[u.length-1]-a);l<h&&c<h||u.push(s,a)}else this.moveTo(s,a),u=this.currentPath.points;return dc.arc(s,a,t,e,r,i,n,o,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:ea.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:ea.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,r,i){return this.drawShape(new Zo(t,e,r,i))},e.prototype.drawRoundedRect=function(t,e,r,i,n){return this.drawShape(new ts(t,e,r,i,n))},e.prototype.drawCircle=function(t,e,r){return this.drawShape(new $o(t,e,r))},e.prototype.drawEllipse=function(t,e,r,i){return this.drawShape(new Jo(t,e,r,i))},e.prototype.drawPolygon=function(){for(var t,e=arguments,r=[],i=0;i<arguments.length;i++)r[i]=e[i];var n=!0,o=r[0];o.points?(n=o.closeStroke,t=o.points):t=Array.isArray(r[0])?r[0]:r;var s=new Qo(t);return s.closeStroke=n,this.drawShape(s),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==Vo.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(var i=0;i<r;i++){var n=t.batches[i],o=n.style.color,s=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),h={vertexData:s,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:a,_batchRGB:po(o),_tintRGB:o,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[i]=h}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,r=this.batches.length;e<r;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),r=this._geometry,i=this.tint,n=this.worldAlpha,o=e.uniforms,s=r.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(i>>16&255)/255*n,o.tint[1]=(i>>8&255)/255*n,o.tint[2]=(255&i)/255*n,o.tint[3]=n,t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(var a=0,h=s.length;a<h;a++)this._renderDrawCallDirect(t,r.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var r=e.texArray,i=e.type,n=e.size,o=e.start,s=r.count,a=0;a<s;a++)t.texture.bind(r.elements[a],a);t.geometry.draw(i,n,o)},e.prototype._resolveDirectShader=function(t){var e=this.shader,r=this.pluginName;if(!e){if(!Sc[r]){for(var i=t.plugins[r].MAX_TEXTURES,n=new Int32Array(i),o=0;o<i;o++)n[o]=o;var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new rs,default:ma.from({uSamplers:n},!0)},a=t.plugins[r]._shader.program;Sc[r]=new th(a,s)}e=Sc[r]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,r=e.minX,i=e.minY,n=e.maxX,o=e.maxY;this._bounds.addFrame(this.transform,r,i,n,o)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=po(this.tint,Ec),e=0;e<this.batches.length;e++){var r=this.batches[e],i=r._batchRGB,n=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);r._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,o=e.d,s=e.tx,a=e.ty,h=this._geometry.points,u=this.vertexData,l=0,c=0;c<h.length;c+=2){var d=h[c],p=h[c+1];u[l++]=r*d+n*p+s,u[l++]=o*p+i*d+a}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},e.nextRoundedRectBehavior=!1,e._TEMP_POINT=new qo,e}(ys),Pc={buildPoly:rc,buildCircle:ic,buildRectangle:nc,buildRoundedRectangle:ac,buildLine:lc,ArcUtils:dc,BezierUtils:pc,QuadraticUtils:fc,BatchPart:mc,FILL_COMMANDS:_c,BATCH_POOL:gc,DRAW_CALL_POOL:yc},Ac=function(t,e){return Ac=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Ac(t,e)};var Rc,wc,Ic=new qo,Cc=new Uint16Array([0,1,2,0,2,3]),Oc=
/** @class */function(t){function e(e){var r=t.call(this)||this;return r._anchor=new es(r._onAnchorUpdate,r,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=W.NORMAL,r._cachedTint=16777215,r.uvs=null,r.texture=e||ea.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.indices=Cc,r.pluginName="batch",r.isSprite=!0,r._roundPixels=Kt.ROUND_PIXELS,r}return function(t,e){function r(){this.constructor=t}Ac(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Ro(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Ro(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,o=e.d,s=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor,d=0,p=0,f=0,m=0;if(u?(d=(p=u.x-c._x*l.width)+u.width,f=(m=u.y-c._y*l.height)+u.height):(d=(p=-c._x*l.width)+l.width,f=(m=-c._y*l.height)+l.height),h[0]=r*p+n*m+s,h[1]=o*m+i*p+a,h[2]=r*d+n*m+s,h[3]=o*m+i*d+a,h[4]=r*d+n*f+s,h[5]=o*f+i*d+a,h[6]=r*p+n*f+s,h[7]=o*f+i*p+a,this._roundPixels)for(var _=Kt.RESOLUTION,g=0;g<h.length;++g)h[g]=Math.round((h[g]*_|0)/_)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,r=t.orig,i=this._anchor,n=this.transform.worldTransform,o=n.a,s=n.b,a=n.c,h=n.d,u=n.tx,l=n.ty,c=-i._x*r.width,d=c+r.width,p=-i._y*r.height,f=p+r.height;e[0]=o*c+a*p+u,e[1]=h*p+s*c+l,e[2]=o*d+a*p+u,e[3]=h*p+s*d+l,e[4]=o*d+a*f+u,e[5]=h*f+s*d+l,e[6]=o*c+a*f+u,e[7]=h*f+s*c+l},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new ds),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Zo),e=this._localBoundsRect),this._localBounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Ic);var e=this._texture.orig.width,r=this._texture.orig.height,i=-e*this.anchor.x,n=0;return Ic.x>=i&&Ic.x<i+e&&(n=-r*this.anchor.y,Ic.y>=n&&Ic.y<n+r)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var r="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null},e.from=function(t,r){return new e(t instanceof ea?t:ea.from(t,r))},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},
/**
       * If true PixiJS will Math.floor() x/y values when rendering, stopping pixel interpolation.
       *
       * Advantages can include sharper image quality (like text) and faster rendering on canvas.
       * The main disadvantage is movement of objects may appear less smooth.
       *
       * To set the global default, change {@link PIXI.settings.ROUND_PIXELS}.
       * @default false
       */
set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{
/** The width of the sprite, setting this will actually modify the scale to achieve the value set. */
get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=Ro(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{
/** The height of the sprite, setting this will actually modify the scale to achieve the value set. */
get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=Ro(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{
/**
       * The anchor sets the origin point of the sprite. The default value is taken from the {@link PIXI.Texture|Texture}
       * and passed to the constructor.
       *
       * The default is `(0,0)`, this means the sprite's origin is the top left.
       *
       * Setting the anchor to `(0.5,0.5)` means the sprite's origin is centered.
       *
       * Setting the anchor to `(1,1)` would mean the sprite's origin point will be the bottom right corner.
       *
       * If you pass only single parameter, it will set both x and y to the same value as shown in the example below.
       * @example
       * const sprite = new PIXI.Sprite(texture);
       * sprite.anchor.set(0.5); // This will set the origin to center. (0.5) is same as (0.5, 0.5).
       */
get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{
/**
       * The tint applied to the sprite. This is a hex value.
       *
       * A value of 0xFFFFFF will remove any tint effect.
       * @default 0xFFFFFF
       */
get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{
/** The texture that the sprite is using. */
get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||ea.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(ys),Dc=function(t,e){return Dc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Dc(t,e)};(wc=Rc||(Rc={}))[wc.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",wc[wc.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL";var Fc={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Rc.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Lc=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Bc=
/** @class */function(){function t(t){this.styleID=0,this.reset(),Gc(this,t,t)}return t.prototype.clone=function(){var e={};return Gc(e,this,Fc),new t(e)},t.prototype.reset=function(){Gc(this,Fc,Fc)},Object.defineProperty(t.prototype,"align",{
/**
       * Alignment for multiline text ('left', 'center' or 'right'), does not affect single line text
       *
       * @member {string}
       */
get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{
/** Indicates if lines can be wrapped within words, it needs wordWrap to be set to true. */
get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{
/** Set a drop shadow for the text. */
get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{
/** Set alpha for the drop shadow. */
get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{
/** Set a angle of the drop shadow. */
get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{
/** Set a shadow blur radius. */
get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{
/** A fill style to be used on the dropshadow e.g 'red', '#00FF00'. */
get:function(){return this._dropShadowColor},set:function(t){var e=Uc(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{
/** Set a distance of the drop shadow. */
get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{
/**
       * A canvas fillstyle that will be used on the text e.g 'red', '#00FF00'.
       *
       * Can be an array to create a gradient eg ['#000000','#FFFFFF']
       * {@link https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/fillStyle|MDN}
       *
       * @member {string|string[]|number|number[]|CanvasGradient|CanvasPattern}
       */
get:function(){return this._fill},set:function(t){var e=Uc(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{
/**
       * If fill is an array of colours to create a gradient, this can change the type/direction of the gradient.
       *
       * @see PIXI.TEXT_GRADIENT
       */
get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{
/**
       * If fill is an array of colours to create a gradient, this array can set the stop points
       * (numbers between 0 and 1) for the color, overriding the default behaviour of evenly spacing them.
       */
get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{
/** The font family. */
get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{
/**
       * The font size
       * (as a number it converts to px, but as a string, equivalents are '26px','20pt','160%' or '1.6em')
       */
get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{
/**
       * The font style
       * ('normal', 'italic' or 'oblique')
       *
       * @member {string}
       */
get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{
/**
       * The font variant
       * ('normal' or 'small-caps')
       *
       * @member {string}
       */
get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{
/**
       * The font weight
       * ('normal', 'bold', 'bolder', 'lighter' and '100', '200', '300', '400', '500', '600', '700', 800' or '900')
       *
       * @member {string}
       */
get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{
/** The amount of spacing between letters, default is 0. */
get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{
/** The line height, a number that represents the vertical space that a letter uses. */
get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{
/** The space between lines. */
get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{
/**
       * The lineJoin property sets the type of corner created, it can resolve spiked text issues.
       * Default is 'miter' (creates a sharp corner).
       *
       * @member {string}
       */
get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{
/**
       * The miter limit to use when using the 'miter' lineJoin mode.
       *
       * This can reduce or increase the spikiness of rendered text.
       */
get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{
/**
       * Occasionally some fonts are cropped. Adding some padding will prevent this from happening
       * by adding padding to all sides of the text.
       */
get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{
/**
       * A canvas fillstyle that will be used on the text stroke
       * e.g 'blue', '#FCFF00'
       */
get:function(){return this._stroke},set:function(t){var e=Uc(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{
/**
       * A number that represents the thickness of the stroke.
       *
       * @default 0
       */
get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{
/**
       * The baseline of the text that is rendered.
       *
       * @member {string}
       */
get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{
/** Trim transparent borders. */
get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{
/**
       * How newlines and spaces should be handled.
       * Default is 'pre' (preserve, preserve).
       *
       *  value       | New lines     |   Spaces
       *  ---         | ---           |   ---
       * 'normal'     | Collapse      |   Collapse
       * 'pre'        | Preserve      |   Preserve
       * 'pre-line'   | Preserve      |   Collapse
       *
       * @member {string}
       */
get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{
/** Indicates if word wrap should be used. */
get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{
/** The width at which text will wrap, it needs wordWrap to be set to true. */
get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;r>=0;r--){var i=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&Lc.indexOf(i)<0&&(i='"'+i+'"'),e[r]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function Nc(t){return"number"==typeof t?fo(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function Uc(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=Nc(t[e]);return t}return Nc(t)}function Gc(t,e,r){for(var i in r)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}var kc={
// TextMetrics requires getImageData readback for measuring fonts.
willReadFrequently:!0},Xc=
/** @class */function(){function t(t,e,r,i,n,o,s,a,h){this.text=t,this.style=e,this.width=r,this.height=i,this.lines=n,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=a,this.fontProperties=h}return t.measureText=function(e,r,i,n){void 0===n&&(n=t._canvas),i=null==i?r.wordWrap:i;var o=r.toFontString(),s=t.measureFont(o);0===s.fontSize&&(s.fontSize=r.fontSize,s.ascent=r.fontSize);var a=n.getContext("2d",kc);a.font=o;for(var h=(i?t.wordWrap(e,r,n):e).split(/(?:\r\n|\r|\n)/),u=new Array(h.length),l=0,c=0;c<h.length;c++){var d=a.measureText(h[c]).width+(h[c].length-1)*r.letterSpacing;u[c]=d,l=Math.max(l,d)}var p=l+r.strokeThickness;r.dropShadow&&(p+=r.dropShadowDistance);var f=r.lineHeight||s.fontSize+r.strokeThickness,m=Math.max(f,s.fontSize+r.strokeThickness)+(h.length-1)*(f+r.leading);return r.dropShadow&&(m+=r.dropShadowDistance),new t(e,r,p,m,h,u,f+r.leading,l,s)},t.wordWrap=function(e,r,i){void 0===i&&(i=t._canvas);for(var n=i.getContext("2d",kc),o=0,s="",a="",h=Object.create(null),u=r.letterSpacing,l=r.whiteSpace,c=t.collapseSpaces(l),d=t.collapseNewlines(l),p=!c,f=r.wordWrapWidth+u,m=t.tokenize(e),_=0;_<m.length;_++){var g=m[_];if(t.isNewline(g)){if(!d){a+=t.addLine(s),p=!c,s="",o=0;continue}g=" "}if(c){var y=t.isBreakingSpace(g),v=t.isBreakingSpace(s[s.length-1]);if(y&&v)continue}var b=t.getFromCache(g,u,h,n);if(b>f)if(""!==s&&(a+=t.addLine(s),s="",o=0),t.canBreakWords(g,r.breakWords))for(var x=t.wordWrapSplit(g),T=0;T<x.length;T++){for(var E=x[T],S=1;x[T+S];){var M=x[T+S],P=E[E.length-1];if(t.canBreakChars(P,M,g,T,r.breakWords))break;E+=M,S++}T+=E.length-1;var A=t.getFromCache(E,u,h,n);A+o>f&&(a+=t.addLine(s),p=!1,s="",o=0),s+=E,o+=A}else{s.length>0&&(a+=t.addLine(s),s="",o=0);var R=_===m.length-1;a+=t.addLine(g,!R),p=!1,s="",o=0}else b+o>f&&(p=!1,a+=t.addLine(s),s="",o=0),(s.length>0||!t.isBreakingSpace(g)||p)&&(s+=g,o+=b)}return a+=t.addLine(s,!1)},t.addLine=function(e,r){return void 0===r&&(r=!0),e=t.trimRight(e),e=r?e+"\n":e},t.getFromCache=function(t,e,r,i){var n=r[t];if("number"!=typeof n){var o=t.length*e;n=i.measureText(t).width+o,r[t]=n}return n},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var r=e.length-1;r>=0;r--){var i=e[r];if(!t.isBreakingSpace(i))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e,r){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var r=[],i="";if("string"!=typeof e)return r;for(var n=0;n<e.length;n++){var o=e[n],s=e[n+1];t.isBreakingSpace(o,s)||t.isNewline(o)?(""!==i&&(r.push(i),i=""),r.push(o)):i+=o}return""!==i&&r.push(i),r},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,r,i,n){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var r={ascent:0,descent:0,fontSize:0},i=t._canvas,n=t._context;n.font=e;var o=t.METRICS_STRING+t.BASELINE_SYMBOL,s=Math.ceil(n.measureText(o).width),a=Math.ceil(n.measureText(t.BASELINE_SYMBOL).width),h=Math.ceil(t.HEIGHT_MULTIPLIER*a);a=a*t.BASELINE_MULTIPLIER|0,i.width=s,i.height=h,n.fillStyle="#f00",n.fillRect(0,0,s,h),n.font=e,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(o,0,a);var u=n.getImageData(0,0,s,h).data,l=u.length,c=4*s,d=0,p=0,f=!1;for(d=0;d<a;++d){for(var m=0;m<c;m+=4)if(255!==u[p+m]){f=!0;break}if(f)break;p+=c}for(r.ascent=a-d,p=l-c,f=!1,d=h;d>a;--d){for(m=0;m<c;m+=4)if(255!==u[p+m]){f=!0;break}if(f)break;p-=c}return r.descent=d-a,r.fontSize=r.ascent+r.descent,t._fonts[e]=r,r},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},Object.defineProperty(t,"_canvas",{
/**
       * Cached canvas element for measuring text
       * TODO: this should be private, but isn't because of backward compat, will fix later.
       * @ignore
       */
get:function(){if(!t.__canvas){var e=void 0;try{var r=new OffscreenCanvas(0,0),i=r.getContext("2d",kc);if(i&&i.measureText)return t.__canvas=r,r;e=Kt.ADAPTER.createCanvas()}catch(n){e=Kt.ADAPTER.createCanvas()}e.width=e.height=10,t.__canvas=e}return t.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_context",{
/**
       * TODO: this should be private, but isn't because of backward compat, will fix later.
       * @ignore
       */
get:function(){return t.__context||(t.__context=t._canvas.getContext("2d",kc)),t.__context},enumerable:!1,configurable:!0}),t}();Xc._fonts={},Xc.METRICS_STRING="|ÉqÅ",Xc.BASELINE_SYMBOL="M",Xc.BASELINE_MULTIPLIER=1.4,Xc.HEIGHT_MULTIPLIER=2,Xc._newlines=[10,13],Xc._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var jc={texture:!0,children:!1,baseTexture:!0},Vc=
/** @class */function(t){function e(e,r,i){var n=this,o=!1;i||(i=Kt.ADAPTER.createCanvas(),o=!0),i.width=3,i.height=3;var s=ea.from(i);return s.orig=new Zo,s.trim=new Zo,(n=t.call(this,s)||this)._ownCanvas=o,n.canvas=i,n.context=i.getContext("2d",{
// required for trimming to work without warnings
willReadFrequently:!0}),n._resolution=Kt.RESOLUTION,n._autoResolution=!0,n._text=null,n._style=null,n._styleListener=null,n._font="",n.text=e,n.style=r,n.localStyleID=-1,n}return function(t,e){function r(){this.constructor=t}Dc(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.updateText=function(t){var r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),this.dirty||!t){this._font=this._style.toFontString();var i,n,o=this.context,s=Xc.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=s.width,h=s.height,u=s.lines,l=s.lineHeight,c=s.lineWidths,d=s.maxLineWidth,p=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,a)+2*r.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,h)+2*r.padding)*this._resolution),o.scale(this._resolution,this._resolution),o.clearRect(0,0,this.canvas.width,this.canvas.height),o.font=this._font,o.lineWidth=r.strokeThickness,o.textBaseline=r.textBaseline,o.lineJoin=r.lineJoin,o.miterLimit=r.miterLimit;for(var f=r.dropShadow?2:1,m=0;m<f;++m){var _=r.dropShadow&&0===m,g=_?Math.ceil(Math.max(1,h)+2*r.padding):0,y=g*this._resolution;if(_){o.fillStyle="black",o.strokeStyle="black";var v=r.dropShadowColor,b=po("number"==typeof v?v:mo(v)),x=r.dropShadowBlur*this._resolution,T=r.dropShadowDistance*this._resolution;o.shadowColor="rgba("+255*b[0]+","+255*b[1]+","+255*b[2]+","+r.dropShadowAlpha+")",o.shadowBlur=x,o.shadowOffsetX=Math.cos(r.dropShadowAngle)*T,o.shadowOffsetY=Math.sin(r.dropShadowAngle)*T+y}else o.fillStyle=this._generateFillStyle(r,u,s),o.strokeStyle=r.stroke,o.shadowColor="black",o.shadowBlur=0,o.shadowOffsetX=0,o.shadowOffsetY=0;var E=(l-p.fontSize)/2;(!e.nextLineHeightBehavior||l-p.fontSize<0)&&(E=0);for(var S=0;S<u.length;S++)i=r.strokeThickness/2,n=r.strokeThickness/2+S*l+p.ascent+E,"right"===r.align?i+=d-c[S]:"center"===r.align&&(i+=(d-c[S])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(u[S],i+r.padding,n+r.padding-g,!0),r.fill&&this.drawLetterSpacing(u[S],i+r.padding,n+r.padding-g)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,r,i,n){void 0===n&&(n=!1);var o=this._style.letterSpacing,s=e.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(0===o||s)return s&&(this.context.letterSpacing=o,this.context.textLetterSpacing=o),void(n?this.context.strokeText(t,r,i):this.context.fillText(t,r,i));for(var a=r,h=Array.from?Array.from(t):t.split(""),u=this.context.measureText(t).width,l=0,c=0;c<h.length;++c){var d=h[c];n?this.context.strokeText(d,a,i):this.context.fillText(d,a,i);for(var p="",f=c+1;f<h.length;++f)p+=h[f];a+=u-(l=this.context.measureText(p).width)+o,u=l}},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=No(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var r=this._texture,i=this._style,n=i.trim?0:i.padding,o=r.baseTexture;r.trim.width=r._frame.width=t.width/this._resolution,r.trim.height=r._frame.height=t.height/this._resolution,r.trim.x=-n,r.trim.y=-n,r.orig.width=r._frame.width-2*n,r.orig.height=r._frame.height-2*n,this._onTextureUpdate(),o.setRealSize(t.width,t.height,this._resolution),r.updateUvs(),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.updateTransform=function(){this.updateText(!0),t.prototype.updateTransform.call(this)},e.prototype.getBounds=function(e,r){return this.updateText(!0),-1===this._textureID&&(e=!1),t.prototype.getBounds.call(this,e,r)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,e,r){var i,n=t.fill;if(!Array.isArray(n))return n;if(1===n.length)return n[0];var o=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,a=this.canvas.width/this._resolution-o-2*s,h=this.canvas.height/this._resolution-o-2*s,u=n.slice(),l=t.fillGradientStops.slice();if(!l.length)for(var c=u.length+1,d=1;d<c;++d)l.push(d/c);if(u.unshift(n[0]),l.unshift(0),u.push(n[n.length-1]),l.push(1),t.fillGradientType===Rc.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,s,a/2,h+s);var p=r.fontProperties.fontSize+t.strokeThickness;for(d=0;d<e.length;d++){var f=r.lineHeight*(d-1)+p,m=r.lineHeight*d,_=m;d>0&&f>m&&(_=(m+f)/2);var g=m+p,y=r.lineHeight*(d+1),v=g;d+1<e.length&&y<g&&(v=(g+y)/2);for(var b=(v-_)/h,x=0;x<u.length;x++){var T=0;T="number"==typeof l[x]?l[x]:x/u.length;var E=Math.min(1,Math.max(0,_/h+T*b));E=Number(E.toFixed(5)),i.addColorStop(E,u[x])}}}else{i=this.context.createLinearGradient(s,h/2,a+s,h/2);var S=u.length+1,M=1;for(d=0;d<u.length;d++){var P=void 0;P="number"==typeof l[d]?l[d]:M/S,i.addColorStop(P,u[d]),M++}}return i},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},jc,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{
/** The width of the Text, setting this will actually modify the scale to achieve the value set. */
get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=Ro(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{
/** The height of the Text, setting this will actually modify the scale to achieve the value set. */
get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=Ro(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{
/**
       * Set the style of the text.
       *
       * Set up an event listener to listen for changes on the style object and mark the text as dirty.
       */
get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof Bc?t:new Bc(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{
/** Set the copy for the text object. To split a line you can use '\n'. */
get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{
/**
       * The resolution / device pixel ratio of the canvas.
       *
       * This is set to automatically match the renderer resolution by default, but can be overridden by setting manually.
       * @default 1
       */
get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e.experimentalLetterSpacing=!1,e}(Oc);
/*!
 * @pixi/prepare - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Kt.UPLOADS_PER_FRAME=4;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var Hc=function(t,e){return Hc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Hc(t,e)};var Yc=
/** @class */function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();function zc(t,e){var r=!1;if(t&&t._textures&&t._textures.length)for(var i=0;i<t._textures.length;i++)if(t._textures[i]instanceof ea){var n=t._textures[i].baseTexture;-1===e.indexOf(n)&&(e.push(n),r=!0)}return r}function Wc(t,e){if(t.baseTexture instanceof Us){var r=t.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function qc(t,e){if(t._texture&&t._texture instanceof ea){var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function Kc(t,e){return e instanceof Vc&&(e.updateText(!0),!0)}function Zc(t,e){if(e instanceof Bc){var r=e.toFontString();return Xc.measureFont(r),!0}return!1}function $c(t,e){if(t instanceof Vc){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function Jc(t,e){return t instanceof Bc&&(-1===e.indexOf(t)&&e.push(t),!0)}var Qc=
/** @class */function(){function t(t){var e=this;this.limiter=new Yc(Kt.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook($c),this.registerFindHook(Jc),this.registerFindHook(zc),this.registerFindHook(Wc),this.registerFindHook(qc),this.registerUploadHook(Kc),this.registerUploadHook(Zc)}return t.prototype.upload=function(t,e){var r=this;return"function"==typeof t&&(e=t,t=null),e&&Oo(0,"BasePrepare.upload callback is deprecated, use the return Promise instead."),new Promise((function(i){t&&r.add(t);var n=function(){null==e||e(),i()};r.queue.length?(r.completes.push(n),r.ticking||(r.ticking=!0,Rs.system.addOnce(r.tick,r,Ts.UTILITY))):n()}))},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)Rs.system.addOnce(this.tick,this,Ts.UTILITY);else{this.ticking=!1;var n=this.completes.slice(0);this.completes.length=0;for(r=0,i=n.length;r<i;r++)n[r]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof ys)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},t.prototype.destroy=function(){this.ticking&&Rs.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();function td(t,e){return e instanceof Us&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function ed(t,e){if(!(e instanceof Mc))return!1;var r=e.geometry;e.finishPoly(),r.updateBatches();for(var i=r.batches,n=0;n<i.length;n++){var o=i[n].style.texture;o&&td(t,o.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function rd(t,e){return t instanceof Mc&&(e.push(t),!0)}var id=
/** @class */function(t){function e(e){var r=t.call(this,e)||this;return r.uploadHookHelper=r.renderer,r.registerFindHook(rd),r.registerUploadHook(td),r.registerUploadHook(ed),r}return function(t,e){function r(){this.constructor=t}Hc(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.extension={name:"prepare",type:vs.RendererPlugin},e}(Qc),nd=
/** @class */function(){function t(t){this.maxMilliseconds=t,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}(),od=
/** @class */function(){function t(t,e,r){void 0===r&&(r=null),this.linkedSheets=[],this._texture=t instanceof ea?t:null,this.baseTexture=t instanceof Us?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,r=Xo(t,null);return null===r&&(r=void 0!==e?parseFloat(e):1),1!==r&&this.baseTexture.setResolution(r),r},t.prototype.parse=function(e){var r=this;return e&&Oo(0,"Spritesheet.parse callback is deprecated, use the return Promise instead."),new Promise((function(i){r._callback=function(t){null==e||e(t),i(t)},r._batchIndex=0,r._frameKeys.length<=t.BATCH_SIZE?(r._processFrames(0),r._processAnimations(),r._parseComplete()):r._nextBatch()}))},t.prototype._processFrames=function(e){for(var r=e,i=t.BATCH_SIZE;r-e<i&&r<this._frameKeys.length;){var n=this._frameKeys[r],o=this._frames[n],s=o.frame;if(s){var a=null,h=null,u=!1!==o.trimmed&&o.sourceSize?o.sourceSize:o.frame,l=new Zo(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);a=o.rotated?new Zo(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new Zo(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),!1!==o.trimmed&&o.spriteSourceSize&&(h=new Zo(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[n]=new ea(this.baseTexture,a,l,h,o.rotated?2:0,o.anchor),ea.addToCache(this.textures[n],n)}r++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var r=0;r<t[e].length;r++){var i=t[e][r];this.animations[e].push(this.textures[i])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())}),0)},t.prototype.destroy=function(t){var e;for(var r in void 0===t&&(t=!1),this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]},t.BATCH_SIZE=1e3,t}(),sd=
/** @class */function(){function t(){}return t.use=function(e,r){var i,n,o=this,s=e.name+"_image";if(e.data&&e.type===Iu.TYPE.JSON&&e.data.frames&&!o.resources[s]){var a=null===(n=null===(i=e.data)||void 0===i?void 0:i.meta)||void 0===n?void 0:n.related_multi_packs;if(Array.isArray(a))for(var h=function(t){if("string"!=typeof t)return"continue";var r=t.replace(".json",""),i=ro.resolve(e.url.replace(o.baseUrl,""),t);if(o.resources[r]||Object.values(o.resources).some((function(t){return ro.format(ro.parse(t.url))===i})))return"continue";var n={crossOrigin:e.crossOrigin,loadType:Iu.LOAD_TYPE.XHR,xhrType:Iu.XHR_RESPONSE_TYPE.JSON,parentResource:e,metadata:e.metadata};o.add(r,i,n)},u=0,l=a;u<l.length;u++){h(l[u])}var c={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},d=t.getResourcePath(e,o.baseUrl);o.add(s,d,c,(function(t){if(t.error)r(t.error);else{var i=new od(t.texture,e.data,e.url);i.parse().then((function(){e.spritesheet=i,e.textures=i.textures,r()}))}}))}else r()},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:ro.resolve(t.url.replace(e,""),t.data.meta.image)},t.extension=vs.Loader,t}(),ad=function(t,e){return ad=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},ad(t,e)};function hd(t,e){function r(){this.constructor=t}ad(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var ud=new qo,ld=
/** @class */function(t){function e(e,r,i){void 0===r&&(r=100),void 0===i&&(i=100);var n=t.call(this,e)||this;return n.tileTransform=new cs,n._width=r,n._height=i,n.uvMatrix=n.texture.uvMatrix||new nh(e),n.pluginName="tilingSprite",n.uvRespectAnchor=!1,n}return hd(e,t),Object.defineProperty(e.prototype,"clampMargin",{
/**
       * Changes frame clamping in corresponding textureTransform, shortcut
       * Change to -0.5 to add a pixel to the edge, recommended for transparent trimmed textures in atlas
       * @default 0.5
       * @member {number}
       */
get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{
/** The scaling of the image that is being tiled. */
get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{
/** The offset of the image that is being tiled. */
get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,r,i)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Zo),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,ud);var e=this._width,r=this._height,i=-e*this.anchor._x;if(ud.x>=i&&ud.x<i+e){var n=-r*this.anchor._y;if(ud.y>=n&&ud.y<n+r)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,r){return new e(t instanceof ea?t:ea.from(t,r),r.width,r.height)},Object.defineProperty(e.prototype,"width",{
/** The width of the sprite, setting this will actually modify the scale to achieve the value set. */
get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{
/** The height of the TilingSprite, setting this will actually modify the scale to achieve the value set. */
get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),e}(Oc),cd="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",dd=new rs,pd=
/** @class */function(t){function e(e){var r=t.call(this,e)||this;return e.runners.contextChange.add(r),r.quad=new pa,r.state=eh.for2d(),r}return hd(e,t),e.prototype.contextChange=function(){var t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=th.from(cd,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",e),this.shader=t.context.webGLVersion>1?th.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",e):th.from(cd,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",e)},e.prototype.render=function(t){var e=this.renderer,r=this.quad,i=r.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y);var n=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;(i=r.uvs)[0]=i[6]=-n,i[1]=i[3]=-o,i[2]=i[4]=1-n,i[5]=i[7]=1-o,r.invalidate();var s=t._texture,a=s.baseTexture,h=a.alphaMode>0,u=t.tileTransform.localTransform,l=t.uvMatrix,c=a.isPowerOfTwo&&s.frame.width===a.width&&s.frame.height===a.height;c&&(a._glTextures[e.CONTEXT_UID]?c=a.wrapMode!==at.CLAMP:a.wrapMode===at.CLAMP&&(a.wrapMode=at.REPEAT));var d=c?this.simpleShader:this.shader,p=s.width,f=s.height,m=t._width,_=t._height;dd.set(u.a*p/m,u.b*p/_,u.c*f/m,u.d*f/_,u.tx/m,u.ty/_),dd.invert(),c?dd.prepend(l.mapCoord):(d.uniforms.uMapCoord=l.mapCoord.toArray(!0),d.uniforms.uClampFrame=l.uClampFrame,d.uniforms.uClampOffset=l.uClampOffset),d.uniforms.uTransform=dd.toArray(!0),d.uniforms.uColor=bo(t.tint,t.worldAlpha,d.uniforms.uColor,h),d.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),d.uniforms.uSampler=s,e.shader.bind(d),e.geometry.bind(r),this.state.blendMode=go(t.blendMode,h),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e.extension={name:"tilingSprite",type:vs.RendererPlugin},e}(ba),fd=function(t,e){return fd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},fd(t,e)};function md(t,e){function r(){this.constructor=t}fd(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var _d=
/** @class */function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),gd=new qo,yd=new Qo,vd=
/** @class */function(t){function e(e,r,i,n){void 0===n&&(n=K.TRIANGLES);var o=t.call(this)||this;return o.geometry=e,o.shader=r,o.state=i||eh.for2d(),o.drawMode=n,o.start=0,o.size=0,o.uvs=null,o.indices=null,o.vertexData=new Float32Array(1),o.vertexDirty=-1,o._transformID=-1,o._roundPixels=Kt.ROUND_PIXELS,o.batchUvs=null,o}return md(e,t),Object.defineProperty(e.prototype,"geometry",{
/**
       * Includes vertex positions, face indices, normals, colors, UVs, and
       * custom attributes within buffers, reducing the cost of passing all
       * this data to the GPU. Can be shared between multiple Mesh objects.
       */
get:function(){return this._geometry},set:function(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uvBuffer",{
/**
       * To change mesh uv's, change its uvBuffer data and increment its _updateID.
       * @readonly
       */
get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{
/**
       * To change mesh vertices, change its uvBuffer data and increment its _updateID.
       * Incrementing _updateID is optional because most of Mesh objects do it anyway.
       * @readonly
       */
get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},
/** Alias for {@link PIXI.Mesh#shader}. */
set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},
/**
       * The blend mode to be applied to the Mesh. Apply a value of
       * `PIXI.BLEND_MODES.NORMAL` to reset the blend mode.
       * @default PIXI.BLEND_MODES.NORMAL;
       */
set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},
/**
       * If true PixiJS will Math.floor() x/y values when rendering, stopping pixel interpolation.
       * Advantages can include sharper image quality (like text) and faster rendering on canvas.
       * The main disadvantage is movement of objects may appear less smooth.
       * To set the global default, change {@link PIXI.settings.ROUND_PIXELS}
       * @default false
       */
set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{
/**
       * The multiply tint applied to the Mesh. This is a hex value. A value of
       * `0xFFFFFF` will remove any tint effect.
       *
       * Null for non-MeshMaterial shaders
       * @default 0xFFFFFF
       */
get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{
/** The texture that the Mesh uses. Null for non-MeshMaterial shaders */
get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===K.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;var i=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[i]),t.plugins[i].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry.buffers[0],e=t.data,r=t._updateID;if(r!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var i=this.transform.worldTransform,n=i.a,o=i.b,s=i.c,a=i.d,h=i.tx,u=i.ty,l=this.vertexData,c=0;c<l.length/2;c++){var d=e[2*c],p=e[2*c+1];l[2*c]=n*d+s*p+h,l[2*c+1]=o*d+a*p+u}if(this._roundPixels){var f=Kt.RESOLUTION;for(c=0;c<l.length;++c)l[c]=Math.round((l[c]*f|0)/f)}this.vertexDirty=r}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new _d(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,gd);for(var e=this.geometry.getBuffer("aVertexPosition").data,r=yd.points,i=this.geometry.getIndex().data,n=i.length,o=4===this.drawMode?3:1,s=0;s+2<n;s+=o){var a=2*i[s],h=2*i[s+1],u=2*i[s+2];if(r[0]=e[a],r[1]=e[a+1],r[2]=e[h],r[3]=e[h+1],r[4]=e[u],r[5]=e[u+1],yd.contains(gd.x,gd.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(ys),bd=
/** @class */function(t){function e(e,r){var i=this,n={uSampler:e,alpha:1,uTextureMatrix:rs.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(n,r.uniforms),(i=t.call(this,r.program||Qa.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),n)||this)._colorDirty=!1,i.uvMatrix=new nh(e),i.batchable=void 0===r.program,i.pluginName=r.pluginName,i.tint=r.tint,i.alpha=r.alpha,i}return md(e,t),Object.defineProperty(e.prototype,"texture",{
/** Reference to the texture being rendered. */
get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},
/**
       * This gets automatically set by the object using this.
       * @default 1
       */
set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},
/**
       * Multiply tint for the material.
       * @default 0xFFFFFF
       */
set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;bo(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(th),xd=
/** @class */function(t){function e(e,r,i){var n=t.call(this)||this,o=new sa(e),s=new sa(r,!0),a=new sa(i,!0,!0);return n.addAttribute("aVertexPosition",o,2,!1,et.FLOAT).addAttribute("aTextureCoord",s,2,!1,et.FLOAT).addIndex(a),n._updateId=-1,n}return md(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{
/**
       * If the vertex position is updated.
       * @readonly
       * @private
       */
get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(ca),Td=function(t,e){return Td=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Td(t,e)};var Ed=
/** @class */
function(){return function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}(),Sd=
/** @class */function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var i in e){var n=e[i].match(/^[a-z]+/gm)[0],o=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(var a in o){var h=o[a].split("="),u=h[0],l=h[1].replace(/"/gm,""),c=parseFloat(l),d=isNaN(c)?l:c;s[u]=d}r[n].push(s)}var p=new Ed;return r.info.forEach((function(t){return p.info.push({face:t.face,size:parseInt(t.size,10)})})),r.common.forEach((function(t){return p.common.push({lineHeight:parseInt(t.lineHeight,10)})})),r.page.forEach((function(t){return p.page.push({id:parseInt(t.id,10),file:t.file})})),r.char.forEach((function(t){return p.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})})),r.kerning.forEach((function(t){return p.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})})),r.distanceField.forEach((function(t){return p.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType})})),p},t}(),Md=
/** @class */function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new Ed,r=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),s=t.getElementsByTagName("kerning"),a=t.getElementsByTagName("distanceField"),h=0;h<r.length;h++)e.info.push({face:r[h].getAttribute("face"),size:parseInt(r[h].getAttribute("size"),10)});for(h=0;h<i.length;h++)e.common.push({lineHeight:parseInt(i[h].getAttribute("lineHeight"),10)});for(h=0;h<n.length;h++)e.page.push({id:parseInt(n[h].getAttribute("id"),10)||0,file:n[h].getAttribute("file")});for(h=0;h<o.length;h++){var u=o[h];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(h=0;h<s.length;h++)e.kerning.push({first:parseInt(s[h].getAttribute("first"),10),second:parseInt(s[h].getAttribute("second"),10),amount:parseInt(s[h].getAttribute("amount"),10)});for(h=0;h<a.length;h++)e.distanceField.push({fieldType:a[h].getAttribute("fieldType"),distanceRange:parseInt(a[h].getAttribute("distanceRange"),10)});return e},t}(),Pd=
/** @class */function(){function t(){}return t.test=function(t){if("string"==typeof t&&t.indexOf("<font>")>-1){var e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return Md.test(e)}return!1},t.parse=function(t){var e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return Md.parse(e)},t}(),Ad=[Sd,Md,Pd];function Rd(t){for(var e=0;e<Ad.length;e++)if(Ad[e].test(t))return Ad[e];return null}function wd(t,e,r,i,n,o,s){var a=r.text,h=r.fontProperties;e.translate(i,n),e.scale(o,o);var u=s.strokeThickness/2,l=-s.strokeThickness/2;if(e.font=s.toFontString(),e.lineWidth=s.strokeThickness,e.textBaseline=s.textBaseline,e.lineJoin=s.lineJoin,e.miterLimit=s.miterLimit,e.fillStyle=function(t,e,r,i,n,o){var s,a=r.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var h=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,l=t.width/i-h-2*u,c=t.height/i-h-2*u,d=a.slice(),p=r.fillGradientStops.slice();if(!p.length)for(var f=d.length+1,m=1;m<f;++m)p.push(m/f);if(d.unshift(a[0]),p.unshift(0),d.push(a[a.length-1]),p.push(1),r.fillGradientType===Rc.LINEAR_VERTICAL){s=e.createLinearGradient(l/2,u,l/2,c+u);var _=0,g=(o.fontProperties.fontSize+r.strokeThickness)/c;for(m=0;m<n.length;m++)for(var y=o.lineHeight*m,v=0;v<d.length;v++){var b=y/c+("number"==typeof p[v]?p[v]:v/d.length)*g,x=Math.max(_,b);x=Math.min(x,1),s.addColorStop(x,d[v]),_=x}}else{s=e.createLinearGradient(u,c/2,l+u,c/2);var T=d.length+1,E=1;for(m=0;m<d.length;m++){var S=void 0;S="number"==typeof p[m]?p[m]:E/T,s.addColorStop(S,d[m]),E++}}return s}(t,e,s,o,[a],r),e.strokeStyle=s.stroke,s.dropShadow){var c=s.dropShadowColor,d=po("number"==typeof c?c:mo(c)),p=s.dropShadowBlur*o,f=s.dropShadowDistance*o;e.shadowColor="rgba("+255*d[0]+","+255*d[1]+","+255*d[2]+","+s.dropShadowAlpha+")",e.shadowBlur=p,e.shadowOffsetX=Math.cos(s.dropShadowAngle)*f,e.shadowOffsetY=Math.sin(s.dropShadowAngle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;s.stroke&&s.strokeThickness&&e.strokeText(a,u,l+r.lineHeight-h.descent),s.fill&&e.fillText(a,u,l+r.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Id(t){return Array.from?Array.from(t):t.split("")}function Cd(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}var Od=
/** @class */function(){function t(t,e,r){var i,n,o=t.info[0],s=t.common[0],a=t.page[0],h=t.distanceField[0],u=Xo(a.file),l={};this._ownsTextures=r,this.font=o.face,this.size=o.size,this.lineHeight=s.lineHeight/u,this.chars={},this.pageTextures=l;for(var c=0;c<t.page.length;c++){var d=t.page[c],p=d.id,f=d.file;l[p]=e instanceof Array?e[c]:e[f],(null==h?void 0:h.fieldType)&&"none"!==h.fieldType&&(l[p].baseTexture.alphaMode=ct.NO_PREMULTIPLIED_ALPHA,l[p].baseTexture.mipmap=ut.OFF)}for(c=0;c<t.char.length;c++){var m=t.char[c],_=(p=m.id,m.page),g=t.char[c],y=g.x,v=g.y,b=g.width,x=g.height,T=g.xoffset,E=g.yoffset,S=g.xadvance;v/=u,b/=u,x/=u,T/=u,E/=u,S/=u;var M=new Zo((y/=u)+l[_].frame.x/u,v+l[_].frame.y/u,b,x);this.chars[p]={xOffset:T,yOffset:E,xAdvance:S,kerning:{},texture:new ea(l[_].baseTexture,M),page:_}}for(c=0;c<t.kerning.length;c++){var P=t.kerning[c],A=P.first,R=P.second,w=P.amount;A/=u,R/=u,w/=u,this.chars[R]&&(this.chars[R].kerning[A]=w)}this.distanceFieldRange=null==h?void 0:h.distanceRange,this.distanceFieldType=null!==(n=null===(i=null==h?void 0:h.fieldType)||void 0===i?void 0:i.toLowerCase())&&void 0!==n?n:"none"}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,r,i){var n;if(e instanceof Ed)n=e;else{var o=Rd(e);if(!o)throw new Error("Unrecognized data format for font.");n=o.parse(e)}r instanceof ea&&(r=[r]);var s=new t(n,r,i);return t.available[s.font]=s,s},t.uninstall=function(e){var r=t.available[e];if(!r)throw new Error("No font found named '"+e+"'");r.destroy(),delete t.available[e]},t.from=function(e,r,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var n=Object.assign({},t.defaultOptions,i),o=n.chars,s=n.padding,a=n.resolution,h=n.textureWidth,u=n.textureHeight,l=function(t){"string"==typeof t&&(t=[t]);for(var e=[],r=0,i=t.length;r<i;r++){var n=t[r];if(Array.isArray(n)){if(2!==n.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+n.length+".");var o=n[0].charCodeAt(0),s=n[1].charCodeAt(0);if(s<o)throw new Error("[BitmapFont]: Invalid character range.");for(var a=o,h=s;a<=h;a++)e.push(String.fromCharCode(a))}else e.push.apply(e,Id(n))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(o),c=r instanceof Bc?r:new Bc(r),d=h,p=new Ed;p.info[0]={face:c.fontFamily,size:c.fontSize},p.common[0]={lineHeight:c.fontSize};for(var f,m,_,g=0,y=0,v=0,b=[],x=0;x<l.length;x++){f||((f=Kt.ADAPTER.createCanvas()).width=h,f.height=u,m=f.getContext("2d"),_=new Us(f,{resolution:a}),b.push(new ea(_)),p.page.push({id:b.length-1,file:""}));var T=l[x],E=Xc.measureText(T,c,!1,f),S=E.width,M=Math.ceil(E.height),P=Math.ceil(("italic"===c.fontStyle?2:1)*S);if(y>=u-M*a){if(0===y)throw new Error("[BitmapFont] textureHeight "+u+"px is too small (fontFamily: '"+c.fontFamily+"', fontSize: "+c.fontSize+"px, char: '"+T+"')");--x,f=null,m=null,_=null,y=0,g=0,v=0}else if(v=Math.max(M+E.fontProperties.descent,v),P*a+g>=d){if(0===g)throw new Error("[BitmapFont] textureWidth "+h+"px is too small (fontFamily: '"+c.fontFamily+"', fontSize: "+c.fontSize+"px, char: '"+T+"')");--x,y+=v*a,y=Math.ceil(y),g=0,v=0}else{wd(f,m,E,g,y,a,c);var A=Cd(E.text);p.char.push({id:A,page:b.length-1,x:g/a,y:y/a,width:P,height:M,xoffset:0,yoffset:0,xadvance:Math.ceil(S-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),g+=(P+2*s)*a,g=Math.ceil(g)}}if(!(null==i?void 0:i.skipKerning)){x=0;for(var R=l.length;x<R;x++)for(var w=l[x],I=0;I<R;I++){var C=l[I],O=m.measureText(w).width,D=m.measureText(C).width,F=m.measureText(w+C).width-(O+D);F&&p.kerning.push({first:Cd(w),second:Cd(C),amount:F})}}var L=new t(p,b,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=L,L},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),Dd=[],Fd=[],Ld=[],Bd=
/** @class */function(t){function e(r,i){void 0===i&&(i={});var n=t.call(this)||this;n._tint=16777215;var o=Object.assign({},e.styleDefaults,i),s=o.align,a=o.tint,h=o.maxWidth,u=o.letterSpacing,l=o.fontName,c=o.fontSize;if(!Od.available[l])throw new Error('Missing BitmapFont "'+l+'"');return n._activePagesMeshData=[],n._textWidth=0,n._textHeight=0,n._align=s,n._tint=a,n._font=void 0,n._fontName=l,n._fontSize=c,n.text=r,n._maxWidth=h,n._maxLineHeight=0,n._letterSpacing=u,n._anchor=new es((function(){n.dirty=!0}),n,0,0),n._roundPixels=Kt.ROUND_PIXELS,n.dirty=!0,n._resolution=Kt.RESOLUTION,n._autoResolution=!0,n._textureCache={},n}return function(t,e){function r(){this.constructor=t}Td(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.updateText=function(){for(var t,e=Od.available[this._fontName],r=this.fontSize,i=r/e.size,n=new qo,o=[],s=[],a=[],h=Id(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),u=this._maxWidth*e.size/r,l="none"===e.distanceFieldType?Dd:Fd,c=null,d=0,p=0,f=0,m=-1,_=0,g=0,y=0,v=0,b=0;b<h.length;b++){var x=Cd(X=h[b]);if(/(?:\s)/.test(X)&&(m=b,_=d,v++),"\r"!==X&&"\n"!==X){var T=e.chars[x];if(T){c&&T.kerning[c]&&(n.x+=T.kerning[c]);var E=Ld.pop()||{texture:ea.EMPTY,line:0,charCode:0,prevSpaces:0,position:new qo};E.texture=T.texture,E.line=f,E.charCode=x,E.position.x=n.x+T.xOffset+this._letterSpacing/2,E.position.y=n.y+T.yOffset,E.prevSpaces=v,o.push(E),d=E.position.x+Math.max(T.xAdvance-T.xOffset,T.texture.orig.width),n.x+=T.xAdvance+this._letterSpacing,y=Math.max(y,T.yOffset+T.texture.height),c=x,-1!==m&&u>0&&n.x>u&&(Ao(o,1+m-++g,1+b-m),b=m,m=-1,s.push(_),a.push(o.length>0?o[o.length-1].prevSpaces:0),p=Math.max(p,_),f++,n.x=0,n.y+=e.lineHeight,c=null,v=0)}}else s.push(d),a.push(-1),p=Math.max(p,d),++f,++g,n.x=0,n.y+=e.lineHeight,c=null,v=0}var S=h[h.length-1];"\r"!==S&&"\n"!==S&&(/(?:\s)/.test(S)&&(d=_),s.push(d),p=Math.max(p,d),a.push(-1));var M=[];for(b=0;b<=f;b++){var P=0;"right"===this._align?P=p-s[b]:"center"===this._align?P=(p-s[b])/2:"justify"===this._align&&(P=a[b]<0?0:(p-s[b])/a[b]),M.push(P)}var A=o.length,R={},w=[],I=this._activePagesMeshData;l.push.apply(l,I);for(b=0;b<A;b++){var C=(V=o[b].texture).baseTexture.uid;if(!R[C]){if(!($=l.pop())){var O=new xd,D=void 0,F=void 0;"none"===e.distanceFieldType?(D=new bd(ea.EMPTY),F=W.NORMAL):(D=new bd(ea.EMPTY,{program:Qa.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r\n\r\n}\r\n"),uniforms:{uFWidth:0}}),F=W.NORMAL_NPM);var L=new vd(O,D);L.blendMode=F,$={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:L,vertices:null,uvs:null,indices:null}}$.index=0,$.indexCount=0,$.vertexCount=0,$.uvsCount=0,$.total=0;var B=this._textureCache;B[C]=B[C]||new ea(V.baseTexture),$.mesh.texture=B[C],$.mesh.tint=this._tint,w.push($),R[C]=$}R[C].total++}for(b=0;b<I.length;b++)-1===w.indexOf(I[b])&&this.removeChild(I[b].mesh);for(b=0;b<w.length;b++)w[b].mesh.parent!==this&&this.addChild(w[b].mesh);for(var b in this._activePagesMeshData=w,R){var N=($=R[b]).total;if(!((null===(t=$.indices)||void 0===t?void 0:t.length)>6*N)||$.vertices.length<2*vd.BATCHABLE_SIZE)$.vertices=new Float32Array(8*N),$.uvs=new Float32Array(8*N),$.indices=new Uint16Array(6*N);else for(var U=$.total,G=$.vertices,k=4*U*2;k<G.length;k++)G[k]=0;$.mesh.size=6*N}for(b=0;b<A;b++){var X,j=(X=o[b]).position.x+M[X.line]*("justify"===this._align?X.prevSpaces:1);this._roundPixels&&(j=Math.round(j));var V,H=j*i,Y=X.position.y*i,z=R[(V=X.texture).baseTexture.uid],q=V.frame,K=V._uvs,Z=z.index++;z.indices[6*Z+0]=0+4*Z,z.indices[6*Z+1]=1+4*Z,z.indices[6*Z+2]=2+4*Z,z.indices[6*Z+3]=0+4*Z,z.indices[6*Z+4]=2+4*Z,z.indices[6*Z+5]=3+4*Z,z.vertices[8*Z+0]=H,z.vertices[8*Z+1]=Y,z.vertices[8*Z+2]=H+q.width*i,z.vertices[8*Z+3]=Y,z.vertices[8*Z+4]=H+q.width*i,z.vertices[8*Z+5]=Y+q.height*i,z.vertices[8*Z+6]=H,z.vertices[8*Z+7]=Y+q.height*i,z.uvs[8*Z+0]=K.x0,z.uvs[8*Z+1]=K.y0,z.uvs[8*Z+2]=K.x1,z.uvs[8*Z+3]=K.y1,z.uvs[8*Z+4]=K.x2,z.uvs[8*Z+5]=K.y2,z.uvs[8*Z+6]=K.x3,z.uvs[8*Z+7]=K.y3}for(var b in this._textWidth=p*i,this._textHeight=(n.y+e.lineHeight)*i,R){var $=R[b];if(0!==this.anchor.x||0!==this.anchor.y)for(var J=0,Q=this._textWidth*this.anchor.x,tt=this._textHeight*this.anchor.y,et=0;et<$.total;et++)$.vertices[J++]-=Q,$.vertices[J++]-=tt,$.vertices[J++]-=Q,$.vertices[J++]-=tt,$.vertices[J++]-=Q,$.vertices[J++]-=tt,$.vertices[J++]-=Q,$.vertices[J++]-=tt;this._maxLineHeight=y*i;var rt=$.mesh.geometry.getBuffer("aVertexPosition"),it=$.mesh.geometry.getBuffer("aTextureCoord"),nt=$.mesh.geometry.getIndex();rt.data=$.vertices,it.data=$.uvs,nt.data=$.indices,rt.update(),it.update(),nt.update()}for(b=0;b<o.length;b++)Ld.push(o[b]);this._font=e,this.dirty=!1},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);var r=Od.available[this._fontName],i=r.distanceFieldRange,n=r.distanceFieldType,o=r.size;if("none"!==n)for(var s=this.worldTransform,a=s.a,h=s.b,u=s.c,l=s.d,c=Math.sqrt(a*a+h*h),d=Math.sqrt(u*u+l*l),p=(Math.abs(c)+Math.abs(d))/2,f=this.fontSize/o,m=0,_=this._activePagesMeshData;m<_.length;m++){_[m].mesh.shader.uniforms.uFWidth=p*i*f*this._resolution}t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){var t=Od.available[this._fontName];if(!t)throw new Error('Missing BitmapFont "'+this._fontName+'"');this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()},Object.defineProperty(e.prototype,"tint",{
/**
       * The tint of the BitmapText object.
       * @default 0xffffff
       */
get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{
/**
       * The alignment of the BitmapText object.
       * @member {string}
       * @default 'left'
       */
get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{
/** The name of the BitmapFont. */
get:function(){return this._fontName},set:function(t){if(!Od.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{
/** The size of the font to display. */
get:function(){var t;return null!==(t=this._fontSize)&&void 0!==t?t:Od.available[this._fontName].size},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{
/**
       * The anchor sets the origin point of the text.
       *
       * The default is `(0,0)`, this means the text's origin is the top left.
       *
       * Setting the anchor to `(0.5,0.5)` means the text's origin is centered.
       *
       * Setting the anchor to `(1,1)` would mean the text's origin point will be the bottom right corner.
       */
get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{
/** The text of the BitmapText object. */
get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{
/**
       * The max width of this bitmap text in pixels. If the text provided is longer than the
       * value provided, line breaks will be automatically inserted in the last whitespace.
       * Disable by setting the value to 0.
       */
get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{
/**
       * The max line height. This is useful when trying to use the total height of the Text,
       * i.e. when trying to vertically align.
       * @readonly
       */
get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{
/**
       * The width of the overall text, different from fontSize,
       * which is defined in the style object.
       * @readonly
       */
get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{
/** Additional space between characters. */
get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{
/**
       * If true PixiJS will Math.floor() x/y values when rendering, stopping pixel interpolation.
       * Advantages can include sharper image quality (like text) and faster rendering on canvas.
       * The main disadvantage is movement of objects may appear less smooth.
       * To set the global default, change {@link PIXI.settings.ROUND_PIXELS}
       * @default PIXI.settings.ROUND_PIXELS
       */
get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{
/**
       * The height of the overall text, different from fontSize,
       * which is defined in the style object.
       * @readonly
       */
get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{
/**
       * The resolution / device pixel ratio of the canvas.
       *
       * This is set to automatically match the renderer resolution by default, but can be overridden by setting manually.
       * @default 1
       */
get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.prototype.destroy=function(e){var r=this._textureCache,i="none"===Od.available[this._fontName].distanceFieldType?Dd:Fd;i.push.apply(i,this._activePagesMeshData);for(var n=0,o=this._activePagesMeshData;n<o.length;n++){var s=o[n];this.removeChild(s.mesh)}for(var a in this._activePagesMeshData=[],i.filter((function(t){return r[t.mesh.texture.baseTexture.uid]})).forEach((function(t){t.mesh.texture=ea.EMPTY})),r){r[a].destroy(),delete r[a]}this._font=null,this._textureCache=null,t.prototype.destroy.call(this,e)},e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},e}(ys),Nd=
/** @class */function(){function t(){}return t.add=function(){Iu.setExtensionXhrType("fnt",Iu.XHR_RESPONSE_TYPE.TEXT)},t.use=function(e,r){var i=Rd(e.data);if(i)for(var n=t.getBaseUrl(this,e),o=i.parse(e.data),s={},a=function(t){s[t.metadata.pageFile]=t.texture,Object.keys(s).length===o.page.length&&(e.bitmapFont=Od.install(o,s,!0),r())},h=0;h<o.page.length;++h){var u=o.page[h].file,l=n+u,c=!1;for(var d in this.resources){var p=this.resources[d];if(p.url===l){p.metadata.pageFile=u,p.texture?a(p):p.onAfterMiddleware.add(a),c=!0;break}}if(!c){var f={crossOrigin:e.crossOrigin,loadType:Iu.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(l,f,a)}}else r()},t.getBaseUrl=function(e,r){var i=r.isDataUrl?"":t.dirname(r.url);return r.isDataUrl&&("."===i&&(i=""),e.baseUrl&&i&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(i+="/")),(i=i.replace(e.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/"),i},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t.extension=vs.Loader,t}(),Ud=function(t,e){return Ud=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Ud(t,e)};var Gd=
/** @class */function(t){function e(e){void 0===e&&(e=1);var r=t.call(this,Gh,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return r.alpha=e,r}return function(t,e){function r(){this.constructor=t}Ud(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),Object.defineProperty(e.prototype,"alpha",{
/**
       * Coefficient for alpha multiplication
       * @default 1
       */
get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(rh),kd=function(t,e){return kd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},kd(t,e)};function Xd(t,e){function r(){this.constructor=t}kd(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var jd={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Vd=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");var Hd=
/** @class */function(t){function e(e,r,i,n,o){void 0===r&&(r=8),void 0===i&&(i=4),void 0===n&&(n=Kt.FILTER_RESOLUTION),void 0===o&&(o=5);var s=this,a=function(t,e){var r,i=Math.ceil(t/2),n="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",o="";r=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var s=0;s<t;s++){var a=r.replace("%index%",s.toString());o+=a=a.replace("%sampleIndex%",s-(i-1)+".0"),o+="\n"}return(n=n.replace("%blur%",o)).replace("%size%",t.toString())}(o,e),h=function(t){for(var e,r=jd[t],i=r.length,n=Vd,o="",s=0;s<t;s++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",s.toString());e=s,s>=i&&(e=t-s-1),o+=a=a.replace("%value%",r[e].toString()),o+="\n"}return(n=n.replace("%blur%",o)).replace("%size%",t.toString())}(o);return(s=t.call(this,
// vertex shader
a,
// fragment shader
h)||this).horizontal=e,s.resolution=n,s._quality=0,s.quality=i,s.blur=r,s}return Xd(e,t),e.prototype.apply=function(t,e,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/e.width):this.uniforms.strength=1/r.height*(r.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,r,i);else{var n=t.getFilterTexture(),o=t.renderer,s=e,a=n;this.state.blend=!1,t.applyFilter(this,s,a,pt.CLEAR);for(var h=1;h<this.passes-1;h++){t.bindAndClear(s,pt.BLIT),this.uniforms.uSampler=a;var u=a;a=s,s=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,r,i),t.returnFilterTexture(n)}},Object.defineProperty(e.prototype,"blur",{
/**
       * Sets the strength of both the blur.
       * @default 16
       */
get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{
/**
       * Sets the quality of the blur by modifying the number of passes. More passes means higher
       * quality bluring but the lower the performance.
       * @default 4
       */
get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e}(rh),Yd=
/** @class */function(t){function e(e,r,i,n){void 0===e&&(e=8),void 0===r&&(r=4),void 0===i&&(i=Kt.FILTER_RESOLUTION),void 0===n&&(n=5);var o=t.call(this)||this;return o.blurXFilter=new Hd(!0,e,r,i,n),o.blurYFilter=new Hd(!1,e,r,i,n),o.resolution=i,o.quality=r,o.blur=e,o.repeatEdgePixels=!1,o}return Xd(e,t),e.prototype.apply=function(t,e,r,i){var n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){var s=t.getFilterTexture();this.blurXFilter.apply(t,e,s,pt.CLEAR),this.blurYFilter.apply(t,s,r,i),t.returnFilterTexture(s)}else o?this.blurYFilter.apply(t,e,r,i):this.blurXFilter.apply(t,e,r,i)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(e.prototype,"blur",{
/**
       * Sets the strength of both the blurX and blurY properties simultaneously
       * @default 2
       */
get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{
/**
       * Sets the number of passes for blur. More passes means higher quality bluring.
       * @default 1
       */
get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{
/**
       * Sets the strength of the blurX property
       * @default 2
       */
get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{
/**
       * Sets the strength of the blurY property
       * @default 2
       */
get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{
/**
       * Sets the blendmode of the filter
       * @default PIXI.BLEND_MODES.NORMAL
       */
get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{
/**
       * If set to true the edge of the target will be clamped
       * @default false
       */
get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0}),e}(rh),zd=function(t,e){return zd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},zd(t,e)};var Wd=
/** @class */function(t){function e(){var e=this,r={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=t.call(this,kh,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",r)||this).alpha=1,e}return function(t,e){function r(){this.constructor=t}zd(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var r=t;e&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r},e.prototype._multiply=function(t,e,r){return t[0]=e[0]*r[0]+e[1]*r[5]+e[2]*r[10]+e[3]*r[15],t[1]=e[0]*r[1]+e[1]*r[6]+e[2]*r[11]+e[3]*r[16],t[2]=e[0]*r[2]+e[1]*r[7]+e[2]*r[12]+e[3]*r[17],t[3]=e[0]*r[3]+e[1]*r[8]+e[2]*r[13]+e[3]*r[18],t[4]=e[0]*r[4]+e[1]*r[9]+e[2]*r[14]+e[3]*r[19]+e[4],t[5]=e[5]*r[0]+e[6]*r[5]+e[7]*r[10]+e[8]*r[15],t[6]=e[5]*r[1]+e[6]*r[6]+e[7]*r[11]+e[8]*r[16],t[7]=e[5]*r[2]+e[6]*r[7]+e[7]*r[12]+e[8]*r[17],t[8]=e[5]*r[3]+e[6]*r[8]+e[7]*r[13]+e[8]*r[18],t[9]=e[5]*r[4]+e[6]*r[9]+e[7]*r[14]+e[8]*r[19]+e[9],t[10]=e[10]*r[0]+e[11]*r[5]+e[12]*r[10]+e[13]*r[15],t[11]=e[10]*r[1]+e[11]*r[6]+e[12]*r[11]+e[13]*r[16],t[12]=e[10]*r[2]+e[11]*r[7]+e[12]*r[12]+e[13]*r[17],t[13]=e[10]*r[3]+e[11]*r[8]+e[12]*r[13]+e[13]*r[18],t[14]=e[10]*r[4]+e[11]*r[9]+e[12]*r[14]+e[13]*r[19]+e[14],t[15]=e[15]*r[0]+e[16]*r[5]+e[17]*r[10]+e[18]*r[15],t[16]=e[15]*r[1]+e[16]*r[6]+e[17]*r[11]+e[18]*r[16],t[17]=e[15]*r[2]+e[16]*r[7]+e[17]*r[12]+e[18]*r[17],t[18]=e[15]*r[3]+e[16]*r[8]+e[17]*r[13]+e[18]*r[18],t[19]=e[15]*r[4]+e[16]*r[9]+e[17]*r[14]+e[18]*r[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.tint=function(t,e){var r=[(t>>16&255)/255,0,0,0,0,0,(t>>8&255)/255,0,0,0,0,0,(255&t)/255,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.greyscale=function(t,e){var r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var r=Math.cos(t),i=Math.sin(t),n=1/3,o=(0,Math.sqrt)(n),s=[r+(1-r)*n,n*(1-r)-o*i,n*(1-r)+o*i,0,0,n*(1-r)+o*i,r+n*(1-r),n*(1-r)-o*i,0,0,n*(1-r)-o*i,n*(1-r)+o*i,r+n*(1-r),0,0,0,0,0,1,0];this._loadMatrix(s,e)},e.prototype.contrast=function(t,e){var r=(t||0)+1,i=-.5*(r-1),n=[r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var r=2*t/3+1,i=-.5*(r-1),n=[r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,r,i,n){var o=((r=r||16770432)>>16&255)/255,s=(r>>8&255)/255,a=(255&r)/255,h=((i=i||3375104)>>16&255)/255,u=(i>>8&255)/255,l=(255&i)/255,c=[.3,.59,.11,0,0,o,s,a,t=t||.2,0,h,u,l,e=e||.15,0,o-h,s-u,a-l,0,0];this._loadMatrix(c,n)},e.prototype.night=function(t,e){var r=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.predator=function(t,e){var r=[
// row 1
11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,
// row 2
-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,
// row 3
-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,
// row 4
0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{
/**
       * The matrix of the color matrix filter
       * @member {number[]}
       * @default [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0]
       */
get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{
/**
       * The opacity value to use when mixing the original and resultant colors.
       *
       * When the value is 0, the original color is used without modification.
       * When the value is 1, the result color is used.
       * When in the range (0, 1) the color is interpolated between the original and result by this amount.
       * @default 1
       */
get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(rh);Wd.prototype.grayscale=Wd.prototype.greyscale;
/*!
 * @pixi/filter-displacement - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var qd=function(t,e){return qd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},qd(t,e)};var Kd=
/** @class */function(t){function e(e,r){var i=this,n=new rs;return e.renderable=!1,(i=t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,i.maskMatrix=n,null==r&&(r=20),i.scale=new qo(r,r),i}return function(t,e){function r(){this.constructor=t}qd(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.apply=function(t,e,r,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),s=Math.sqrt(n.c*n.c+n.d*n.d);0!==o&&0!==s&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/s,this.uniforms.rotation[3]=n.d/s),t.applyFilter(this,e,r,i)},Object.defineProperty(e.prototype,"map",{
/** The texture used for the displacement map. Must be power of 2 sized texture. */
get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0}),e}(rh),Zd=function(t,e){return Zd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Zd(t,e)};var $d=
/** @class */function(t){function e(){return t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}return function(t,e){function r(){this.constructor=t}Zd(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(rh),Jd=function(t,e){return Jd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Jd(t,e)};var Qd=
/** @class */function(t){function e(e,r){void 0===e&&(e=.5),void 0===r&&(r=Math.random());var i=t.call(this,kh,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return i.noise=e,i.seed=r,i}return function(t,e){function r(){this.constructor=t}Jd(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),Object.defineProperty(e.prototype,"noise",{
/**
       * The amount of noise to apply, this value should be in the range (0, 1].
       * @default 0.5
       */
get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{
/** A seed value to apply to the random noise generation. `Math.random()` is a good value to use. */
get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0}),e}(rh),tp=new rs;ms.prototype._cacheAsBitmap=!1,ms.prototype._cacheData=null,ms.prototype._cacheAsBitmapResolution=null,ms.prototype._cacheAsBitmapMultisample=Et.NONE;var ep=
/** @class */
function(){return function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}();Object.defineProperties(ms.prototype,{
/**
   * The resolution to use for cacheAsBitmap. By default this will use the renderer's resolution
   * but can be overriden for performance. Lower values will reduce memory usage at the expense
   * of render quality. A falsey value of `null` or `0` will default to the renderer's resolution.
   * If `cacheAsBitmap` is set to `true`, this will re-render with the new resolution.
   * @member {number} cacheAsBitmapResolution
   * @memberof PIXI.DisplayObject#
   * @default null
   */
cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},
/**
   * The number of samples to use for cacheAsBitmap. If set to `null`, the renderer's
   * sample count is used.
   * If `cacheAsBitmap` is set to `true`, this will re-render with the new number of samples.
   * @member {number} cacheAsBitmapMultisample
   * @memberof PIXI.DisplayObject#
   * @default PIXI.MSAA_QUALITY.NONE
   */
cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},
/**
   * Set this to true if you want this display object to be cached as a bitmap.
   * This basically takes a snap shot of the display object as it is at that moment. It can
   * provide a performance benefit for complex static displayObjects.
   * To remove simply set this property to `false`
   *
   * IMPORTANT GOTCHA - Make sure that all your textures are preloaded BEFORE setting this property to true
   * as it will take a snapshot of what is currently there. If the textures have not loaded then they will not appear.
   * @member {boolean}
   * @memberof PIXI.DisplayObject#
   */
cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new ep),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),ms.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},ms.prototype._initCachedDisplayObject=function(t){var e;if(!this._cacheData||!this._cacheData.sprite){var r=this.alpha;this.alpha=1,t.batch.flush();var i=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var n=this.filters[0].padding;i.pad(n)}i.ceil(Kt.RESOLUTION);var o=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),a=t.renderTexture.destinationFrame.clone(),h=t.projection.transform,u=ra.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:null!==(e=this.cacheAsBitmapMultisample)&&void 0!==e?e:t.multisample}),l="cacheAsBitmap_"+Io();this._cacheData.textureCacheId=l,Us.addToCache(u.baseTexture,l),ea.addToCache(u,l);var c=this.transform.localTransform.copyTo(tp).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:u,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=h,t.renderTexture.bind(o,s,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;var d=new Oc(u);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-i.x/i.width,d.anchor.y=-i.y/i.height,d.alpha=r,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)}},ms.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},ms.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;var i=t.context,n=t._projTransform;e.ceil(Kt.RESOLUTION);var o=ra.create({width:e.width,height:e.height}),s="cacheAsBitmap_"+Io();this._cacheData.textureCacheId=s,Us.addToCache(o.baseTexture,s),ea.addToCache(o,s);var a=tp;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=e.x,a.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:a,skipUpdateTransform:!1}),t.context=i,t._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;var h=new Oc(o);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},ms.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},ms.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},ms.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Us.removeFromCache(this._cacheData.textureCacheId),ea.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},ms.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},
/*!
 * @pixi/mixin-get-child-by-name - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
ms.prototype.name=null,ys.prototype.getChildByName=function(t,e){for(var r=0,i=this.children.length;r<i;r++)if(this.children[r].name===t)return this.children[r];if(e)for(r=0,i=this.children.length;r<i;r++){var n=this.children[r];if(n.getChildByName){var o=n.getChildByName(t,!0);if(o)return o}}return null},
/*!
 * @pixi/mixin-get-global-position - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
ms.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new qo),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};
/*!
 * @pixi/app - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var rp=
/** @class */function(){function t(){}return t.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",
/**
         * The HTML element or window to automatically resize the
         * renderer's view element to match width and height.
         * @member {Window|HTMLElement}
         * @name resizeTo
         * @memberof PIXI.Application#
         */
{set:function(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame((function(){return e.resize()})))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var t,r;if(e.cancelResize(),e._resizeTo===globalThis.window)t=globalThis.innerWidth,r=globalThis.innerHeight;else{var i=e._resizeTo;t=i.clientWidth,r=i.clientHeight}e.renderer.resize(t,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},t.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},t.extension=vs.Application,t}(),ip=
/** @class */function(){function t(e){var r=this;this.stage=new ys,e=Object.assign({forceCanvas:!1},e),this.renderer=Uh(e),t._plugins.forEach((function(t){t.init.call(r,e)}))}return t.registerPlugin=function(t){Oo(0,"Application.registerPlugin() is deprecated, use extensions.add()"),Ms.add({type:vs.Application,ref:t})},t.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(t.prototype,"view",{
/**
       * Reference to the renderer's canvas element.
       * @member {HTMLCanvasElement}
       * @readonly
       */
get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{
/**
       * Reference to the renderer's screen rectangle. Its safe to use as `filterArea` or `hitArea` for the whole screen.
       * @member {PIXI.Rectangle}
       * @readonly
       */
get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e,r){var i=this,n=t._plugins.slice(0);n.reverse(),n.forEach((function(t){t.destroy.call(i)})),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null},t._plugins=[],t}();Ms.handleByList(vs.Application,ip._plugins),Ms.add(rp);
/*!
 * @pixi/mesh-extras - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mesh-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var np=function(t,e){return np=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},np(t,e)};function op(t,e){function r(){this.constructor=t}np(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var sp=
/** @class */function(t){function e(e,r,i,n){void 0===e&&(e=100),void 0===r&&(r=100),void 0===i&&(i=10),void 0===n&&(n=10);var o=t.call(this)||this;return o.segWidth=i,o.segHeight=n,o.width=e,o.height=r,o.build(),o}return op(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],r=[],i=[],n=this.segWidth-1,o=this.segHeight-1,s=this.width/n,a=this.height/o,h=0;h<t;h++){var u=h%this.segWidth,l=h/this.segWidth|0;e.push(u*s,l*a),r.push(u/n,l/o)}var c=n*o;for(h=0;h<c;h++){var d=h%n,p=h/n|0,f=p*this.segWidth+d,m=p*this.segWidth+d+1,_=(p+1)*this.segWidth+d,g=(p+1)*this.segWidth+d+1;i.push(f,m,_,m,g,_)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(i),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(xd),ap=
/** @class */function(t){function e(e,r,i){void 0===e&&(e=200),void 0===i&&(i=0);var n=t.call(this,new Float32Array(4*r.length),new Float32Array(4*r.length),new Uint16Array(6*(r.length-1)))||this;return n.points=r,n._width=e,n.textureScale=i,n.build(),n}return op(e,t),Object.defineProperty(e.prototype,"width",{
/**
       * The width (i.e., thickness) of the rope.
       * @readonly
       */
get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),i=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),r.data=new Float32Array(4*t.length),i.data=new Uint16Array(6*(t.length-1)));var n=r.data,o=i.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;for(var s=0,a=t[0],h=this._width*this.textureScale,u=t.length,l=0;l<u;l++){var c=4*l;if(this.textureScale>0){var d=a.x-t[l].x,p=a.y-t[l].y,f=Math.sqrt(d*d+p*p);a=t[l],s+=f/h}else s=l/(u-1);n[c]=s,n[c+1]=0,n[c+2]=s,n[c+3]=1}var m=0;for(l=0;l<u-1;l++){c=2*l;o[m++]=c,o[m++]=c+1,o[m++]=c+2,o[m++]=c+2,o[m++]=c+1,o[m++]=c+3}r.update(),i.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,r=t[0],i=0,n=0,o=this.buffers[0].data,s=t.length,a=0;a<s;a++){var h=t[a],u=4*a;n=-((e=a<t.length-1?t[a+1]:h).x-r.x),i=e.y-r.y;var l=Math.sqrt(i*i+n*n),c=this.textureScale>0?this.textureScale*this._width/2:this._width/2;i/=l,n/=l,i*=c,n*=c,o[u]=h.x+i,o[u+1]=h.y+n,o[u+2]=h.x-i,o[u+3]=h.y-n,r=h}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(xd),hp=
/** @class */function(t){function e(e,r,i){void 0===i&&(i=0);var n=this,o=new ap(e.height,r,i),s=new bd(e);return i>0&&(e.baseTexture.wrapMode=at.REPEAT),(n=t.call(this,o,s)||this).autoUpdate=!0,n}return op(e,t),e.prototype._render=function(e){var r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),t.prototype._render.call(this,e)},e}(vd),up=
/** @class */function(t){function e(e,r,i){var n=this,o=new sp(e.width,e.height,r,i),s=new bd(ea.WHITE);return(n=t.call(this,o,s)||this).texture=e,n.autoResize=!0,n}return op(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,e=this.shader.texture,r=e.width,i=e.height;!this.autoResize||t.width===r&&t.height===i||(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},e.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),t.prototype.destroy.call(this,e)},e}(vd),lp=
/** @class */function(t){function e(e,r,i,n,o){void 0===e&&(e=ea.EMPTY);var s=this,a=new xd(r,i,n);a.getBuffer("aVertexPosition").static=!1;var h=new bd(e);return(s=t.call(this,a,h,null,o)||this).autoUpdate=!0,s}return op(e,t),Object.defineProperty(e.prototype,"vertices",{
/**
       * Collection of vertices data.
       * @type {Float32Array}
       */
get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},e}(vd),cp=
/** @class */function(t){function e(e,r,i,n,o){void 0===r&&(r=10),void 0===i&&(i=10),void 0===n&&(n=10),void 0===o&&(o=10);var s=t.call(this,ea.WHITE,4,4)||this;return s._origWidth=e.orig.width,s._origHeight=e.orig.height,s._width=s._origWidth,s._height=s._origHeight,s._leftWidth=r,s._rightWidth=n,s._topHeight=i,s._bottomHeight=o,s.texture=e,s}return op(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,r=this._topHeight+this._bottomHeight,i=this._height>r?1:this._height/r;return Math.min(e,i)},Object.defineProperty(e.prototype,"width",{
/** The width of the NineSlicePlane, setting this will actually modify the vertices and UV's of this plane. */
get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{
/** The height of the NineSlicePlane, setting this will actually modify the vertices and UV's of this plane. */
get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{
/** The width of the left column. */
get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{
/** The width of the right column. */
get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{
/** The height of the top row. */
get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{
/** The height of the bottom row. */
get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var r=1/this._origWidth,i=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=r*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-r*this._rightWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(up),dp=function(t,e){return dp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},dp(t,e)};var pp=
/** @class */function(t){function e(e,r){void 0===r&&(r=!0);var i=t.call(this,e[0]instanceof ea?e[0]:e[0].texture)||this;return i._textures=null,i._durations=null,i._autoUpdate=r,i._isConnectedToTicker=!1,i.animationSpeed=1,i.loop=!0,i.updateAnchor=!1,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i._playing=!1,i._previousFrame=null,i.textures=e,i}return function(t,e){function r(){this.constructor=t}dp(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Rs.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Rs.shared.add(this.update,this,Ts.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){if(this._playing){var e=this.animationSpeed*t,r=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var r=[],i=0;i<t.length;++i)r.push(ea.from(t[i]));return new e(r)},e.fromImages=function(t){for(var r=[],i=0;i<t.length;++i)r.push(ea.from(t[i]));return new e(r)},Object.defineProperty(e.prototype,"totalFrames",{
/**
       * The total number of frames in the AnimatedSprite. This is the same as number of textures
       * assigned to the AnimatedSprite.
       * @readonly
       * @default 0
       */
get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{
/** The array of textures used for this AnimatedSprite. */
get:function(){return this._textures},set:function(t){if(t[0]instanceof ea)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{
/**
       * The AnimatedSprites current frame index.
       * @readonly
       */
get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{
/**
       * Indicates if the AnimatedSprite is currently playing.
       * @readonly
       */
get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{
/** Whether to use PIXI.Ticker.shared to auto update animation time. */
get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Rs.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Rs.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),e}(Oc);
/*!
 * pixi.js - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Ms.add(
// Install renderer plugins
ou,mu,pu,Zl,id,$h,pd,
// Install loader plugins
Nd,tl,kl,Xl,sd,
// Install application plugins
ws,Nu);var fp={AlphaFilter:Gd,BlurFilter:Yd,BlurFilterPass:Hd,ColorMatrixFilter:Wd,DisplacementFilter:Kd,FXAAFilter:$d,NoiseFilter:Qd};const mp=Object.freeze(Object.defineProperty({__proto__:null,get ALPHA_MODES(){return ct},AbstractBatchRenderer:Yh,AbstractMultiResource:Gs,AbstractRenderer:Fh,AccessibilityManager:ou,AnimatedSprite:pp,AppLoaderPlugin:Nu,Application:ip,ArrayResource:ks,Attribute:na,get BLEND_MODES(){return W},get BUFFER_BITS(){return Y},get BUFFER_TYPE(){return Mt},BaseImageResource:Xs,BasePrepare:Qc,BaseRenderTexture:$s,BaseTexture:Us,BatchDrawCall:jh,BatchGeometry:Wh,BatchPluginFactory:Zh,BatchRenderer:$h,BatchShaderGenerator:zh,BatchSystem:xa,BatchTextureArray:Vh,BitmapFont:Od,BitmapFontData:Ed,BitmapFontLoader:Nd,BitmapText:Bd,BlobResource:Ju,Bounds:ds,BrowserAdapter:Ct,Buffer:sa,BufferResource:Bs,get CLEAR_MODES(){return pt},get COLOR_MASK_BITS(){return xt},CanvasResource:js,Circle:$o,CompressedTextureLoader:tl,CompressedTextureResource:Qu,Container:ys,ContextSystem:Ea,CountLimiter:Yc,CubeResource:Vs,DDSLoader:kl,DEG_TO_RAD:Wo,get DRAW_MODES(){return K},DisplayObject:ms,get ENV(){return X},Ellipse:Jo,get ExtensionType(){return vs},Extract:mu,get FORMATS(){return $},FORMATS_TO_COMPONENTS:Bl,FillStyle:Jl,Filter:rh,FilterState:_a,FilterSystem:va,Framebuffer:Zs,FramebufferSystem:Pa,get GC_MODES(){return mt},GLFramebuffer:Sa,GLProgram:Eh,GLTexture:Ih,GRAPHICS_CURVES:$l,Geometry:ca,GeometrySystem:Ra,Graphics:Mc,GraphicsData:vc,GraphicsGeometry:xc,IGLUniformData:Th,INSTALLED:Is,get INTERNAL_FORMATS(){return ju},INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:Yu,ImageBitmapResource:Ws,ImageResource:Hs,InteractionData:su,InteractionEvent:hu,InteractionManager:pu,InteractionTrackingData:uu,KTXLoader:Xl,get LINE_CAP(){return zl},get LINE_JOIN(){return Hl},LineStyle:Tc,Loader:Bu,get LoaderResource(){return Iu},get MASK_TYPES(){return vt},get MIPMAP_MODES(){return ut},get MSAA_QUALITY(){return Et},MaskData:wa,MaskSystem:sh,Matrix:rs,Mesh:vd,MeshBatchUvs:_d,MeshGeometry:xd,MeshMaterial:bd,NineSlicePlane:cp,ObjectRenderer:ba,ObservablePoint:es,PI_2:Yo,get PRECISION(){return gt},ParticleContainer:ql,ParticleRenderer:Zl,PlaneGeometry:sp,Point:qo,Polygon:Qo,Prepare:id,Program:Qa,ProjectionSystem:dh,Quad:da,QuadUv:pa,RAD_TO_DEG:zo,get RENDERER_TYPE(){return V},Rectangle:Zo,RenderTexture:ra,RenderTexturePool:ia,RenderTextureSystem:mh,Renderer:Nh,ResizePlugin:rp,Resource:Ls,RopeGeometry:ap,RoundedRectangle:ts,Runner:Ps,get SAMPLER_TYPES(){return it},get SCALE_MODES(){return ot},get SHAPES(){return Vo},SVGResource:Ys,ScissorSystem:lh,Shader:th,ShaderSystem:Ah,SimpleMesh:lp,SimplePlane:up,SimpleRope:hp,Sprite:Oc,SpriteMaskFilter:oh,Spritesheet:od,SpritesheetLoader:sd,State:eh,StateSystem:Rh,StencilSystem:ch,System:Xh,get TARGETS(){return Q},get TEXT_GRADIENT(){return Rc},get TYPES(){return et},TYPES_TO_BYTES_PER_COMPONENT:Ll,TYPES_TO_BYTES_PER_PIXEL:Nl,TemporaryDisplayObject:_s,Text:Vc,TextFormat:Sd,TextMetrics:Xc,TextStyle:Bc,Texture:ea,TextureGCSystem:wh,TextureLoader:Uu,TextureMatrix:nh,TextureSystem:Ch,TextureUvs:Js,Ticker:Rs,TickerPlugin:ws,TilingSprite:ld,TilingSpriteRenderer:pd,TimeLimiter:nd,Transform:cs,get UPDATE_PRIORITY(){return Ts},UniformGroup:ma,VERSION:"6.5.10",VideoResource:zs,ViewableBuffer:Hh,get WRAP_MODES(){return at},XMLFormat:Md,XMLStringFormat:Pd,accessibleTarget:iu,autoDetectFormat:Rd,autoDetectRenderer:Uh,autoDetectResource:Cs,checkMaxIfStatementsInShader:Za,createUBOElements:vh,defaultFilterVertex:kh,defaultVertex:Gh,extensions:Ms,filters:fp,generateProgram:Sh,generateUniformBufferSync:xh,getTestContext:Na,getUBOData:bh,graphicsUtils:Pc,groupD8:ls,interactiveTarget:cu,isMobile:qt,parseDDS:xl,parseKTX:Ul,resources:Jh,settings:Kt,systems:eu,uniformParsers:Ha,utils:jo},Symbol.toStringTag,{value:"Module"}));var _p=Math.pow,gp=(t,e,r)=>new Promise(((i,n)=>{var o=t=>{try{a(r.next(t))}catch(pm){n(pm)}},s=t=>{try{a(r.throw(t))}catch(pm){n(pm)}},a=t=>t.done?i(t.value):Promise.resolve(t.value).then(o,s);a((r=r.apply(t,e)).next())}));var yp,vp,bp,xp;(vp=yp||(yp={})).supportMoreMaskDivisions=!0,vp.setOpacityFromMotion=!1,(xp=bp||(bp={})).LOG_LEVEL_VERBOSE=0,xp.LOG_LEVEL_WARNING=1,xp.LOG_LEVEL_ERROR=2,xp.LOG_LEVEL_NONE=999,xp.logLevel=xp.LOG_LEVEL_WARNING,xp.sound=!0,xp.motionSync=!0,xp.motionFadingDuration=500,xp.idleMotionFadingDuration=2e3,xp.expressionFadingDuration=500,xp.preserveExpressionOnMotion=!0,xp.cubism4=yp;const Tp={log(t,...e){bp.logLevel,bp.LOG_LEVEL_VERBOSE},warn(t,...e){bp.logLevel,bp.LOG_LEVEL_WARNING},error(t,...e){bp.logLevel,bp.LOG_LEVEL_ERROR}};function Ep(t,e,r){return t<e?e:t>r?r:t}function Sp(t,e,r,i,n){const o=e[i];null!==o&&typeof o===t&&(r[n]=o)}function Mp(t,e,r,i,n){const o=e[i];Array.isArray(o)&&(r[n]=o.filter((e=>null!==e&&typeof e===t)))}function Pp(t,e){e.forEach((e=>{Object.getOwnPropertyNames(e.prototype).forEach((r=>{"constructor"!==r&&Object.defineProperty(t.prototype,r,Object.getOwnPropertyDescriptor(e.prototype,r))}))}))}class ExpressionManager extends $t{constructor(t,e){super(),this.expressions=[],this.reserveExpressionIndex=-1,this.destroyed=!1,this.settings=t,this.tag=`ExpressionManager(${t.name})`}init(){this.defaultExpression=this.createExpression({},void 0),this.currentExpression=this.defaultExpression,this.stopAllExpressions()}loadExpression(t){return gp(this,null,(function*(){if(!this.definitions[t])return void Tp.warn(this.tag,`Undefined expression at [${t}]`);if(null===this.expressions[t])return void Tp.warn(this.tag,`Cannot set expression at [${t}] because it's already failed in loading.`);if(this.expressions[t])return this.expressions[t];const e=yield this._loadExpression(t);return this.expressions[t]=e,e}))}_loadExpression(t){throw new Error("Not implemented.")}setRandomExpression(){return gp(this,null,(function*(){if(this.definitions.length){const t=[];for(let e=0;e<this.definitions.length;e++)null!==this.expressions[e]&&this.expressions[e]!==this.currentExpression&&e!==this.reserveExpressionIndex&&t.push(e);if(t.length){const e=Math.floor(Math.random()*t.length);return this.setExpression(e)}}return!1}))}resetExpression(){this._setExpression(this.defaultExpression)}restoreExpression(){this._setExpression(this.currentExpression)}setExpression(t){return gp(this,null,(function*(){if("number"!=typeof t&&(t=this.getExpressionIndex(t)),!(t>-1&&t<this.definitions.length))return!1;if(t===this.expressions.indexOf(this.currentExpression))return!1;this.reserveExpressionIndex=t;const e=yield this.loadExpression(t);return!(!e||this.reserveExpressionIndex!==t)&&(this.reserveExpressionIndex=-1,this.currentExpression=e,this._setExpression(e),!0)}))}update(t,e){return!this.isFinished()&&this.updateParameters(t,e)}destroy(){this.destroyed=!0,this.emit("destroy");this.definitions=void 0,this.expressions=void 0}}const Ap=40/7.5,Rp=1/150;class FocusController{constructor(){this.targetX=0,this.targetY=0,this.x=0,this.y=0,this.vx=0,this.vy=0}focus(t,e,r=!1){this.targetX=Ep(t,-1,1),this.targetY=Ep(e,-1,1),r&&(this.x=this.targetX,this.y=this.targetY)}update(t){const e=this.targetX-this.x,r=this.targetY-this.y;if(Math.abs(e)<.01&&Math.abs(r)<.01)return;const i=Math.sqrt(_p(e,2)+_p(r,2)),n=Ap/(1e3/t);let o=n*(e/i)-this.vx,s=n*(r/i)-this.vy;const a=Math.sqrt(_p(o,2)+_p(s,2)),h=n*Rp*t;a>h&&(o*=h/a,s*=h/a),this.vx+=o,this.vy+=s;const u=Math.sqrt(_p(this.vx,2)+_p(this.vy,2)),l=.5*(Math.sqrt(_p(h,2)+8*h*i)-h);u>l&&(this.vx*=l/u,this.vy*=l/u),this.x+=this.vx,this.y+=this.vy}}class ModelSettings{constructor(t){this.json=t;let e=t.url;if("string"!=typeof e)throw new TypeError("The `url` field in settings JSON must be defined as a string.");this.url=e,this.name=function(t){let e=t.lastIndexOf("/");return-1!=e&&(t=t.slice(0,e)),e=t.lastIndexOf("/"),-1!==e&&(t=t.slice(e+1)),t}(this.url)}resolveURL(t){return ro.resolve(this.url,t)}replaceFiles(t){this.moc=t(this.moc,"moc"),void 0!==this.pose&&(this.pose=t(this.pose,"pose")),void 0!==this.physics&&(this.physics=t(this.physics,"physics"));for(let e=0;e<this.textures.length;e++)this.textures[e]=t(this.textures[e],`textures[${e}]`)}getDefinedFiles(){const t=[];return this.replaceFiles((e=>(t.push(e),e))),t}validateFiles(t){const e=(e,r)=>{const i=this.resolveURL(e);if(!t.includes(i)){if(r)throw new Error(`File "${e}" is defined in settings, but doesn't exist in given files`);return!1}return!0};[this.moc,...this.textures].forEach((t=>e(t,!0)));return this.getDefinedFiles().filter((t=>e(t,!1)))}}var wp=(t=>(t[t.NONE=0]="NONE",t[t.IDLE=1]="IDLE",t[t.NORMAL=2]="NORMAL",t[t.FORCE=3]="FORCE",t))(wp||{});class MotionState{constructor(){this.debug=!1,this.currentPriority=0,this.reservePriority=0}reserve(t,e,r){if(r<=0)return Tp.log(this.tag,"Cannot start a motion with MotionPriority.NONE."),!1;if(t===this.currentGroup&&e===this.currentIndex)return Tp.log(this.tag,"Motion is already playing.",this.dump(t,e)),!1;if(t===this.reservedGroup&&e===this.reservedIndex||t===this.reservedIdleGroup&&e===this.reservedIdleIndex)return Tp.log(this.tag,"Motion is already reserved.",this.dump(t,e)),!1;if(1===r){if(0!==this.currentPriority)return Tp.log(this.tag,"Cannot start idle motion because another motion is playing.",this.dump(t,e)),!1;if(void 0!==this.reservedIdleGroup)return Tp.log(this.tag,"Cannot start idle motion because another idle motion has reserved.",this.dump(t,e)),!1;this.setReservedIdle(t,e)}else{if(r<3){if(r<=this.currentPriority)return Tp.log(this.tag,"Cannot start motion because another motion is playing as an equivalent or higher priority.",this.dump(t,e)),!1;if(r<=this.reservePriority)return Tp.log(this.tag,"Cannot start motion because another motion has reserved as an equivalent or higher priority.",this.dump(t,e)),!1}this.setReserved(t,e,r)}return!0}start(t,e,r,i){if(1===i){if(this.setReservedIdle(void 0,void 0),0!==this.currentPriority)return Tp.log(this.tag,"Cannot start idle motion because another motion is playing.",this.dump(e,r)),!1}else{if(e!==this.reservedGroup||r!==this.reservedIndex)return Tp.log(this.tag,"Cannot start motion because another motion has taken the place.",this.dump(e,r)),!1;this.setReserved(void 0,void 0,0)}return!!t&&(this.setCurrent(e,r,i),!0)}complete(){this.setCurrent(void 0,void 0,0)}setCurrent(t,e,r){this.currentPriority=r,this.currentGroup=t,this.currentIndex=e}setReserved(t,e,r){this.reservePriority=r,this.reservedGroup=t,this.reservedIndex=e}setReservedIdle(t,e){this.reservedIdleGroup=t,this.reservedIdleIndex=e}isActive(t,e){return t===this.currentGroup&&e===this.currentIndex||t===this.reservedGroup&&e===this.reservedIndex||t===this.reservedIdleGroup&&e===this.reservedIdleIndex}reset(){this.setCurrent(void 0,void 0,0),this.setReserved(void 0,void 0,0),this.setReservedIdle(void 0,void 0)}shouldRequestIdleMotion(){return void 0===this.currentGroup&&void 0===this.reservedIdleGroup}shouldOverrideExpression(){return!bp.preserveExpressionOnMotion&&this.currentPriority>1}dump(t,e){if(this.debug){return`\n<Requested> group = "${t}", index = ${e}\n`+["currentPriority","reservePriority","currentGroup","currentIndex","reservedGroup","reservedIndex","reservedIdleGroup","reservedIdleIndex"].map((t=>"["+t+"] "+this[t])).join("\n")}return""}}class SoundManager{static get volume(){return this._volume}static set volume(t){this._volume=(t>1?1:t<0?0:t)||0,this.audios.forEach((t=>t.volume=this._volume))}static add(t,e,r){const i=new Audio(t);return i.volume=this._volume,i.preload="auto",i.addEventListener("ended",(()=>{this.dispose(i),null==e||e()})),i.addEventListener("error",(e=>{this.dispose(i),Tp.warn("SoundManager",`Error occurred on "${t}"`,e.error),null==r||r(e.error)})),this.audios.push(i),i}static play(t){return new Promise(((e,r)=>{var i;null==(i=t.play())||i.catch((e=>{t.dispatchEvent(new ErrorEvent("error",{error:e})),r(e)})),t.readyState===t.HAVE_ENOUGH_DATA?e():t.addEventListener("canplaythrough",e)}))}static dispose(t){t.pause(),t.removeAttribute("src"),function(t,e){const r=t.indexOf(e);-1!==r&&t.splice(r,1)}(this.audios,t)}static destroy(){for(let t=this.audios.length-1;t>=0;t--)this.dispose(this.audios[t])}}SoundManager.audios=[],SoundManager._volume=.5;class MotionManager extends $t{constructor(t,e){super(),this.motionGroups={},this.state=new MotionState,this.playing=!1,this.destroyed=!1,this.settings=t,this.tag=`MotionManager(${t.name})`,this.state.tag=this.tag}init(t){(null==t?void 0:t.idleMotionGroup)&&(this.groups.idle=t.idleMotionGroup),this.setupMotions(t),this.stopAllMotions()}setupMotions(t){for(const r of Object.keys(this.definitions))this.motionGroups[r]=[];let e;switch(null==t?void 0:t.motionPreload){case"NONE":return;case"ALL":e=Object.keys(this.definitions);break;default:e=[this.groups.idle]}for(const r of e)if(this.definitions[r])for(let t=0;t<this.definitions[r].length;t++)this.loadMotion(r,t).then()}loadMotion(t,e){return gp(this,null,(function*(){var r;if(!(null==(r=this.definitions[t])?void 0:r[e]))return void Tp.warn(this.tag,`Undefined motion at "${t}"[${e}]`);if(null===this.motionGroups[t][e])return void Tp.warn(this.tag,`Cannot start motion at "${t}"[${e}] because it's already failed in loading.`);if(this.motionGroups[t][e])return this.motionGroups[t][e];const i=yield this._loadMotion(t,e);return this.destroyed?void 0:(this.motionGroups[t][e]=null!=i?i:null,i)}))}_loadMotion(t,e){throw new Error("Not implemented.")}startMotion(t,e){return gp(this,arguments,(function*(t,e,r=wp.NORMAL){var i;if(!this.state.reserve(t,e,r))return!1;const n=null==(i=this.definitions[t])?void 0:i[e];if(!n)return!1;let o;if(this.currentAudio&&SoundManager.dispose(this.currentAudio),bp.sound){const t=this.getSoundFile(n);if(t)try{o=SoundManager.add(this.settings.resolveURL(t),(()=>this.currentAudio=void 0),(()=>this.currentAudio=void 0)),this.currentAudio=o}catch(pm){Tp.warn(this.tag,"Failed to create audio",t,pm)}}const s=yield this.loadMotion(t,e);if(o){const t=SoundManager.play(o).catch((t=>Tp.warn(this.tag,"Failed to play audio",o.src,t)));bp.motionSync&&(yield t)}return this.state.start(s,t,e,r)?(Tp.log(this.tag,"Start motion:",this.getMotionName(n)),this.emit("motionStart",t,e,o),this.state.shouldOverrideExpression()&&this.expressionManager&&this.expressionManager.resetExpression(),this.playing=!0,this._startMotion(s),!0):(o&&(SoundManager.dispose(o),this.currentAudio=void 0),!1)}))}startRandomMotion(t,e){return gp(this,null,(function*(){const r=this.definitions[t];if(null==r?void 0:r.length){const i=[];for(let e=0;e<r.length;e++)null===this.motionGroups[t][e]||this.state.isActive(t,e)||i.push(e);if(i.length){const r=Math.floor(Math.random()*i.length);return this.startMotion(t,i[r],e)}}return!1}))}stopAllMotions(){this._stopAllMotions(),this.state.reset(),this.currentAudio&&(SoundManager.dispose(this.currentAudio),this.currentAudio=void 0)}update(t,e){var r;return this.isFinished()&&(this.playing&&(this.playing=!1,this.emit("motionFinish")),this.state.shouldOverrideExpression()&&(null==(r=this.expressionManager)||r.restoreExpression()),this.state.complete(),this.state.shouldRequestIdleMotion()&&this.startRandomMotion(this.groups.idle,wp.IDLE)),this.updateParameters(t,e)}destroy(){var t;this.destroyed=!0,this.emit("destroy"),this.stopAllMotions(),null==(t=this.expressionManager)||t.destroy();this.definitions=void 0,this.motionGroups=void 0}}const Ip={x:0,y:0,width:0,height:0};class InternalModel extends $t{constructor(){super(...arguments),this.focusController=new FocusController,this.originalWidth=0,this.originalHeight=0,this.width=0,this.height=0,this.localTransform=new rs,this.drawingMatrix=new rs,this.hitAreas={},this.textureFlipY=!1,this.viewport=[0,0,0,0],this.destroyed=!1}init(){this.setupLayout(),this.setupHitAreas()}setupLayout(){const t=this,e=this.getSize();t.originalWidth=e[0],t.originalHeight=e[1];const r=Object.assign({width:2,height:2},this.getLayout());this.localTransform.scale(r.width/2,r.height/2),t.width=this.originalWidth*this.localTransform.a,t.height=this.originalHeight*this.localTransform.d;const i=void 0!==r.x&&r.x-r.width/2||void 0!==r.centerX&&r.centerX||void 0!==r.left&&r.left-r.width/2||void 0!==r.right&&r.right+r.width/2||0,n=void 0!==r.y&&r.y-r.height/2||void 0!==r.centerY&&r.centerY||void 0!==r.top&&r.top-r.height/2||void 0!==r.bottom&&r.bottom+r.height/2||0;this.localTransform.translate(this.width*i,-this.height*n)}setupHitAreas(){const t=this.getHitAreaDefs().filter((t=>t.index>=0));for(const e of t)this.hitAreas[e.name]=e}hitTest(t,e){return Object.keys(this.hitAreas).filter((r=>this.isHit(r,t,e)))}isHit(t,e,r){if(!this.hitAreas[t])return!1;const i=this.hitAreas[t].index,n=this.getDrawableBounds(i,Ip);return n.x<=e&&e<=n.x+n.width&&n.y<=r&&r<=n.y+n.height}getDrawableBounds(t,e){const r=this.getDrawableVertices(t);let i=r[0],n=r[0],o=r[1],s=r[1];for(let a=0;a<r.length;a+=2){const t=r[a],e=r[a+1];i=Math.min(t,i),n=Math.max(t,n),o=Math.min(e,o),s=Math.max(e,s)}return null!=e||(e={}),e.x=i,e.y=o,e.width=n-i,e.height=s-o,e}updateTransform(t){this.drawingMatrix.copyFrom(t).append(this.localTransform)}update(t,e){this.focusController.update(t)}destroy(){this.destroyed=!0,this.emit("destroy"),this.motionManager.destroy(),this.motionManager=void 0}}class NetworkError extends Error{constructor(t,e,r,i=!1){super(t),this.url=e,this.status=r,this.aborted=i}}const Cp=class{static createXHR(t,e,r,i,n){const o=new XMLHttpRequest;if(Cp.allXhrSet.add(o),t){let e=Cp.xhrMap.get(t);e?e.add(o):(e=new Set([o]),Cp.xhrMap.set(t,e)),t.listeners("destroy").includes(Cp.cancelXHRs)||t.once("destroy",Cp.cancelXHRs)}return o.open("GET",e),o.responseType=r,o.onload=()=>{200!==o.status&&0!==o.status||!o.response?o.onerror():i(o.response)},o.onerror=()=>{Tp.warn("XHRLoader",`Failed to load resource as ${o.responseType} (Status ${o.status}): ${e}`),n(new NetworkError("Network error.",e,o.status))},o.onabort=()=>n(new NetworkError("Aborted.",e,o.status,!0)),o.onloadend=()=>{var e;Cp.allXhrSet.delete(o),t&&(null==(e=Cp.xhrMap.get(t))||e.delete(o))},o}static cancelXHRs(){var t;null==(t=Cp.xhrMap.get(this))||t.forEach((t=>{t.abort(),Cp.allXhrSet.delete(t)})),Cp.xhrMap.delete(this)}static release(){Cp.allXhrSet.forEach((t=>t.abort())),Cp.allXhrSet.clear(),Cp.xhrMap=new WeakMap}};let Op=Cp;function Dp(t,e){let r=-1;return function i(n,o){if(o)return Promise.reject(o);if(n<=r)return Promise.reject(new Error("next() called multiple times"));r=n;const s=t[n];if(!s)return Promise.resolve();try{return Promise.resolve(s(e,i.bind(null,n+1)))}catch(a){return Promise.reject(a)}}(0)}Op.xhrMap=new WeakMap,Op.allXhrSet=new Set,Op.loader=(t,e)=>new Promise(((e,r)=>{Cp.createXHR(t.target,t.settings?t.settings.resolveURL(t.url):t.url,t.type,(r=>{t.result=r,e()}),r).send()}));class Live2DLoader{static load(t){return Dp(this.middlewares,t).then((()=>t.result))}}Live2DLoader.middlewares=[Op.loader];const Fp="Live2DFactory",Lp=(t,e)=>gp(void 0,null,(function*(){if("string"==typeof t.source){const e=yield Live2DLoader.load({url:t.source,type:"json",target:t.live2dModel});e.url=t.source,t.source=e,t.live2dModel.emit("settingsJSONLoaded",e)}return e()})),Bp=(t,e)=>gp(void 0,null,(function*(){if(t.source instanceof ModelSettings)return t.settings=t.source,e();if("object"==typeof t.source){const r=jp.findRuntime(t.source);if(r){const i=r.createModelSettings(t.source);return t.settings=i,t.live2dModel.emit("settingsLoaded",i),e()}}throw new TypeError("Unknown settings format.")})),Np=(t,e)=>{if(t.settings){const r=jp.findRuntime(t.settings);if(r)return r.ready().then(e)}return e()},Up=(t,e)=>gp(void 0,null,(function*(){yield e();const r=t.internalModel;if(r){const e=t.settings,i=jp.findRuntime(e);if(i){const n=[];e.pose&&n.push(Live2DLoader.load({settings:e,url:e.pose,type:"json",target:r}).then((e=>{r.pose=i.createPose(r.coreModel,e),t.live2dModel.emit("poseLoaded",r.pose)})).catch((e=>{t.live2dModel.emit("poseLoadError",e),Tp.warn(Fp,"Failed to load pose.",e)}))),e.physics&&n.push(Live2DLoader.load({settings:e,url:e.physics,type:"json",target:r}).then((e=>{r.physics=i.createPhysics(r.coreModel,e),t.live2dModel.emit("physicsLoaded",r.physics)})).catch((e=>{t.live2dModel.emit("physicsLoadError",e),Tp.warn(Fp,"Failed to load physics.",e)}))),n.length&&(yield Promise.all(n))}}})),Gp=(t,e)=>gp(void 0,null,(function*(){if(!t.settings)throw new TypeError("Missing settings.");{const r=t.live2dModel,i=t.settings.textures.map((e=>function(t,e={}){const r={resourceOptions:{crossorigin:e.crossOrigin}};if(ea.fromURL)return ea.fromURL(t,r).catch((t=>{if(t instanceof Error)throw t;const e=new Error("Texture loading error");throw e.event=t,e}));r.resourceOptions.autoLoad=!1;const i=ea.from(t,r);if(i.baseTexture.valid)return Promise.resolve(i);const n=i.baseTexture.resource;return null!=n._live2d_load||(n._live2d_load=new Promise(((t,e)=>{const r=t=>{n.source.removeEventListener("error",r);const i=new Error("Texture loading error");i.event=t,e(i)};n.source.addEventListener("error",r),n.load().then((()=>t(i))).catch(r)}))),n._live2d_load}(t.settings.resolveURL(e),{crossOrigin:t.options.crossOrigin})));if(yield e(),!t.internalModel)throw new TypeError("Missing internal model.");r.internalModel=t.internalModel,r.emit("modelLoaded",t.internalModel),r.textures=yield Promise.all(i),r.emit("textureLoaded",r.textures)}})),kp=(t,e)=>gp(void 0,null,(function*(){const r=t.settings;if(r instanceof ModelSettings){const i=jp.findRuntime(r);if(!i)throw new TypeError("Unknown model settings.");const n=yield Live2DLoader.load({settings:r,url:r.moc,type:"arraybuffer",target:t.live2dModel});if(!i.isValidMoc(n))throw new Error("Invalid moc data");const o=i.createCoreModel(n);return t.internalModel=i.createInternalModel(o,r,t.options),e()}throw new TypeError("Missing settings.")})),Xp=class{static registerRuntime(t){Xp.runtimes.push(t),Xp.runtimes.sort(((t,e)=>e.version-t.version))}static findRuntime(t){for(const e of Xp.runtimes)if(e.test(t))return e}static setupLive2DModel(t,e,r){return gp(this,null,(function*(){const i=new Promise((e=>t.once("textureLoaded",e))),n=new Promise((e=>t.once("modelLoaded",e))),o=Promise.all([i,n]).then((()=>t.emit("ready")));yield Dp(Xp.live2DModelMiddlewares,{live2dModel:t,source:e,options:r||{}}),yield o,t.emit("load")}))}static loadMotion(t,e,r){var i;const n=i=>t.emit("motionLoadError",e,r,i);try{const o=null==(i=t.definitions[e])?void 0:i[r];if(!o)return Promise.resolve(void 0);t.listeners("destroy").includes(Xp.releaseTasks)||t.once("destroy",Xp.releaseTasks);let s=Xp.motionTasksMap.get(t);s||(s={},Xp.motionTasksMap.set(t,s));let a=s[e];a||(a=[],s[e]=a);const h=t.getMotionFile(o);return null!=a[r]||(a[r]=Live2DLoader.load({url:h,settings:t.settings,type:t.motionDataType,target:t}).then((i=>{var n;const s=null==(n=Xp.motionTasksMap.get(t))?void 0:n[e];s&&delete s[r];const a=t.createMotion(i,e,o);return t.emit("motionLoaded",e,r,a),a})).catch((e=>{Tp.warn(t.tag,`Failed to load motion: ${h}\n`,e),n(e)}))),a[r]}catch(pm){Tp.warn(t.tag,`Failed to load motion at "${e}"[${r}]\n`,pm),n(pm)}return Promise.resolve(void 0)}static loadExpression(t,e){const r=r=>t.emit("expressionLoadError",e,r);try{const i=t.definitions[e];if(!i)return Promise.resolve(void 0);t.listeners("destroy").includes(Xp.releaseTasks)||t.once("destroy",Xp.releaseTasks);let n=Xp.expressionTasksMap.get(t);n||(n=[],Xp.expressionTasksMap.set(t,n));const o=t.getExpressionFile(i);return null!=n[e]||(n[e]=Live2DLoader.load({url:o,settings:t.settings,type:"json",target:t}).then((r=>{const n=Xp.expressionTasksMap.get(t);n&&delete n[e];const o=t.createExpression(r,i);return t.emit("expressionLoaded",e,o),o})).catch((e=>{Tp.warn(t.tag,`Failed to load expression: ${o}\n`,e),r(e)}))),n[e]}catch(pm){Tp.warn(t.tag,`Failed to load expression at [${e}]\n`,pm),r(pm)}return Promise.resolve(void 0)}static releaseTasks(){this instanceof MotionManager?Xp.motionTasksMap.delete(this):Xp.expressionTasksMap.delete(this)}};let jp=Xp;jp.runtimes=[],jp.urlToJSON=Lp,jp.jsonToSettings=Bp,jp.waitUntilReady=Np,jp.setupOptionals=Up,jp.setupEssentials=Gp,jp.createInternalModel=kp,jp.live2DModelMiddlewares=[Lp,Bp,Np,Up,Gp,kp],jp.motionTasksMap=new WeakMap,jp.expressionTasksMap=new WeakMap,MotionManager.prototype._loadMotion=function(t,e){return jp.loadMotion(this,t,e)},ExpressionManager.prototype._loadExpression=function(t){return jp.loadExpression(this,t)};function Vp(t){this.tap(t.data.global.x,t.data.global.y)}function Hp(t){this.focus(t.data.global.x,t.data.global.y)}class Live2DTransform extends cs{}const Yp=new qo,zp=new rs;let Wp;class Live2DModel extends ys{constructor(t){super(),this.tag="Live2DModel(uninitialized)",this.textures=[],this.transform=new Live2DTransform,this.anchor=new es(this.onAnchorChange,this,0,0),this.glContextID=-1,this.elapsedTime=performance.now(),this.deltaTime=0,this._autoUpdate=!1,this.once("modelLoaded",(()=>this.init(t)))}static from(t,e){const r=new this(e);return jp.setupLive2DModel(r,t,e).then((()=>r))}static fromSync(t,e){const r=new this(e);return jp.setupLive2DModel(r,t,e).then(null==e?void 0:e.onLoad).catch(null==e?void 0:e.onError),r}static registerTicker(t){Wp=t}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){var e;Wp||(Wp=null==(e=window.PIXI)?void 0:e.Ticker),t?this._destroyed||(Wp?(Wp.shared.add(this.onTickerUpdate,this),this._autoUpdate=!0):Tp.warn(this.tag,"No Ticker registered, please call Live2DModel.registerTicker(Ticker).")):(null==Wp||Wp.shared.remove(this.onTickerUpdate,this),this._autoUpdate=!1)}init(t){this.tag=`Live2DModel(${this.internalModel.settings.name})`;const e=Object.assign({autoUpdate:!0,autoInteract:!0},t);e.autoInteract&&(this.interactive=!0),this.autoInteract=e.autoInteract,this.autoUpdate=e.autoUpdate}onAnchorChange(){this.pivot.set(this.anchor.x*this.internalModel.width,this.anchor.y*this.internalModel.height)}motion(t,e,r){return void 0===e?this.internalModel.motionManager.startRandomMotion(t,r):this.internalModel.motionManager.startMotion(t,e,r)}expression(t){return this.internalModel.motionManager.expressionManager?void 0===t?this.internalModel.motionManager.expressionManager.setRandomExpression():this.internalModel.motionManager.expressionManager.setExpression(t):Promise.resolve(!1)}focus(t,e,r=!1){Yp.x=t,Yp.y=e,this.toModelPosition(Yp,Yp,!0);let i=Yp.x/this.internalModel.originalWidth*2-1,n=Yp.y/this.internalModel.originalHeight*2-1,o=Math.atan2(n,i);this.internalModel.focusController.focus(Math.cos(o),-Math.sin(o),r)}tap(t,e){const r=this.hitTest(t,e);r.length&&(Tp.log(this.tag,"Hit",r),this.emit("hit",r))}hitTest(t,e){return Yp.x=t,Yp.y=e,this.toModelPosition(Yp,Yp),this.internalModel.hitTest(Yp.x,Yp.y)}toModelPosition(t,e=t.clone(),r){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.transform.worldTransform.applyInverse(t,e),this.internalModel.localTransform.applyInverse(e,e),e}containsPoint(t){return this.getBounds(!0).contains(t.x,t.y)}_calculateBounds(){this._bounds.addFrame(this.transform,0,0,this.internalModel.width,this.internalModel.height)}onTickerUpdate(){this.update(Wp.shared.deltaMS)}update(t){this.deltaTime+=t,this.elapsedTime+=t}_render(t){this.registerInteraction(t.plugins.interaction),t.batch.reset(),t.geometry.reset(),t.shader.reset(),t.state.reset();let e=!1;this.glContextID!==t.CONTEXT_UID&&(this.glContextID=t.CONTEXT_UID,this.internalModel.updateWebGLContext(t.gl,this.glContextID),e=!0);for(let n=0;n<this.textures.length;n++){const r=this.textures[n];r.valid&&(!e&&r.baseTexture._glTextures[this.glContextID]||(t.gl.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,this.internalModel.textureFlipY),t.texture.bind(r.baseTexture,0)),this.internalModel.bindTexture(n,r.baseTexture._glTextures[this.glContextID].texture),r.baseTexture.touched=t.textureGC.count)}const r=t.framebuffer.viewport;this.internalModel.viewport=[r.x,r.y,r.width,r.height],this.deltaTime&&(this.internalModel.update(this.deltaTime,this.elapsedTime),this.deltaTime=0);const i=zp.copyFrom(t.globalUniforms.uniforms.projectionMatrix).append(this.worldTransform);this.internalModel.updateTransform(i),this.internalModel.draw(t.gl),t.state.reset(),t.texture.reset()}destroy(t){this.emit("destroy"),this.autoUpdate=!1,this.unregisterInteraction(),(null==t?void 0:t.texture)&&this.textures.forEach((e=>e.destroy(t.baseTexture))),this.internalModel.destroy(),super.destroy(t)}}Pp(Live2DModel,[class InteractionMixin{constructor(){this._autoInteract=!1}get autoInteract(){return this._autoInteract}set autoInteract(t){t!==this._autoInteract&&(t?this.on("pointertap",Vp,this):this.off("pointertap",Vp,this),this._autoInteract=t)}registerInteraction(t){t!==this.interactionManager&&(this.unregisterInteraction(),this._autoInteract&&t&&(this.interactionManager=t,t.on("pointermove",Hp,this)))}unregisterInteraction(){var t;this.interactionManager&&(null==(t=this.interactionManager)||t.off("pointermove",Hp,this),this.interactionManager=void 0)}}]);const qp=class{static resolveURL(t,e){var r;const i=null==(r=qp.filesMap[t])?void 0:r[e];if(void 0===i)throw new Error("Cannot find this file from uploaded files: "+e);return i}static upload(t,e){return gp(this,null,(function*(){const r={};for(const i of e.getDefinedFiles()){const n=decodeURI(ro.resolve(e.url,i)),o=t.find((t=>t.webkitRelativePath===n));o&&(r[i]=URL.createObjectURL(o))}qp.filesMap[e._objectURL]=r}))}static createSettings(t){return gp(this,null,(function*(){const e=t.find((t=>t.name.endsWith("model.json")||t.name.endsWith("model3.json")));if(!e)throw new TypeError("Settings file not found");const r=yield qp.readText(e),i=JSON.parse(r);i.url=e.webkitRelativePath;const n=jp.findRuntime(i);if(!n)throw new Error("Unknown settings JSON");const o=n.createModelSettings(i);return o._objectURL=URL.createObjectURL(e),o}))}static readText(t){return gp(this,null,(function*(){return new Promise(((e,r)=>{const i=new FileReader;i.onload=()=>e(i.result),i.onerror=r,i.readAsText(t,"utf8")}))}))}};let Kp=qp;Kp.filesMap={},Kp.factory=(t,e)=>gp(void 0,null,(function*(){if(Array.isArray(t.source)&&t.source[0]instanceof File){const e=t.source;let r=e.settings;if(r){if(!r._objectURL)throw new Error('"_objectURL" must be specified in ModelSettings')}else r=yield qp.createSettings(e);r.validateFiles(e.map((t=>encodeURI(t.webkitRelativePath)))),yield qp.upload(e,r),r.resolveURL=function(t){return qp.resolveURL(this._objectURL,t)},t.source=r,t.live2dModel.once("modelLoaded",(t=>{t.once("destroy",(function(){const t=this.settings._objectURL;if(URL.revokeObjectURL(t),qp.filesMap[t])for(const e of Object.values(qp.filesMap[t]))URL.revokeObjectURL(e);delete qp.filesMap[t]}))}))}return e()})),jp.live2DModelMiddlewares.unshift(Kp.factory);const Zp=class{static unzip(t,e){return gp(this,null,(function*(){const r=yield Zp.getFilePaths(t),i=[];for(const t of e.getDefinedFiles()){const n=decodeURI(ro.resolve(e.url,t));r.includes(n)&&i.push(n)}const n=yield Zp.getFiles(t,i);for(let t=0;t<n.length;t++){const e=i[t],r=n[t];Object.defineProperty(r,"webkitRelativePath",{value:e})}return n}))}static createSettings(t){return gp(this,null,(function*(){const e=(yield Zp.getFilePaths(t)).find((t=>t.endsWith("model.json")||t.endsWith("model3.json")));if(!e)throw new Error("Settings file not found");const r=yield Zp.readText(t,e);if(!r)throw new Error("Empty settings file: "+e);const i=JSON.parse(r);i.url=e;const n=jp.findRuntime(i);if(!n)throw new Error("Unknown settings JSON");return n.createModelSettings(i)}))}static zipReader(t,e){return gp(this,null,(function*(){throw new Error("Not implemented")}))}static getFilePaths(t){return gp(this,null,(function*(){throw new Error("Not implemented")}))}static getFiles(t,e){return gp(this,null,(function*(){throw new Error("Not implemented")}))}static readText(t,e){return gp(this,null,(function*(){throw new Error("Not implemented")}))}static releaseReader(t){}};let $p=Zp;if($p.ZIP_PROTOCOL="zip://",$p.uid=0,$p.factory=(t,e)=>gp(void 0,null,(function*(){const r=t.source;let i,n,o;if("string"==typeof r&&(r.endsWith(".zip")||r.startsWith(Zp.ZIP_PROTOCOL))?(i=r.startsWith(Zp.ZIP_PROTOCOL)?r.slice(Zp.ZIP_PROTOCOL.length):r,n=yield Live2DLoader.load({url:i,type:"blob",target:t.live2dModel})):Array.isArray(r)&&1===r.length&&r[0]instanceof File&&r[0].name.endsWith(".zip")&&(n=r[0],i=URL.createObjectURL(n),o=r.settings),n){if(!n.size)throw new Error("Empty zip file");const e=yield Zp.zipReader(n,i);o||(o=yield Zp.createSettings(e)),o._objectURL=Zp.ZIP_PROTOCOL+Zp.uid+"/"+o.url;const r=yield Zp.unzip(e,o);r.settings=o,t.source=r,i.startsWith("blob:")&&t.live2dModel.once("modelLoaded",(t=>{t.once("destroy",(function(){URL.revokeObjectURL(i)}))})),Zp.releaseReader(e)}return e()})),jp.live2DModelMiddlewares.unshift($p.factory),!window.Live2D)throw new Error("Could not find Cubism 2 runtime. This plugin requires live2d.min.js to be loaded.");const Jp=Live2DMotion.prototype.updateParam;Live2DMotion.prototype.updateParam=function(t,e){Jp.call(this,t,e),e.isFinished()&&this.onFinishHandler&&(this.onFinishHandler(this),delete this.onFinishHandler)};class Live2DExpression extends AMotion{constructor(t){super(),this.params=[],this.setFadeIn(t.fade_in>0?t.fade_in:bp.expressionFadingDuration),this.setFadeOut(t.fade_out>0?t.fade_out:bp.expressionFadingDuration),Array.isArray(t.params)&&t.params.forEach((t=>{const e=t.calc||"add";if("add"===e){const e=t.def||0;t.val-=e}else if("mult"===e){const e=t.def||1;t.val/=e}this.params.push({calc:e,val:t.val,id:t.id})}))}updateParamExe(t,e,r,i){this.params.forEach((e=>{t.setParamFloat(e.id,e.val*r)}))}}class Cubism2ExpressionManager extends ExpressionManager{constructor(t,e){var r;super(t,e),this.queueManager=new MotionQueueManager,this.definitions=null!=(r=this.settings.expressions)?r:[],this.init()}isFinished(){return this.queueManager.isFinished()}getExpressionIndex(t){return this.definitions.findIndex((e=>e.name===t))}getExpressionFile(t){return t.file}createExpression(t,e){return new Live2DExpression(t)}_setExpression(t){return this.queueManager.startMotion(t)}stopAllExpressions(){this.queueManager.stopAllMotions()}updateParameters(t,e){return this.queueManager.updateParam(t)}}class Cubism2MotionManager extends MotionManager{constructor(t,e){super(t,e),this.groups={idle:"idle"},this.motionDataType="arraybuffer",this.queueManager=new MotionQueueManager,this.definitions=this.settings.motions,this.init(e)}init(t){super.init(t),this.settings.expressions&&(this.expressionManager=new Cubism2ExpressionManager(this.settings,t))}isFinished(){return this.queueManager.isFinished()}createMotion(t,e,r){const i=Live2DMotion.loadMotion(t),n=e===this.groups.idle?bp.idleMotionFadingDuration:bp.motionFadingDuration;return i.setFadeIn(r.fade_in>0?r.fade_in:n),i.setFadeOut(r.fade_out>0?r.fade_out:n),i}getMotionFile(t){return t.file}getMotionName(t){return t.file}getSoundFile(t){return t.sound}_startMotion(t,e){return t.onFinishHandler=e,this.queueManager.stopAllMotions(),this.queueManager.startMotion(t)}_stopAllMotions(){this.queueManager.stopAllMotions()}updateParameters(t,e){return this.queueManager.updateParam(t)}destroy(){super.destroy(),this.queueManager=void 0}}class Live2DEyeBlink{constructor(t){this.coreModel=t,this.blinkInterval=4e3,this.closingDuration=100,this.closedDuration=50,this.openingDuration=150,this.eyeState=0,this.eyeParamValue=1,this.closedTimer=0,this.nextBlinkTimeLeft=this.blinkInterval,this.leftParam=t.getParamIndex("PARAM_EYE_L_OPEN"),this.rightParam=t.getParamIndex("PARAM_EYE_R_OPEN")}setEyeParams(t){this.eyeParamValue=Ep(t,0,1),this.coreModel.setParamFloat(this.leftParam,this.eyeParamValue),this.coreModel.setParamFloat(this.rightParam,this.eyeParamValue)}update(t){switch(this.eyeState){case 0:this.nextBlinkTimeLeft-=t,this.nextBlinkTimeLeft<0&&(this.eyeState=1,this.nextBlinkTimeLeft=this.blinkInterval+this.closingDuration+this.closedDuration+this.openingDuration+(e=0,r=2e3,Math.random()*(r-e)+e));break;case 1:this.setEyeParams(this.eyeParamValue+t/this.closingDuration),this.eyeParamValue<=0&&(this.eyeState=2,this.closedTimer=0);break;case 2:this.closedTimer+=t,this.closedTimer>=this.closedDuration&&(this.eyeState=3);break;case 3:this.setEyeParams(this.eyeParamValue+t/this.openingDuration),this.eyeParamValue>=1&&(this.eyeState=0)}var e,r}}const Qp=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Cubism2InternalModel extends InternalModel{constructor(t,e,r){super(),this.textureFlipY=!0,this.drawDataCount=0,this.disableCulling=!1,this.coreModel=t,this.settings=e,this.motionManager=new Cubism2MotionManager(e,r),this.eyeBlink=new Live2DEyeBlink(t),this.eyeballXParamIndex=t.getParamIndex("PARAM_EYE_BALL_X"),this.eyeballYParamIndex=t.getParamIndex("PARAM_EYE_BALL_Y"),this.angleXParamIndex=t.getParamIndex("PARAM_ANGLE_X"),this.angleYParamIndex=t.getParamIndex("PARAM_ANGLE_Y"),this.angleZParamIndex=t.getParamIndex("PARAM_ANGLE_Z"),this.bodyAngleXParamIndex=t.getParamIndex("PARAM_BODY_ANGLE_X"),this.breathParamIndex=t.getParamIndex("PARAM_BREATH"),this.init()}init(){super.init(),this.settings.initParams&&this.settings.initParams.forEach((({id:t,value:e})=>this.coreModel.setParamFloat(t,e))),this.settings.initOpacities&&this.settings.initOpacities.forEach((({id:t,value:e})=>this.coreModel.setPartsOpacity(t,e))),this.coreModel.saveParam();const t=this.coreModel.getModelContext()._$aS;(null==t?void 0:t.length)&&(this.drawDataCount=t.length);let e=this.coreModel.drawParamWebGL.culling;Object.defineProperty(this.coreModel.drawParamWebGL,"culling",{set:t=>e=t,get:()=>!this.disableCulling&&e});const r=this.coreModel.getModelContext().clipManager,i=r.setupClip;r.setupClip=(t,e)=>{i.call(r,t,e),e.gl.viewport(...this.viewport)}}getSize(){return[this.coreModel.getCanvasWidth(),this.coreModel.getCanvasHeight()]}getLayout(){const t={};if(this.settings.layout)for(const e of Object.keys(this.settings.layout)){let r=e;"center_x"===e?r="centerX":"center_y"===e&&(r="centerY"),t[r]=this.settings.layout[e]}return t}updateWebGLContext(t,e){const r=this.coreModel.drawParamWebGL;r.firstDraw=!0,r.setGL(t),r.glno=e;for(const o in r)r.hasOwnProperty(o)&&r[o]instanceof WebGLBuffer&&(r[o]=null);const i=this.coreModel.getModelContext().clipManager;i.curFrameNo=e;const n=t.getParameter(t.FRAMEBUFFER_BINDING);i.getMaskRenderTexture(),t.bindFramebuffer(t.FRAMEBUFFER,n)}bindTexture(t,e){this.coreModel.setTexture(t,e)}getHitAreaDefs(){var t;return(null==(t=this.settings.hitAreas)?void 0:t.map((t=>({id:t.id,name:t.name,index:this.coreModel.getDrawDataIndex(t.id)}))))||[]}getDrawableIDs(){const t=this.coreModel.getModelContext(),e=[];for(let r=0;r<this.drawDataCount;r++){const i=t.getDrawData(r);i&&e.push(i.getDrawDataID().id)}return e}getDrawableIndex(t){return this.coreModel.getDrawDataIndex(t)}getDrawableVertices(t){if("string"==typeof t&&-1===(t=this.coreModel.getDrawDataIndex(t)))throw new TypeError("Unable to find drawable ID: "+t);return this.coreModel.getTransformedPoints(t).slice()}update(t,e){var r,i,n,o;super.update(t,e);const s=this.coreModel;this.emit("beforeMotionUpdate");const a=this.motionManager.update(this.coreModel,e);this.emit("afterMotionUpdate"),s.saveParam(),null==(r=this.motionManager.expressionManager)||r.update(s,e),a||null==(i=this.eyeBlink)||i.update(t),this.updateFocus(),this.updateNaturalMovements(t,e),null==(n=this.physics)||n.update(e),null==(o=this.pose)||o.update(t),this.emit("beforeModelUpdate"),s.update(),s.loadParam()}updateFocus(){this.coreModel.addToParamFloat(this.eyeballXParamIndex,this.focusController.x),this.coreModel.addToParamFloat(this.eyeballYParamIndex,this.focusController.y),this.coreModel.addToParamFloat(this.angleXParamIndex,30*this.focusController.x),this.coreModel.addToParamFloat(this.angleYParamIndex,30*this.focusController.y),this.coreModel.addToParamFloat(this.angleZParamIndex,this.focusController.x*this.focusController.y*-30),this.coreModel.addToParamFloat(this.bodyAngleXParamIndex,10*this.focusController.x)}updateNaturalMovements(t,e){const r=e/1e3*2*Math.PI;this.coreModel.addToParamFloat(this.angleXParamIndex,15*Math.sin(r/6.5345)*.5),this.coreModel.addToParamFloat(this.angleYParamIndex,8*Math.sin(r/3.5345)*.5),this.coreModel.addToParamFloat(this.angleZParamIndex,10*Math.sin(r/5.5345)*.5),this.coreModel.addToParamFloat(this.bodyAngleXParamIndex,4*Math.sin(r/15.5345)*.5),this.coreModel.setParamFloat(this.breathParamIndex,.5+.5*Math.sin(r/3.2345))}draw(t){const e=this.disableCulling;t.getParameter(t.FRAMEBUFFER_BINDING)&&(this.disableCulling=!0);const r=this.drawingMatrix;Qp[0]=r.a,Qp[1]=r.b,Qp[4]=r.c,Qp[5]=r.d,Qp[12]=r.tx,Qp[13]=r.ty,this.coreModel.setMatrix(Qp),this.coreModel.draw(),this.disableCulling=e}destroy(){super.destroy(),this.coreModel=void 0}}class Cubism2ModelSettings extends ModelSettings{constructor(t){if(super(t),this.motions={},!Cubism2ModelSettings.isValidJSON(t))throw new TypeError("Invalid JSON.");this.moc=t.model,Mp("string",t,this,"textures","textures"),this.copy(t)}static isValidJSON(t){var e;return!!t&&"string"==typeof t.model&&(null==(e=t.textures)?void 0:e.length)>0&&t.textures.every((t=>"string"==typeof t))}copy(t){Sp("string",t,this,"name","name"),Sp("string",t,this,"pose","pose"),Sp("string",t,this,"physics","physics"),Sp("object",t,this,"layout","layout"),Sp("object",t,this,"motions","motions"),Mp("object",t,this,"hit_areas","hitAreas"),Mp("object",t,this,"expressions","expressions"),Mp("object",t,this,"init_params","initParams"),Mp("object",t,this,"init_opacities","initOpacities")}replaceFiles(t){super.replaceFiles(t);for(const[e,r]of Object.entries(this.motions))for(let i=0;i<r.length;i++)r[i].file=t(r[i].file,`motions.${e}[${i}].file`),void 0!==r[i].sound&&(r[i].sound=t(r[i].sound,`motions.${e}[${i}].sound`));if(this.expressions)for(let e=0;e<this.expressions.length;e++)this.expressions[e].file=t(this.expressions[e].file,`expressions[${e}].file`)}}const tf={x:PhysicsHair.Src.SRC_TO_X,y:PhysicsHair.Src.SRC_TO_Y,angle:PhysicsHair.Src.SRC_TO_G_ANGLE},ef={x:PhysicsHair.Src.SRC_TO_X,y:PhysicsHair.Src.SRC_TO_Y,angle:PhysicsHair.Src.SRC_TO_G_ANGLE};class Live2DPhysics{constructor(t,e){this.coreModel=t,this.physicsHairs=[],e.physics_hair&&(this.physicsHairs=e.physics_hair.map((t=>{const e=new PhysicsHair;return e.setup(t.setup.length,t.setup.regist,t.setup.mass),t.src.forEach((({id:t,ptype:r,scale:i,weight:n})=>{const o=tf[r];o&&e.addSrcParam(o,t,i,n)})),t.targets.forEach((({id:t,ptype:r,scale:i,weight:n})=>{const o=ef[r];o&&e.addTargetParam(o,t,i,n)})),e})))}update(t){this.physicsHairs.forEach((e=>e.update(this.coreModel,t)))}}class Live2DPartsParam{constructor(t){this.id=t,this.paramIndex=-1,this.partsIndex=-1,this.link=[]}initIndex(t){this.paramIndex=t.getParamIndex("VISIBLE:"+this.id),this.partsIndex=t.getPartsDataIndex(PartsDataID.getID(this.id)),t.setParamFloat(this.paramIndex,1)}}class Live2DPose{constructor(t,e){this.coreModel=t,this.opacityAnimDuration=500,this.partsGroups=[],e.parts_visible&&(this.partsGroups=e.parts_visible.map((({group:t})=>t.map((({id:t,link:e})=>{const r=new Live2DPartsParam(t);return e&&(r.link=e.map((t=>new Live2DPartsParam(t)))),r})))),this.init())}init(){this.partsGroups.forEach((t=>{t.forEach((t=>{if(t.initIndex(this.coreModel),t.paramIndex>=0){const e=0!==this.coreModel.getParamFloat(t.paramIndex);this.coreModel.setPartsOpacity(t.partsIndex,e?1:0),this.coreModel.setParamFloat(t.paramIndex,e?1:0),t.link.length>0&&t.link.forEach((t=>t.initIndex(this.coreModel)))}}))}))}normalizePartsOpacityGroup(t,e){const r=this.coreModel,i=.5;let n=1,o=t.findIndex((({paramIndex:t,partsIndex:e})=>e>=0&&0!==r.getParamFloat(t)));if(o>=0){const i=r.getPartsOpacity(t[o].partsIndex);n=Ep(i+e/this.opacityAnimDuration,0,1)}else o=0,n=1;t.forEach((({partsIndex:t},e)=>{if(t>=0)if(o==e)r.setPartsOpacity(t,n);else{let e,o=r.getPartsOpacity(t);e=n<i?-.5*n/i+1:(1-n)*i/.5,(1-e)*(1-n)>.15&&(e=1-.15/(1-n)),o>e&&(o=e),r.setPartsOpacity(t,o)}}))}copyOpacity(t){const e=this.coreModel;t.forEach((({partsIndex:t,link:r})=>{if(t>=0&&r){const i=e.getPartsOpacity(t);r.forEach((({partsIndex:t})=>{t>=0&&e.setPartsOpacity(t,i)}))}}))}update(t){this.partsGroups.forEach((e=>{this.normalizePartsOpacityGroup(e,t),this.copyOpacity(e)}))}}if(jp.registerRuntime({version:2,test:t=>t instanceof Cubism2ModelSettings||Cubism2ModelSettings.isValidJSON(t),ready:()=>Promise.resolve(),isValidMoc(t){if(t.byteLength<3)return!1;const e=new Int8Array(t,0,3);return"moc"===String.fromCharCode(...e)},createModelSettings:t=>new Cubism2ModelSettings(t),createCoreModel(t){const e=Live2DModelWebGL.loadModel(t),r=Live2D.getError();if(r)throw r;return e},createInternalModel:(t,e,r)=>new Cubism2InternalModel(t,e,r),createPose:(t,e)=>new Live2DPose(t,e),createPhysics:(t,e)=>new Live2DPhysics(t,e)}),!window.Live2DCubismCore)throw new Error("Could not find Cubism 4 runtime. This plugin requires live2dcubismcore.js to be loaded.");class CubismVector2{constructor(t,e){this.x=t||0,this.y=e||0}add(t){const e=new CubismVector2(0,0);return e.x=this.x+t.x,e.y=this.y+t.y,e}substract(t){const e=new CubismVector2(0,0);return e.x=this.x-t.x,e.y=this.y-t.y,e}multiply(t){const e=new CubismVector2(0,0);return e.x=this.x*t.x,e.y=this.y*t.y,e}multiplyByScaler(t){return this.multiply(new CubismVector2(t,t))}division(t){const e=new CubismVector2(0,0);return e.x=this.x/t.x,e.y=this.y/t.y,e}divisionByScalar(t){return this.division(new CubismVector2(t,t))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))}dot(t){return this.x*t.x+this.y*t.y}normalize(){const t=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/t,this.y=this.y/t}isEqual(t){return this.x==t.x&&this.y==t.y}isNotEqual(t){return!this.isEqual(t)}}const rf=class{static range(t,e,r){return t<e?t=e:t>r&&(t=r),t}static sin(t){return Math.sin(t)}static cos(t){return Math.cos(t)}static abs(t){return Math.abs(t)}static sqrt(t){return Math.sqrt(t)}static cbrt(t){if(0===t)return t;let e=t;const r=e<0;let i;return r&&(e=-e),e===1/0?i=1/0:(i=Math.exp(Math.log(e)/3),i=(e/(i*i)+2*i)/3),r?-i:i}static getEasingSine(t){return t<0?0:t>1?1:.5-.5*this.cos(t*Math.PI)}static max(t,e){return t>e?t:e}static min(t,e){return t>e?e:t}static degreesToRadian(t){return t/180*Math.PI}static radianToDegrees(t){return 180*t/Math.PI}static directionToRadian(t,e){let r=Math.atan2(e.y,e.x)-Math.atan2(t.y,t.x);for(;r<-Math.PI;)r+=2*Math.PI;for(;r>Math.PI;)r-=2*Math.PI;return r}static directionToDegrees(t,e){const r=this.directionToRadian(t,e);let i=this.radianToDegrees(r);return e.x-t.x>0&&(i=-i),i}static radianToDirection(t){const e=new CubismVector2;return e.x=this.sin(t),e.y=this.cos(t),e}static quadraticEquation(t,e,r){return this.abs(t)<rf.Epsilon?this.abs(e)<rf.Epsilon?-r:-r/e:-(e+this.sqrt(e*e-4*t*r))/(2*t)}static cardanoAlgorithmForBezier(t,e,r,i){if(this.sqrt(t)<rf.Epsilon)return this.range(this.quadraticEquation(e,r,i),0,1);const n=e/t,o=r/t,s=(3*o-n*n)/3,a=s/3,h=(2*n*n*n-9*n*o+27*(i/t))/27,u=h/2,l=u*u+a*a*a,c=.5,d=.51;if(l<0){const t=-s/3,e=t*t*t,r=this.sqrt(e),i=-h/(2*r),o=this.range(i,-1,1),a=Math.acos(o),u=2*this.cbrt(r),l=u*this.cos(a/3)-n/3;if(this.abs(l-c)<d)return this.range(l,0,1);const p=u*this.cos((a+2*Math.PI)/3)-n/3;if(this.abs(p-c)<d)return this.range(p,0,1);const f=u*this.cos((a+4*Math.PI)/3)-n/3;return this.range(f,0,1)}if(0==l){let t;t=u<0?this.cbrt(-u):-this.cbrt(u);const e=2*t-n/3;if(this.abs(e-c)<d)return this.range(e,0,1);const r=-t-n/3;return this.range(r,0,1)}const p=this.sqrt(l),f=this.cbrt(p-u)-this.cbrt(p+u)-n/3;return this.range(f,0,1)}constructor(){}};let nf=rf;nf.Epsilon=1e-5;class CubismMatrix44{constructor(){this._tr=new Float32Array(16),this.loadIdentity()}static multiply(t,e,r){const i=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);for(let n=0;n<4;++n)for(let r=0;r<4;++r)for(let o=0;o<4;++o)i[r+4*n]+=t[o+4*n]*e[r+4*o];for(let n=0;n<16;++n)r[n]=i[n]}loadIdentity(){const t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(t)}setMatrix(t){for(let e=0;e<16;++e)this._tr[e]=t[e]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(t){return this._tr[0]*t+this._tr[12]}transformY(t){return this._tr[5]*t+this._tr[13]}invertTransformX(t){return(t-this._tr[12])/this._tr[0]}invertTransformY(t){return(t-this._tr[13])/this._tr[5]}translateRelative(t,e){const r=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1]);CubismMatrix44.multiply(r,this._tr,this._tr)}translate(t,e){this._tr[12]=t,this._tr[13]=e}translateX(t){this._tr[12]=t}translateY(t){this._tr[13]=t}scaleRelative(t,e){const r=new Float32Array([t,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1]);CubismMatrix44.multiply(r,this._tr,this._tr)}scale(t,e){this._tr[0]=t,this._tr[5]=e}multiplyByMatrix(t){CubismMatrix44.multiply(t.getArray(),this._tr,this._tr)}clone(){const t=new CubismMatrix44;for(let e=0;e<this._tr.length;e++)t._tr[e]=this._tr[e];return t}}class CubismRenderer{initialize(t){this._model=t}drawModel(){null!=this.getModel()&&this.doDrawModel()}setMvpMatrix(t){this._mvpMatrix4x4.setMatrix(t.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(t,e,r,i){t<0?t=0:t>1&&(t=1),e<0?e=0:e>1&&(e=1),r<0?r=0:r>1&&(r=1),i<0?i=0:i>1&&(i=1),this._modelColor.R=t,this._modelColor.G=e,this._modelColor.B=r,this._modelColor.A=i}getModelColor(){return Object.assign({},this._modelColor)}setIsPremultipliedAlpha(t){this._isPremultipliedAlpha=t}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(t){this._isCulling=t}isCulling(){return this._isCulling}setAnisotropy(t){this._anisortopy=t}getAnisotropy(){return this._anisortopy}getModel(){return this._model}constructor(){this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisortopy=0,this._modelColor=new CubismTextureColor,this._mvpMatrix4x4=new CubismMatrix44,this._mvpMatrix4x4.loadIdentity()}}var of=(t=>(t[t.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",t[t.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",t[t.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative",t))(of||{});class CubismTextureColor{constructor(){this.R=1,this.G=1,this.B=1,this.A=1}}let sf,af=!1,hf=!1;const uf=0,lf=2;class CubismFramework{static startUp(t){if(af)return pf("CubismFramework.startUp() is already done."),af;if(Live2DCubismCore._isStarted)return af=!0,!0;if(Live2DCubismCore._isStarted=!0,sf=t,sf&&Live2DCubismCore.Logging.csmSetLogFunction(sf.logFunction),af=!0,af){const t=Live2DCubismCore.Version.csmGetVersion(),e=(16711680&t)>>16,r=65535&t,i=t;pf("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+((4278190080&t)>>24)).slice(-2),("00"+e).slice(-2),("0000"+r).slice(-4),i)}return pf("CubismFramework.startUp() is complete."),af}static cleanUp(){af=!1,hf=!1,sf=void 0}static initialize(){af?hf?ff("CubismFramework.initialize() skipped, already initialized."):(hf=!0,pf("CubismFramework.initialize() is complete.")):ff("CubismFramework is not started.")}static dispose(){af?hf?(CubismRenderer.staticRelease(),hf=!1,pf("CubismFramework.dispose() is complete.")):ff("CubismFramework.dispose() skipped, not initialized."):ff("CubismFramework is not started.")}static isStarted(){return af}static isInitialized(){return hf}static coreLogFunction(t){Live2DCubismCore.Logging.csmGetLogFunction()&&Live2DCubismCore.Logging.csmGetLogFunction()(t)}static getLoggingLevel(){return null!=sf?sf.loggingLevel:cf.LogLevel_Off}constructor(){}}var cf=(t=>(t[t.LogLevel_Verbose=0]="LogLevel_Verbose",t[t.LogLevel_Debug=1]="LogLevel_Debug",t[t.LogLevel_Info=2]="LogLevel_Info",t[t.LogLevel_Warning=3]="LogLevel_Warning",t[t.LogLevel_Error=4]="LogLevel_Error",t[t.LogLevel_Off=5]="LogLevel_Off",t))(cf||{});function df(t,...e){CubismDebug.print(cf.LogLevel_Debug,"[CSM][D]"+t+"\n",e)}function pf(t,...e){CubismDebug.print(cf.LogLevel_Info,"[CSM][I]"+t+"\n",e)}function ff(t,...e){CubismDebug.print(cf.LogLevel_Warning,"[CSM][W]"+t+"\n",e)}function mf(t,...e){CubismDebug.print(cf.LogLevel_Error,"[CSM][E]"+t+"\n",e)}class CubismDebug{static print(t,e,r){if(t<CubismFramework.getLoggingLevel())return;const i=CubismFramework.coreLogFunction;if(!i)return;i(e.replace(/{(\d+)}/g,((t,e)=>r[e])))}static dumpBytes(t,e,r){for(let i=0;i<r;i++)i%16==0&&i>0?this.print(t,"\n"):i%8==0&&i>0&&this.print(t,"  "),this.print(t,"{0} ",[255&e[i]]);this.print(t,"\n")}constructor(){}}class ACubismMotion{constructor(){this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._firedEventValues=[]}release(){this._weight=0}updateParameters(t,e,r){if(!e.isAvailable()||e.isFinished())return;if(!e.isStarted()){e.setIsStarted(!0),e.setStartTime(r-this._offsetSeconds),e.setFadeInStartTime(r);const t=this.getDuration();e.getEndTime()<0&&e.setEndTime(t<=0?-1:e.getStartTime()+t)}let i=this._weight;i=i*(0==this._fadeInSeconds?1:nf.getEasingSine((r-e.getFadeInStartTime())/this._fadeInSeconds))*(0==this._fadeOutSeconds||e.getEndTime()<0?1:nf.getEasingSine((e.getEndTime()-r)/this._fadeOutSeconds)),e.setState(r,i),this.doUpdateParameters(t,r,i,e),e.getEndTime()>0&&e.getEndTime()<r&&e.setIsFinished(!0)}setFadeInTime(t){this._fadeInSeconds=t}setFadeOutTime(t){this._fadeOutSeconds=t}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(t){this._weight=t}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(t){this._offsetSeconds=t}getFiredEvent(t,e){return this._firedEventValues}setFinishedMotionHandler(t){this._onFinishedMotion=t}getFinishedMotionHandler(){return this._onFinishedMotion}}class CubismExpressionMotion extends ACubismMotion{constructor(){super(),this._parameters=[]}static create(t){const e=new CubismExpressionMotion,r=t.FadeInTime,i=t.FadeOutTime;e.setFadeInTime(void 0!==r?r:1),e.setFadeOutTime(void 0!==i?i:1);const n=t.Parameters||[];for(let o=0;o<n.length;++o){const t=n[o],r=t.Id,i=t.Value;let s;switch(t.Blend){case"Multiply":s=_f.ExpressionBlendType_Multiply;break;case"Overwrite":s=_f.ExpressionBlendType_Overwrite;break;default:s=_f.ExpressionBlendType_Add}const a={parameterId:r,blendType:s,value:i};e._parameters.push(a)}return e}doUpdateParameters(t,e,r,i){for(let n=0;n<this._parameters.length;++n){const e=this._parameters[n];switch(e.blendType){case _f.ExpressionBlendType_Add:t.addParameterValueById(e.parameterId,e.value,r);break;case _f.ExpressionBlendType_Multiply:t.multiplyParameterValueById(e.parameterId,e.value,r);break;case _f.ExpressionBlendType_Overwrite:t.setParameterValueById(e.parameterId,e.value,r)}}}}var _f=(t=>(t[t.ExpressionBlendType_Add=0]="ExpressionBlendType_Add",t[t.ExpressionBlendType_Multiply=1]="ExpressionBlendType_Multiply",t[t.ExpressionBlendType_Overwrite=2]="ExpressionBlendType_Overwrite",t))(_f||{});class CubismMotionQueueEntry{constructor(){this._autoDelete=!1,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&this._motion.release()}setFadeOut(t){this._fadeOutSeconds=t,this._isTriggeredFadeOut=!0}startFadeOut(t,e){const r=e+t;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||r<this._endTimeSeconds)&&(this._endTimeSeconds=r)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(t){this._startTimeSeconds=t}setFadeInStartTime(t){this._fadeInStartTimeSeconds=t}setEndTime(t){this._endTimeSeconds=t}setIsFinished(t){this._finished=t}setIsStarted(t){this._started=t}isAvailable(){return this._available}setIsAvailable(t){this._available=t}setState(t,e){this._stateTimeSeconds=t,this._stateWeight=e}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(t){this._lastEventCheckSeconds=t}isTriggeredFadeOut(){return this._isTriggeredFadeOut}getFadeOutSeconds(){return this._fadeOutSeconds}}class CubismMotionQueueManager{constructor(){this._userTimeSeconds=0,this._eventCustomData=null,this._motions=[]}release(){for(let t=0;t<this._motions.length;++t)this._motions[t]&&this._motions[t].release();this._motions=void 0}startMotion(t,e,r){if(null==t)return gf;let i;for(let n=0;n<this._motions.length;++n)i=this._motions[n],null!=i&&i.setFadeOut(i._motion.getFadeOutTime());return i=new CubismMotionQueueEntry,i._autoDelete=e,i._motion=t,this._motions.push(i),i._motionQueueEntryHandle}isFinished(){let t=0;for(;t<this._motions.length;){const e=this._motions[t];if(null==e){this._motions.splice(t,1);continue}if(null!=e._motion){if(!e.isFinished())return!1;t++}else e.release(),this._motions.splice(t,1)}return!0}isFinishedByHandle(t){for(let e=0;e<this._motions.length;e++){const r=this._motions[e];if(null!=r&&(r._motionQueueEntryHandle==t&&!r.isFinished()))return!1}return!0}stopAllMotions(){for(let t=0;t<this._motions.length;t++){const e=this._motions[t];null!=e&&e.release()}this._motions=[]}getCubismMotionQueueEntry(t){return this._motions.find((e=>null!=e&&e._motionQueueEntryHandle==t))}setEventCallback(t,e=null){this._eventCallBack=t,this._eventCustomData=e}doUpdateMotion(t,e){let r=!1,i=0;for(;i<this._motions.length;){const n=this._motions[i];if(null==n){this._motions.splice(i,1);continue}const o=n._motion;if(null==o){n.release(),this._motions.splice(i,1);continue}o.updateParameters(t,n,e),r=!0;const s=o.getFiredEvent(n.getLastCheckEventSeconds()-n.getStartTime(),e-n.getStartTime());for(let t=0;t<s.length;++t)this._eventCallBack(this,s[t],this._eventCustomData);n.setLastCheckEventSeconds(e),n.isFinished()?(n.release(),this._motions.splice(i,1)):(n.isTriggeredFadeOut()&&n.startFadeOut(n.getFadeOutSeconds(),e),i++)}return r}}const gf=-1;class Cubism4ExpressionManager extends ExpressionManager{constructor(t,e){var r;super(t,e),this.queueManager=new CubismMotionQueueManager,this.definitions=null!=(r=t.expressions)?r:[],this.init()}isFinished(){return this.queueManager.isFinished()}getExpressionIndex(t){return this.definitions.findIndex((e=>e.Name===t))}getExpressionFile(t){return t.File}createExpression(t,e){return CubismExpressionMotion.create(t)}_setExpression(t){return this.queueManager.startMotion(t,!1,performance.now())}stopAllExpressions(){this.queueManager.stopAllMotions()}updateParameters(t,e){return this.queueManager.doUpdateMotion(t,e)}}class CubismModelSettingsJson{constructor(t){this.groups=t.Groups,this.hitAreas=t.HitAreas,this.layout=t.Layout,this.moc=t.FileReferences.Moc,this.expressions=t.FileReferences.Expressions,this.motions=t.FileReferences.Motions,this.textures=t.FileReferences.Textures,this.physics=t.FileReferences.Physics,this.pose=t.FileReferences.Pose}getEyeBlinkParameters(){var t,e;return null==(e=null==(t=this.groups)?void 0:t.find((t=>"EyeBlink"===t.Name)))?void 0:e.Ids}getLipSyncParameters(){var t,e;return null==(e=null==(t=this.groups)?void 0:t.find((t=>"LipSync"===t.Name)))?void 0:e.Ids}}class Cubism4ModelSettings extends ModelSettings{constructor(t){if(super(t),!Cubism4ModelSettings.isValidJSON(t))throw new TypeError("Invalid JSON.");Object.assign(this,new CubismModelSettingsJson(t))}static isValidJSON(t){var e;return!!(null==t?void 0:t.FileReferences)&&"string"==typeof t.FileReferences.Moc&&(null==(e=t.FileReferences.Textures)?void 0:e.length)>0&&t.FileReferences.Textures.every((t=>"string"==typeof t))}replaceFiles(t){if(super.replaceFiles(t),this.motions)for(const[e,r]of Object.entries(this.motions))for(let i=0;i<r.length;i++)r[i].File=t(r[i].File,`motions.${e}[${i}].File`),void 0!==r[i].Sound&&(r[i].Sound=t(r[i].Sound,`motions.${e}[${i}].Sound`));if(this.expressions)for(let e=0;e<this.expressions.length;e++)this.expressions[e].File=t(this.expressions[e].File,`expressions[${e}].File`)}}Pp(Cubism4ModelSettings,[CubismModelSettingsJson]);var yf=(t=>(t[t.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",t[t.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",t[t.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity",t))(yf||{}),vf=(t=>(t[t.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",t[t.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",t[t.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",t[t.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped",t))(vf||{});class CubismMotionPoint{constructor(t=0,e=0){this.time=t,this.value=e}}class CubismMotionSegment{constructor(){this.basePointIndex=0,this.segmentType=0}}class CubismMotionCurve{constructor(){this.id="",this.type=0,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}}class CubismMotionEvent{constructor(){this.fireTime=0,this.value=""}}class CubismMotionData{constructor(){this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=[],this.segments=[],this.points=[],this.events=[]}}class CubismMotionJson{constructor(t){this._json=t}release(){this._json=void 0}getMotionDuration(){return this._json.Meta.Duration}isMotionLoop(){return this._json.Meta.Loop||!1}getEvaluationOptionFlag(t){return bf.EvaluationOptionFlag_AreBeziersRistricted==t&&!!this._json.Meta.AreBeziersRestricted}getMotionCurveCount(){return this._json.Meta.CurveCount}getMotionFps(){return this._json.Meta.Fps}getMotionTotalSegmentCount(){return this._json.Meta.TotalSegmentCount}getMotionTotalPointCount(){return this._json.Meta.TotalPointCount}getMotionFadeInTime(){return this._json.Meta.FadeInTime}getMotionFadeOutTime(){return this._json.Meta.FadeOutTime}getMotionCurveTarget(t){return this._json.Curves[t].Target}getMotionCurveId(t){return this._json.Curves[t].Id}getMotionCurveFadeInTime(t){return this._json.Curves[t].FadeInTime}getMotionCurveFadeOutTime(t){return this._json.Curves[t].FadeOutTime}getMotionCurveSegmentCount(t){return this._json.Curves[t].Segments.length}getMotionCurveSegment(t,e){return this._json.Curves[t].Segments[e]}getEventCount(){return this._json.Meta.UserDataCount||0}getTotalEventValueSize(){return this._json.Meta.TotalUserDataSize}getEventTime(t){return this._json.UserData[t].Time}getEventValue(t){return this._json.UserData[t].Value}}var bf=(t=>(t[t.EvaluationOptionFlag_AreBeziersRistricted=0]="EvaluationOptionFlag_AreBeziersRistricted",t))(bf||{});function xf(t,e,r){const i=new CubismMotionPoint;return i.time=t.time+(e.time-t.time)*r,i.value=t.value+(e.value-t.value)*r,i}function Tf(t,e){let r=(e-t[0].time)/(t[1].time-t[0].time);return r<0&&(r=0),t[0].value+(t[1].value-t[0].value)*r}function Ef(t,e){let r=(e-t[0].time)/(t[3].time-t[0].time);r<0&&(r=0);const i=xf(t[0],t[1],r),n=xf(t[1],t[2],r),o=xf(t[2],t[3],r),s=xf(i,n,r),a=xf(n,o,r);return xf(s,a,r).value}function Sf(t,e){const r=e,i=t[0].time,n=t[3].time,o=t[1].time,s=t[2].time,a=n-3*s+3*o-i,h=3*s-6*o+3*i,u=3*o-3*i,l=i-r,c=nf.cardanoAlgorithmForBezier(a,h,u,l),d=xf(t[0],t[1],c),p=xf(t[1],t[2],c),f=xf(t[2],t[3],c),m=xf(d,p,c),_=xf(p,f,c);return xf(m,_,c).value}function Mf(t,e){return t[0].value}function Pf(t,e){return t[1].value}function Af(t,e,r){const i=t.curves[e];let n=-1;const o=i.baseSegmentIndex+i.segmentCount;let s=0;for(let h=i.baseSegmentIndex;h<o;++h)if(s=t.segments[h].basePointIndex+(t.segments[h].segmentType==vf.CubismMotionSegmentType_Bezier?3:1),t.points[s].time>r){n=h;break}if(-1==n)return t.points[s].value;const a=t.segments[n];return a.evaluate(t.points.slice(a.basePointIndex),r)}class CubismMotion extends ACubismMotion{constructor(){super(),this._eyeBlinkParameterIds=[],this._lipSyncParameterIds=[],this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0}static create(t,e){const r=new CubismMotion;return r.parse(t),r._sourceFrameRate=r._motionData.fps,r._loopDurationSeconds=r._motionData.duration,r._onFinishedMotion=e,r}doUpdateParameters(t,e,r,i){null==this._modelCurveIdEyeBlink&&(this._modelCurveIdEyeBlink="EyeBlink"),null==this._modelCurveIdLipSync&&(this._modelCurveIdLipSync="LipSync");let n=e-i.getStartTime();n<0&&(n=0);let o=Number.MAX_VALUE,s=Number.MAX_VALUE;const a=64;let h=0,u=0;this._eyeBlinkParameterIds.length>a&&df("too many eye blink targets : {0}",this._eyeBlinkParameterIds.length),this._lipSyncParameterIds.length>a&&df("too many lip sync targets : {0}",this._lipSyncParameterIds.length);const l=this._fadeInSeconds<=0?1:nf.getEasingSine((e-i.getFadeInStartTime())/this._fadeInSeconds),c=this._fadeOutSeconds<=0||i.getEndTime()<0?1:nf.getEasingSine((i.getEndTime()-e)/this._fadeOutSeconds);let d,p,f,m=n;if(this._isLoop)for(;m>this._motionData.duration;)m-=this._motionData.duration;const _=this._motionData.curves;for(p=0;p<this._motionData.curveCount&&_[p].type==yf.CubismMotionCurveTarget_Model;++p)d=Af(this._motionData,p,m),_[p].id==this._modelCurveIdEyeBlink?s=d:_[p].id==this._modelCurveIdLipSync&&(o=d);for(;p<this._motionData.curveCount&&_[p].type==yf.CubismMotionCurveTarget_Parameter;++p){if(f=t.getParameterIndex(_[p].id),-1==f)continue;const n=t.getParameterValueByIndex(f);if(d=Af(this._motionData,p,m),s!=Number.MAX_VALUE)for(let t=0;t<this._eyeBlinkParameterIds.length&&t<a;++t)if(this._eyeBlinkParameterIds[t]==_[p].id){d*=s,u|=1<<t;break}if(o!=Number.MAX_VALUE)for(let t=0;t<this._lipSyncParameterIds.length&&t<a;++t)if(this._lipSyncParameterIds[t]==_[p].id){d+=o,h|=1<<t;break}let g;if(_[p].fadeInTime<0&&_[p].fadeOutTime<0)g=n+(d-n)*r;else{let t,r;t=_[p].fadeInTime<0?l:0==_[p].fadeInTime?1:nf.getEasingSine((e-i.getFadeInStartTime())/_[p].fadeInTime),r=_[p].fadeOutTime<0?c:0==_[p].fadeOutTime||i.getEndTime()<0?1:nf.getEasingSine((i.getEndTime()-e)/_[p].fadeOutTime);g=n+(d-n)*(this._weight*t*r)}t.setParameterValueByIndex(f,g,1)}if(s!=Number.MAX_VALUE)for(let g=0;g<this._eyeBlinkParameterIds.length&&g<a;++g){const e=t.getParameterValueById(this._eyeBlinkParameterIds[g]);if(u>>g&1)continue;const i=e+(s-e)*r;t.setParameterValueById(this._eyeBlinkParameterIds[g],i)}if(o!=Number.MAX_VALUE)for(let g=0;g<this._lipSyncParameterIds.length&&g<a;++g){const e=t.getParameterValueById(this._lipSyncParameterIds[g]);if(h>>g&1)continue;const i=e+(o-e)*r;t.setParameterValueById(this._lipSyncParameterIds[g],i)}for(;p<this._motionData.curveCount&&_[p].type==yf.CubismMotionCurveTarget_PartOpacity;++p)if(d=Af(this._motionData,p,m),yp.setOpacityFromMotion)t.setPartOpacityById(_[p].id,d);else{if(f=t.getParameterIndex(_[p].id),-1==f)continue;t.setParameterValueByIndex(f,d)}n>=this._motionData.duration&&(this._isLoop?(i.setStartTime(e),this._isLoopFadeIn&&i.setFadeInStartTime(e)):(this._onFinishedMotion&&this._onFinishedMotion(this),i.setIsFinished(!0))),this._lastWeight=r}setIsLoop(t){this._isLoop=t}isLoop(){return this._isLoop}setIsLoopFadeIn(t){this._isLoopFadeIn=t}isLoopFadeIn(){return this._isLoopFadeIn}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(t,e){const r=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(t==r[i].id)return void(r[i].fadeInTime=e)}setParameterFadeOutTime(t,e){const r=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(t==r[i].id)return void(r[i].fadeOutTime=e)}getParameterFadeInTime(t){const e=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(t==e[r].id)return e[r].fadeInTime;return-1}getParameterFadeOutTime(t){const e=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(t==e[r].id)return e[r].fadeOutTime;return-1}setEffectIds(t,e){this._eyeBlinkParameterIds=t,this._lipSyncParameterIds=e}release(){this._motionData=void 0}parse(t){this._motionData=new CubismMotionData;let e=new CubismMotionJson(t);this._motionData.duration=e.getMotionDuration(),this._motionData.loop=e.isMotionLoop(),this._motionData.curveCount=e.getMotionCurveCount(),this._motionData.fps=e.getMotionFps(),this._motionData.eventCount=e.getEventCount();const r=e.getEvaluationOptionFlag(bf.EvaluationOptionFlag_AreBeziersRistricted),i=e.getMotionFadeInTime(),n=e.getMotionFadeOutTime();this._fadeInSeconds=void 0!==i?i<0?1:i:1,this._fadeOutSeconds=void 0!==n?n<0?1:n:1,this._motionData.curves=Array.from({length:this._motionData.curveCount}).map((()=>new CubismMotionCurve)),this._motionData.segments=Array.from({length:e.getMotionTotalSegmentCount()}).map((()=>new CubismMotionSegment)),this._motionData.events=Array.from({length:this._motionData.eventCount}).map((()=>new CubismMotionEvent)),this._motionData.points=[];let o=0,s=0;for(let a=0;a<this._motionData.curveCount;++a){const t=this._motionData.curves[a];switch(e.getMotionCurveTarget(a)){case"Model":t.type=yf.CubismMotionCurveTarget_Model;break;case"Parameter":t.type=yf.CubismMotionCurveTarget_Parameter;break;case"PartOpacity":t.type=yf.CubismMotionCurveTarget_PartOpacity;break;default:ff('Warning : Unable to get segment type from Curve! The number of "CurveCount" may be incorrect!')}t.id=e.getMotionCurveId(a),t.baseSegmentIndex=s;const i=e.getMotionCurveFadeInTime(a),n=e.getMotionCurveFadeOutTime(a);t.fadeInTime=void 0!==i?i:-1,t.fadeOutTime=void 0!==n?n:-1;for(let h=0;h<e.getMotionCurveSegmentCount(a);){0==h?(this._motionData.segments[s].basePointIndex=o,this._motionData.points[o]=new CubismMotionPoint(e.getMotionCurveSegment(a,h),e.getMotionCurveSegment(a,h+1)),o+=1,h+=2):this._motionData.segments[s].basePointIndex=o-1;switch(e.getMotionCurveSegment(a,h)){case vf.CubismMotionSegmentType_Linear:this._motionData.segments[s].segmentType=vf.CubismMotionSegmentType_Linear,this._motionData.segments[s].evaluate=Tf,this._motionData.points[o]=new CubismMotionPoint(e.getMotionCurveSegment(a,h+1),e.getMotionCurveSegment(a,h+2)),o+=1,h+=3;break;case vf.CubismMotionSegmentType_Bezier:this._motionData.segments[s].segmentType=vf.CubismMotionSegmentType_Bezier,this._motionData.segments[s].evaluate=r?Ef:Sf,this._motionData.points[o]=new CubismMotionPoint(e.getMotionCurveSegment(a,h+1),e.getMotionCurveSegment(a,h+2)),this._motionData.points[o+1]=new CubismMotionPoint(e.getMotionCurveSegment(a,h+3),e.getMotionCurveSegment(a,h+4)),this._motionData.points[o+2]=new CubismMotionPoint(e.getMotionCurveSegment(a,h+5),e.getMotionCurveSegment(a,h+6)),o+=3,h+=7;break;case vf.CubismMotionSegmentType_Stepped:this._motionData.segments[s].segmentType=vf.CubismMotionSegmentType_Stepped,this._motionData.segments[s].evaluate=Mf,this._motionData.points[o]=new CubismMotionPoint(e.getMotionCurveSegment(a,h+1),e.getMotionCurveSegment(a,h+2)),o+=1,h+=3;break;case vf.CubismMotionSegmentType_InverseStepped:this._motionData.segments[s].segmentType=vf.CubismMotionSegmentType_InverseStepped,this._motionData.segments[s].evaluate=Pf,this._motionData.points[o]=new CubismMotionPoint(e.getMotionCurveSegment(a,h+1),e.getMotionCurveSegment(a,h+2)),o+=1,h+=3}++t.segmentCount,++s}this._motionData.curves.push(t)}for(let a=0;a<e.getEventCount();++a)this._motionData.events[a].fireTime=e.getEventTime(a),this._motionData.events[a].value=e.getEventValue(a);e.release()}getFiredEvent(t,e){this._firedEventValues.length=0;for(let r=0;r<this._motionData.eventCount;++r)this._motionData.events[r].fireTime>t&&this._motionData.events[r].fireTime<=e&&this._firedEventValues.push(this._motionData.events[r].value);return this._firedEventValues}}class Cubism4MotionManager extends MotionManager{constructor(t,e){var r;super(t,e),this.groups={idle:"Idle"},this.motionDataType="json",this.queueManager=new CubismMotionQueueManager,this.definitions=null!=(r=t.motions)?r:{},this.eyeBlinkIds=t.getEyeBlinkParameters()||[],this.lipSyncIds=t.getLipSyncParameters()||[],this.init(e)}init(t){super.init(t),this.settings.expressions&&(this.expressionManager=new Cubism4ExpressionManager(this.settings,t)),this.queueManager.setEventCallback(((t,e,r)=>{this.emit("motion:"+e)}))}isFinished(){return this.queueManager.isFinished()}_startMotion(t,e){return t.setFinishedMotionHandler(e),this.queueManager.stopAllMotions(),this.queueManager.startMotion(t,!1,performance.now())}_stopAllMotions(){this.queueManager.stopAllMotions()}createMotion(t,e,r){const i=CubismMotion.create(t),n=new CubismMotionJson(t),o=(e===this.groups.idle?bp.idleMotionFadingDuration:bp.motionFadingDuration)/1e3;return void 0===n.getMotionFadeInTime()&&i.setFadeInTime(r.FadeInTime>0?r.FadeInTime:o),void 0===n.getMotionFadeOutTime()&&i.setFadeOutTime(r.FadeOutTime>0?r.FadeOutTime:o),i.setEffectIds(this.eyeBlinkIds,this.lipSyncIds),i}getMotionFile(t){return t.File}getMotionName(t){return t.File}getSoundFile(t){return t.Sound}updateParameters(t,e){return this.queueManager.doUpdateMotion(t,e)}destroy(){super.destroy(),this.queueManager.release(),this.queueManager=void 0}}class CubismBreath{constructor(){this._breathParameters=[],this._currentTime=0}static create(){return new CubismBreath}setParameters(t){this._breathParameters=t}getParameters(){return this._breathParameters}updateParameters(t,e){this._currentTime+=e;const r=2*this._currentTime*3.14159;for(let i=0;i<this._breathParameters.length;++i){const e=this._breathParameters[i];t.addParameterValueById(e.parameterId,e.offset+e.peak*Math.sin(r/e.cycle),e.weight)}}}class BreathParameterData{constructor(t,e,r,i,n){this.parameterId=null==t?void 0:t,this.offset=null==e?0:e,this.peak=null==r?0:r,this.cycle=null==i?0:i,this.weight=null==n?0:n}}const Rf=class{static create(t){return new Rf(t)}setBlinkingInterval(t){this._blinkingIntervalSeconds=t}setBlinkingSetting(t,e,r){this._closingSeconds=t,this._closedSeconds=e,this._openingSeconds=r}setParameterIds(t){this._parameterIds=t}getParameterIds(){return this._parameterIds}updateParameters(t,e){let r;this._userTimeSeconds+=e;let i=0;switch(this._blinkingState){case If.EyeState_Closing:i=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,i>=1&&(i=1,this._blinkingState=If.EyeState_Closed,this._stateStartTimeSeconds=this._userTimeSeconds),r=1-i;break;case If.EyeState_Closed:i=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,i>=1&&(this._blinkingState=If.EyeState_Opening,this._stateStartTimeSeconds=this._userTimeSeconds),r=0;break;case If.EyeState_Opening:i=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,i>=1&&(i=1,this._blinkingState=If.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming()),r=i;break;case If.EyeState_Interval:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=If.EyeState_Closing,this._stateStartTimeSeconds=this._userTimeSeconds),r=1;break;case If.EyeState_First:default:this._blinkingState=If.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming(),r=1}Rf.CloseIfZero||(r=-r);for(let n=0;n<this._parameterIds.length;++n)t.setParameterValueById(this._parameterIds[n],r)}constructor(t){var e,r;this._blinkingState=If.EyeState_First,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=[],null!=t&&(this._parameterIds=null!=(r=null==(e=t.getEyeBlinkParameters())?void 0:e.slice())?r:this._parameterIds)}determinNextBlinkingTiming(){const t=Math.random();return this._userTimeSeconds+t*(2*this._blinkingIntervalSeconds-1)}};let wf=Rf;wf.CloseIfZero=!0;var If=(t=>(t[t.EyeState_First=0]="EyeState_First",t[t.EyeState_Interval=1]="EyeState_Interval",t[t.EyeState_Closing=2]="EyeState_Closing",t[t.EyeState_Closed=3]="EyeState_Closed",t[t.EyeState_Opening=4]="EyeState_Opening",t))(If||{});class csmRect{constructor(t=0,e=0,r=0,i=0){this.x=t,this.y=e,this.width=r,this.height=i}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}expand(t,e){this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e}}let Cf,Of,Df;class CubismClippingManager_WebGL{getChannelFlagAsColor(t){return this._channelColors[t]}getMaskRenderTexture(){let t=0;if(this._maskTexture&&0!=this._maskTexture.texture&&(this._maskTexture.frameNo=this._currentFrameNo,t=this._maskTexture.texture),0==t){const e=this._clippingMaskBufferSize;this._colorBuffer=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this._colorBuffer),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,e,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),t=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._colorBuffer,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,Df),this._maskTexture=new CubismRenderTextureResource(this._currentFrameNo,t)}return t}setGL(t){this.gl=t}calcClippedDrawTotalBounds(t,e){let r=Number.MAX_VALUE,i=Number.MAX_VALUE,n=Number.MIN_VALUE,o=Number.MIN_VALUE;const s=e._clippedDrawableIndexList.length;for(let a=0;a<s;a++){const s=e._clippedDrawableIndexList[a],h=t.getDrawableVertexCount(s),u=t.getDrawableVertices(s);let l=Number.MAX_VALUE,c=Number.MAX_VALUE,d=Number.MIN_VALUE,p=Number.MIN_VALUE;const f=h*lf;for(let t=uf;t<f;t+=lf){const e=u[t],r=u[t+1];e<l&&(l=e),e>d&&(d=e),r<c&&(c=r),r>p&&(p=r)}if(l!=Number.MAX_VALUE)if(l<r&&(r=l),c<i&&(i=c),d>n&&(n=d),p>o&&(o=p),r==Number.MAX_VALUE)e._allClippedDrawRect.x=0,e._allClippedDrawRect.y=0,e._allClippedDrawRect.width=0,e._allClippedDrawRect.height=0,e._isUsing=!1;else{e._isUsing=!0;const t=n-r,s=o-i;e._allClippedDrawRect.x=r,e._allClippedDrawRect.y=i,e._allClippedDrawRect.width=t,e._allClippedDrawRect.height=s}}}constructor(){this._maskRenderTexture=null,this._colorBuffer=null,this._currentFrameNo=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=[],this._clippingContextListForDraw=[],this._channelColors=[],this._tmpBoundsOnModel=new csmRect,this._tmpMatrix=new CubismMatrix44,this._tmpMatrixForMask=new CubismMatrix44,this._tmpMatrixForDraw=new CubismMatrix44;let t=new CubismTextureColor;t.R=1,t.G=0,t.B=0,t.A=0,this._channelColors.push(t),t=new CubismTextureColor,t.R=0,t.G=1,t.B=0,t.A=0,this._channelColors.push(t),t=new CubismTextureColor,t.R=0,t.G=0,t.B=1,t.A=0,this._channelColors.push(t),t=new CubismTextureColor,t.R=0,t.G=0,t.B=0,t.A=1,this._channelColors.push(t)}release(){var t,e,r;const i=this;for(let n=0;n<this._clippingContextListForMask.length;n++)this._clippingContextListForMask[n]&&(null==(t=this._clippingContextListForMask[n])||t.release());i._clippingContextListForMask=void 0,i._clippingContextListForDraw=void 0,this._maskTexture&&(null==(e=this.gl)||e.deleteFramebuffer(this._maskTexture.texture),i._maskTexture=void 0),i._channelColors=void 0,null==(r=this.gl)||r.deleteTexture(this._colorBuffer),this._colorBuffer=null}initialize(t,e,r,i){for(let n=0;n<e;n++){if(i[n]<=0){this._clippingContextListForDraw.push(null);continue}let t=this.findSameClip(r[n],i[n]);null==t&&(t=new CubismClippingContext(this,r[n],i[n]),this._clippingContextListForMask.push(t)),t.addClippedDrawable(n),this._clippingContextListForDraw.push(t)}}setupClippingContext(t,e){this._currentFrameNo++;let r=0;for(let i=0;i<this._clippingContextListForMask.length;i++){const e=this._clippingContextListForMask[i];this.calcClippedDrawTotalBounds(t,e),e._isUsing&&r++}if(r>0){this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._maskRenderTexture=this.getMaskRenderTexture(),e.getMvpMatrix(),e.preDraw(),this.setupLayoutBounds(r),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTexture),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);for(let r=0;r<this._clippingContextListForMask.length;r++){const i=this._clippingContextListForMask[r],n=i._allClippedDrawRect,o=i._layoutBounds,s=.05;this._tmpBoundsOnModel.setRect(n),this._tmpBoundsOnModel.expand(n.width*s,n.height*s);const a=o.width/this._tmpBoundsOnModel.width,h=o.height/this._tmpBoundsOnModel.height;this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(o.x,o.y),this._tmpMatrix.scaleRelative(a,h),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(o.x,o.y),this._tmpMatrix.scaleRelative(a,h),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),i._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),i._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray());const u=i._clippingIdCount;for(let r=0;r<u;r++){const n=i._clippingIdList[r];t.getDrawableDynamicFlagVertexPositionsDidChange(n)&&(e.setIsCulling(0!=t.getDrawableCulling(n)),e.setClippingContextBufferForMask(i),e.drawMesh(t.getDrawableTextureIndices(n),t.getDrawableVertexIndexCount(n),t.getDrawableVertexCount(n),t.getDrawableVertexIndices(n),t.getDrawableVertices(n),t.getDrawableVertexUvs(n),t.getDrawableOpacity(n),of.CubismBlendMode_Normal,!1))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,Df),e.setClippingContextBufferForMask(null),this.gl.viewport(Of[0],Of[1],Of[2],Of[3])}}findSameClip(t,e){for(let r=0;r<this._clippingContextListForMask.length;r++){const i=this._clippingContextListForMask[r],n=i._clippingIdCount;if(n!=e)continue;let o=0;for(let e=0;e<n;e++){const r=i._clippingIdList[e];for(let e=0;e<n;e++)if(t[e]==r){o++;break}}if(o==n)return i}return null}setupLayoutBounds(t){let e=t/4,r=t%4;e=~~e,r=~~r;let i=0;for(let n=0;n<4;n++){const t=e+(n<r?1:0);if(0==t);else if(1==t){const t=this._clippingContextListForMask[i++];t._layoutChannelNo=n,t._layoutBounds.x=0,t._layoutBounds.y=0,t._layoutBounds.width=1,t._layoutBounds.height=1}else if(2==t)for(let e=0;e<t;e++){let t=e%2;t=~~t;const r=this._clippingContextListForMask[i++];r._layoutChannelNo=n,r._layoutBounds.x=.5*t,r._layoutBounds.y=0,r._layoutBounds.width=.5,r._layoutBounds.height=1}else if(t<=4)for(let e=0;e<t;e++){let t=e%2,r=e/2;t=~~t,r=~~r;const o=this._clippingContextListForMask[i++];o._layoutChannelNo=n,o._layoutBounds.x=.5*t,o._layoutBounds.y=.5*r,o._layoutBounds.width=.5,o._layoutBounds.height=.5}else if(t<=9)for(let e=0;e<t;e++){let t=e%3,r=e/3;t=~~t,r=~~r;const o=this._clippingContextListForMask[i++];o._layoutChannelNo=n,o._layoutBounds.x=t/3,o._layoutBounds.y=r/3,o._layoutBounds.width=1/3,o._layoutBounds.height=1/3}else if(yp.supportMoreMaskDivisions&&t<=16)for(let e=0;e<t;e++){let t=e%4,r=e/4;t=~~t,r=~~r;const o=this._clippingContextListForMask[i++];o._layoutChannelNo=n,o._layoutBounds.x=t/4,o._layoutBounds.y=r/4,o._layoutBounds.width=1/4,o._layoutBounds.height=1/4}else mf("not supported mask count : {0}",t)}}getColorBuffer(){return this._colorBuffer}getClippingContextListForDraw(){return this._clippingContextListForDraw}setClippingMaskBufferSize(t){this._clippingMaskBufferSize=t}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}}class CubismRenderTextureResource{constructor(t,e){this.frameNo=t,this.texture=e}}class CubismClippingContext{constructor(t,e,r){this._isUsing=!1,this._owner=t,this._clippingIdList=e,this._clippingIdCount=r,this._allClippedDrawRect=new csmRect,this._layoutBounds=new csmRect,this._clippedDrawableIndexList=[],this._matrixForMask=new CubismMatrix44,this._matrixForDraw=new CubismMatrix44}release(){const t=this;t._layoutBounds=void 0,t._allClippedDrawRect=void 0,t._clippedDrawableIndexList=void 0}addClippedDrawable(t){this._clippedDrawableIndexList.push(t)}getClippingManager(){return this._owner}setGl(t){this._owner.setGL(t)}}class CubismShader_WebGL{static getInstance(){return null==Cf?(Cf=new CubismShader_WebGL,Cf):Cf}static deleteInstance(){Cf&&(Cf.release(),Cf=void 0)}constructor(){this._shaderSets=[]}release(){this.releaseShaderProgram()}setupShaderProgram(t,e,r,i,n,o,s,a,h,u,l,c,d){let p,f,m,_;l||mf("NoPremultipliedAlpha is not allowed"),0==this._shaderSets.length&&this.generateShaders();const g=t.getClippingContextBufferForMask();if(null!=g){const t=this._shaderSets[Ff.ShaderNames_SetupMask];this.gl.useProgram(t.shaderProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(t.samplerTexture0Location,0),null==s.vertex&&(s.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,i,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(t.attributePositionLocation),this.gl.vertexAttribPointer(t.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),null==s.uv&&(s.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,o,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(t.attributeTexCoordLocation),this.gl.vertexAttribPointer(t.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0);const r=g._layoutChannelNo,n=g.getClippingManager().getChannelFlagAsColor(r);this.gl.uniform4f(t.uniformChannelFlagLocation,n.R,n.G,n.B,n.A),this.gl.uniformMatrix4fv(t.uniformClipMatrixLocation,!1,g._matrixForMask.getArray());const a=g._layoutBounds;this.gl.uniform4f(t.uniformBaseColorLocation,2*a.x-1,2*a.y-1,2*a.getRight()-1,2*a.getBottom()-1),p=this.gl.ZERO,f=this.gl.ONE_MINUS_SRC_COLOR,m=this.gl.ZERO,_=this.gl.ONE_MINUS_SRC_ALPHA}else{const r=t.getClippingContextBufferForDraw(),n=null!=r?d?2:1:0;let a;switch(h){case of.CubismBlendMode_Normal:default:a=this._shaderSets[Ff.ShaderNames_NormalPremultipliedAlpha+n],p=this.gl.ONE,f=this.gl.ONE_MINUS_SRC_ALPHA,m=this.gl.ONE,_=this.gl.ONE_MINUS_SRC_ALPHA;break;case of.CubismBlendMode_Additive:a=this._shaderSets[Ff.ShaderNames_AddPremultipliedAlpha+n],p=this.gl.ONE,f=this.gl.ONE,m=this.gl.ZERO,_=this.gl.ONE;break;case of.CubismBlendMode_Multiplicative:a=this._shaderSets[Ff.ShaderNames_MultPremultipliedAlpha+n],p=this.gl.DST_COLOR,f=this.gl.ONE_MINUS_SRC_ALPHA,m=this.gl.ZERO,_=this.gl.ONE}if(this.gl.useProgram(a.shaderProgram),null==s.vertex&&(s.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,i,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(a.attributePositionLocation),this.gl.vertexAttribPointer(a.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),null==s.uv&&(s.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,o,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(a.attributeTexCoordLocation),this.gl.vertexAttribPointer(a.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),null!=r){this.gl.activeTexture(this.gl.TEXTURE1);const t=r.getClippingManager().getColorBuffer();this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(a.samplerTexture1Location,1),this.gl.uniformMatrix4fv(a.uniformClipMatrixLocation,!1,r._matrixForDraw.getArray());const e=r._layoutChannelNo,i=r.getClippingManager().getChannelFlagAsColor(e);this.gl.uniform4f(a.uniformChannelFlagLocation,i.R,i.G,i.B,i.A)}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(a.samplerTexture0Location,0),this.gl.uniformMatrix4fv(a.uniformMatrixLocation,!1,c.getArray()),this.gl.uniform4f(a.uniformBaseColorLocation,u.R,u.G,u.B,u.A)}null==s.index&&(s.index=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,s.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,n,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(p,f,m,_)}releaseShaderProgram(){for(let t=0;t<this._shaderSets.length;t++)this.gl.deleteProgram(this._shaderSets[t].shaderProgram),this._shaderSets[t].shaderProgram=0;this._shaderSets=[]}generateShaders(){for(let t=0;t<10;t++)this._shaderSets.push({});this._shaderSets[0].shaderProgram=this.loadShaderProgram(Lf,Bf),this._shaderSets[1].shaderProgram=this.loadShaderProgram(Nf,Gf),this._shaderSets[2].shaderProgram=this.loadShaderProgram(Uf,kf),this._shaderSets[3].shaderProgram=this.loadShaderProgram(Uf,Xf),this._shaderSets[4].shaderProgram=this._shaderSets[1].shaderProgram,this._shaderSets[5].shaderProgram=this._shaderSets[2].shaderProgram,this._shaderSets[6].shaderProgram=this._shaderSets[3].shaderProgram,this._shaderSets[7].shaderProgram=this._shaderSets[1].shaderProgram,this._shaderSets[8].shaderProgram=this._shaderSets[2].shaderProgram,this._shaderSets[9].shaderProgram=this._shaderSets[3].shaderProgram,this._shaderSets[0].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[0].shaderProgram,"a_position"),this._shaderSets[0].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[0].shaderProgram,"a_texCoord"),this._shaderSets[0].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"s_texture0"),this._shaderSets[0].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_clipMatrix"),this._shaderSets[0].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_channelFlag"),this._shaderSets[0].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_baseColor"),this._shaderSets[1].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[1].shaderProgram,"a_position"),this._shaderSets[1].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[1].shaderProgram,"a_texCoord"),this._shaderSets[1].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"s_texture0"),this._shaderSets[1].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"u_matrix"),this._shaderSets[1].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"u_baseColor"),this._shaderSets[2].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[2].shaderProgram,"a_position"),this._shaderSets[2].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[2].shaderProgram,"a_texCoord"),this._shaderSets[2].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"s_texture0"),this._shaderSets[2].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"s_texture1"),this._shaderSets[2].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_matrix"),this._shaderSets[2].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_clipMatrix"),this._shaderSets[2].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_channelFlag"),this._shaderSets[2].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_baseColor"),this._shaderSets[3].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[3].shaderProgram,"a_position"),this._shaderSets[3].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[3].shaderProgram,"a_texCoord"),this._shaderSets[3].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"s_texture0"),this._shaderSets[3].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"s_texture1"),this._shaderSets[3].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_matrix"),this._shaderSets[3].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_clipMatrix"),this._shaderSets[3].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_channelFlag"),this._shaderSets[3].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_baseColor"),this._shaderSets[4].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[4].shaderProgram,"a_position"),this._shaderSets[4].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[4].shaderProgram,"a_texCoord"),this._shaderSets[4].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"s_texture0"),this._shaderSets[4].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"u_matrix"),this._shaderSets[4].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"u_baseColor"),this._shaderSets[5].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[5].shaderProgram,"a_position"),this._shaderSets[5].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[5].shaderProgram,"a_texCoord"),this._shaderSets[5].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"s_texture0"),this._shaderSets[5].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"s_texture1"),this._shaderSets[5].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_matrix"),this._shaderSets[5].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_clipMatrix"),this._shaderSets[5].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_channelFlag"),this._shaderSets[5].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_baseColor"),this._shaderSets[6].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[6].shaderProgram,"a_position"),this._shaderSets[6].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[6].shaderProgram,"a_texCoord"),this._shaderSets[6].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"s_texture0"),this._shaderSets[6].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"s_texture1"),this._shaderSets[6].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_matrix"),this._shaderSets[6].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_clipMatrix"),this._shaderSets[6].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_channelFlag"),this._shaderSets[6].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_baseColor"),this._shaderSets[7].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[7].shaderProgram,"a_position"),this._shaderSets[7].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[7].shaderProgram,"a_texCoord"),this._shaderSets[7].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"s_texture0"),this._shaderSets[7].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"u_matrix"),this._shaderSets[7].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"u_baseColor"),this._shaderSets[8].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[8].shaderProgram,"a_position"),this._shaderSets[8].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[8].shaderProgram,"a_texCoord"),this._shaderSets[8].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"s_texture0"),this._shaderSets[8].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"s_texture1"),this._shaderSets[8].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_matrix"),this._shaderSets[8].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_clipMatrix"),this._shaderSets[8].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_channelFlag"),this._shaderSets[8].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_baseColor"),this._shaderSets[9].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[9].shaderProgram,"a_position"),this._shaderSets[9].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[9].shaderProgram,"a_texCoord"),this._shaderSets[9].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"s_texture0"),this._shaderSets[9].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"s_texture1"),this._shaderSets[9].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_matrix"),this._shaderSets[9].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_clipMatrix"),this._shaderSets[9].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_channelFlag"),this._shaderSets[9].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_baseColor")}loadShaderProgram(t,e){let r=this.gl.createProgram(),i=this.compileShaderSource(this.gl.VERTEX_SHADER,t);if(!i)return mf("Vertex shader compile error!"),0;let n=this.compileShaderSource(this.gl.FRAGMENT_SHADER,e);if(!n)return mf("Vertex shader compile error!"),0;this.gl.attachShader(r,i),this.gl.attachShader(r,n),this.gl.linkProgram(r);return this.gl.getProgramParameter(r,this.gl.LINK_STATUS)?(this.gl.deleteShader(i),this.gl.deleteShader(n),r):(mf("Failed to link program: {0}",r),this.gl.deleteShader(i),this.gl.deleteShader(n),r&&this.gl.deleteProgram(r),0)}compileShaderSource(t,e){const r=e,i=this.gl.createShader(t);if(this.gl.shaderSource(i,r),this.gl.compileShader(i),!i){mf("Shader compile log: {0} ",this.gl.getShaderInfoLog(i))}return this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(this.gl.deleteShader(i),null)}setGl(t){this.gl=t}}var Ff=(t=>(t[t.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",t[t.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",t[t.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",t[t.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",t[t.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",t[t.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",t[t.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",t[t.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",t[t.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",t[t.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted",t))(Ff||{});const Lf="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",Bf="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",Nf="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",Uf="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",Gf="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;void main(){   gl_FragColor = texture2D(s_texture0 , v_texCoord) * u_baseColor;}",kf="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;void main(){   vec4 col_formask = texture2D(s_texture0 , v_texCoord) * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",Xf="precision mediump float;varying vec2 v_texCoord;varying vec4 v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4 u_channelFlag;uniform vec4 u_baseColor;void main(){vec4 col_formask = texture2D(s_texture0, v_texCoord) * u_baseColor;vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;col_formask = col_formask * (1.0 - maskVal);gl_FragColor = col_formask;}";class CubismRenderer_WebGL extends CubismRenderer{constructor(){super(),this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._clippingManager=new CubismClippingManager_WebGL,this.firstDraw=!0,this._textures={},this._sortedDrawableIndexList=[],this._bufferData={vertex:null,uv:null,index:null}}initialize(t){t.isUsingMasking()&&(this._clippingManager=new CubismClippingManager_WebGL,this._clippingManager.initialize(t,t.getDrawableCount(),t.getDrawableMasks(),t.getDrawableMaskCounts()));for(let e=t.getDrawableCount()-1;e>=0;e--)this._sortedDrawableIndexList[e]=0;super.initialize(t)}bindTexture(t,e){this._textures[t]=e}getBindedTextures(){return this._textures}setClippingMaskBufferSize(t){this._clippingManager.release(),this._clippingManager=new CubismClippingManager_WebGL,this._clippingManager.setClippingMaskBufferSize(t),this._clippingManager.initialize(this.getModel(),this.getModel().getDrawableCount(),this.getModel().getDrawableMasks(),this.getModel().getDrawableMaskCounts())}getClippingMaskBufferSize(){return this._clippingManager.getClippingMaskBufferSize()}release(){var t,e,r;const i=this;this._clippingManager.release(),i._clippingManager=void 0,null==(t=this.gl)||t.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,null==(e=this.gl)||e.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,null==(r=this.gl)||r.deleteBuffer(this._bufferData.index),this._bufferData.index=null,i._bufferData=void 0,i._textures=void 0}doDrawModel(){this.preDraw(),null!=this._clippingManager&&this._clippingManager.setupClippingContext(this.getModel(),this);const t=this.getModel().getDrawableCount(),e=this.getModel().getDrawableRenderOrders();for(let r=0;r<t;++r){const t=e[r];this._sortedDrawableIndexList[t]=r}for(let r=0;r<t;++r){const t=this._sortedDrawableIndexList[r];this.getModel().getDrawableDynamicFlagIsVisible(t)&&(this.setClippingContextBufferForDraw(null!=this._clippingManager?this._clippingManager.getClippingContextListForDraw()[t]:null),this.setIsCulling(this.getModel().getDrawableCulling(t)),this.drawMesh(this.getModel().getDrawableTextureIndices(t),this.getModel().getDrawableVertexIndexCount(t),this.getModel().getDrawableVertexCount(t),this.getModel().getDrawableVertexIndices(t),this.getModel().getDrawableVertices(t),this.getModel().getDrawableVertexUvs(t),this.getModel().getDrawableOpacity(t),this.getModel().getDrawableBlendMode(t),this.getModel().getDrawableInvertedMaskBit(t)))}}drawMesh(t,e,r,i,n,o,s,a,h){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW);const u=this.getModelColor();null==this.getClippingContextBufferForMask()&&(u.A*=s,this.isPremultipliedAlpha()&&(u.R*=u.A,u.G*=u.A,u.B*=u.A));let l=null;null!=this._textures[t]&&(l=this._textures[t]),CubismShader_WebGL.getInstance().setupShaderProgram(this,l,r,n,i,o,this._bufferData,s,a,u,this.isPremultipliedAlpha(),this.getMvpMatrix(),h),this.gl.drawElements(this.gl.TRIANGLES,e,this.gl.UNSIGNED_SHORT,0),this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}static doStaticRelease(){CubismShader_WebGL.deleteInstance()}setRenderState(t,e){Df=t,Of=e}preDraw(){this.firstDraw&&(this.firstDraw=!1,this._anisortopy=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)}setClippingContextBufferForMask(t){this._clippingContextBufferForMask=t}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(t){this._clippingContextBufferForDraw=t}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}startUp(t){this.gl=t,this._clippingManager.setGL(t),CubismShader_WebGL.getInstance().setGl(t)}}CubismRenderer.staticRelease=()=>{CubismRenderer_WebGL.doStaticRelease()};const jf=new CubismMatrix44;class Cubism4InternalModel extends InternalModel{constructor(t,e,r){super(),this.lipSync=!0,this.breath=CubismBreath.create(),this.renderer=new CubismRenderer_WebGL,this.idParamAngleX="ParamAngleX",this.idParamAngleY="ParamAngleY",this.idParamAngleZ="ParamAngleZ",this.idParamEyeBallX="ParamEyeBallX",this.idParamEyeBallY="ParamEyeBallY",this.idParamBodyAngleX="ParamBodyAngleX",this.idParamBreath="ParamBreath",this.pixelsPerUnit=1,this.centeringTransform=new rs,this.coreModel=t,this.settings=e,this.motionManager=new Cubism4MotionManager(e,r),this.init()}init(){var t;super.init(),(null==(t=this.settings.getEyeBlinkParameters())?void 0:t.length)>0&&(this.eyeBlink=wf.create(this.settings)),this.breath.setParameters([new BreathParameterData(this.idParamAngleX,0,15,6.5345,.5),new BreathParameterData(this.idParamAngleY,0,8,3.5345,.5),new BreathParameterData(this.idParamAngleZ,0,10,5.5345,.5),new BreathParameterData(this.idParamBodyAngleX,0,4,15.5345,.5),new BreathParameterData(this.idParamBreath,0,.5,3.2345,.5)]),this.renderer.initialize(this.coreModel),this.renderer.setIsPremultipliedAlpha(!0)}getSize(){return[this.coreModel.getModel().canvasinfo.CanvasWidth,this.coreModel.getModel().canvasinfo.CanvasHeight]}getLayout(){const t={};if(this.settings.layout)for(const e of Object.keys(this.settings.layout)){t[e.charAt(0).toLowerCase()+e.slice(1)]=this.settings.layout[e]}return t}setupLayout(){super.setupLayout(),this.pixelsPerUnit=this.coreModel.getModel().canvasinfo.PixelsPerUnit,this.centeringTransform.scale(this.pixelsPerUnit,this.pixelsPerUnit).translate(this.originalWidth/2,this.originalHeight/2)}updateWebGLContext(t,e){this.renderer.firstDraw=!0,this.renderer._bufferData={vertex:null,uv:null,index:null},this.renderer.startUp(t),this.renderer._clippingManager._currentFrameNo=e,this.renderer._clippingManager._maskTexture=void 0,CubismShader_WebGL.getInstance()._shaderSets=[]}bindTexture(t,e){this.renderer.bindTexture(t,e)}getHitAreaDefs(){var t,e;return null!=(e=null==(t=this.settings.hitAreas)?void 0:t.map((t=>({id:t.Id,name:t.Name,index:this.coreModel.getDrawableIndex(t.Id)}))))?e:[]}getDrawableIDs(){return this.coreModel.getDrawableIds()}getDrawableIndex(t){return this.coreModel.getDrawableIndex(t)}getDrawableVertices(t){if("string"==typeof t&&-1===(t=this.coreModel.getDrawableIndex(t)))throw new TypeError("Unable to find drawable ID: "+t);const e=this.coreModel.getDrawableVertices(t).slice();for(let r=0;r<e.length;r+=2)e[r]=e[r]*this.pixelsPerUnit+this.originalWidth/2,e[r+1]=-e[r+1]*this.pixelsPerUnit+this.originalHeight/2;return e}updateTransform(t){this.drawingMatrix.copyFrom(this.centeringTransform).prepend(this.localTransform).prepend(t)}update(t,e){var r,i,n,o;super.update(t,e),t/=1e3,e/=1e3;const s=this.coreModel;this.emit("beforeMotionUpdate");const a=this.motionManager.update(this.coreModel,e);this.emit("afterMotionUpdate"),s.saveParameters(),null==(r=this.motionManager.expressionManager)||r.update(s,e),a||null==(i=this.eyeBlink)||i.updateParameters(s,t),this.updateFocus(),this.updateNaturalMovements(1e3*t,1e3*e),null==(n=this.physics)||n.evaluate(s,t),null==(o=this.pose)||o.updateParameters(s,t),this.emit("beforeModelUpdate"),s.update(),s.loadParameters()}updateFocus(){this.coreModel.addParameterValueById(this.idParamEyeBallX,this.focusController.x),this.coreModel.addParameterValueById(this.idParamEyeBallY,this.focusController.y),this.coreModel.addParameterValueById(this.idParamAngleX,30*this.focusController.x),this.coreModel.addParameterValueById(this.idParamAngleY,30*this.focusController.y),this.coreModel.addParameterValueById(this.idParamAngleZ,this.focusController.x*this.focusController.y*-30),this.coreModel.addParameterValueById(this.idParamBodyAngleX,10*this.focusController.x)}updateNaturalMovements(t,e){var r;null==(r=this.breath)||r.updateParameters(this.coreModel,t/1e3)}draw(t){const e=this.drawingMatrix,r=jf.getArray();r[0]=e.a,r[1]=e.b,r[4]=-e.c,r[5]=-e.d,r[12]=e.tx,r[13]=e.ty,this.renderer.setMvpMatrix(jf),this.renderer.setRenderState(t.getParameter(t.FRAMEBUFFER_BINDING),this.viewport),this.renderer.drawModel()}destroy(){super.destroy(),this.renderer.release(),this.coreModel.release(),this.renderer=void 0,this.coreModel=void 0}}let Vf,Hf=20;class CubismPose{static create(t){const e=new CubismPose;"number"==typeof t.FadeInTime&&(e._fadeTimeSeconds=t.FadeInTime,e._fadeTimeSeconds<=0&&(e._fadeTimeSeconds=.5));const r=t.Groups,i=r.length;for(let n=0;n<i;++n){const t=r[n],i=t.length;let o=0;for(let r=0;r<i;++r){const i=t[r],n=new PartData;n.partId=i.Id;const s=i.Link;if(s){const t=s.length;for(let e=0;e<t;++e){const t=new PartData;t.partId=s[e],n.link.push(t)}}e._partGroups.push(n),++o}e._partGroupCounts.push(o)}return e}updateParameters(t,e){t!=this._lastModel&&this.reset(t),this._lastModel=t,e<0&&(e=0);let r=0;for(let i=0;i<this._partGroupCounts.length;i++){const n=this._partGroupCounts[i];this.doFade(t,e,r,n),r+=n}this.copyPartOpacities(t)}reset(t){let e=0;for(let r=0;r<this._partGroupCounts.length;++r){const i=this._partGroupCounts[r];for(let r=e;r<e+i;++r){this._partGroups[r].initialize(t);const i=this._partGroups[r].partIndex,n=this._partGroups[r].parameterIndex;if(!(i<0)){t.setPartOpacityByIndex(i,r==e?1:0),t.setParameterValueByIndex(n,r==e?1:0);for(let e=0;e<this._partGroups[r].link.length;++e)this._partGroups[r].link[e].initialize(t)}}e+=i}}copyPartOpacities(t){for(let e=0;e<this._partGroups.length;++e){const r=this._partGroups[e];if(0==r.link.length)continue;const i=this._partGroups[e].partIndex,n=t.getPartOpacityByIndex(i);for(let e=0;e<r.link.length;++e){const i=r.link[e].partIndex;i<0||t.setPartOpacityByIndex(i,n)}}}doFade(t,e,r,i){let n=-1,o=1;const s=.5;for(let a=r;a<r+i;++a){const r=this._partGroups[a].partIndex,i=this._partGroups[a].parameterIndex;if(t.getParameterValueByIndex(i)>.001){if(n>=0)break;n=a,o=t.getPartOpacityByIndex(r),o+=e/this._fadeTimeSeconds,o>1&&(o=1)}}n<0&&(n=0,o=1);for(let a=r;a<r+i;++a){const e=this._partGroups[a].partIndex;if(n==a)t.setPartOpacityByIndex(e,o);else{let r,i=t.getPartOpacityByIndex(e);r=o<s?-.5*o/s+1:(1-o)*s/.5;(1-r)*(1-o)>.15&&(r=1-.15/(1-o)),i>r&&(i=r),t.setPartOpacityByIndex(e,i)}}}constructor(){this._fadeTimeSeconds=.5,this._lastModel=void 0,this._partGroups=[],this._partGroupCounts=[]}}class PartData{constructor(t){this.parameterIndex=0,this.partIndex=0,this.partId="",this.link=[],null!=t&&this.assignment(t)}assignment(t){return this.partId=t.partId,this.link=t.link.map((t=>t.clone())),this}initialize(t){this.parameterIndex=t.getParameterIndex(this.partId),this.partIndex=t.getPartIndex(this.partId),t.setParameterValueByIndex(this.parameterIndex,1)}clone(){const t=new PartData;return t.partId=this.partId,t.parameterIndex=this.parameterIndex,t.partIndex=this.partIndex,t.link=this.link.map((t=>t.clone())),t}}class CubismModel{update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getCanvasWidth(){return null==this._model?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return null==this._model?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const t=this._model.parameters.count,e=this._savedParameters.length;for(let r=0;r<t;++r)r<e?this._savedParameters[r]=this._parameterValues[r]:this._savedParameters.push(this._parameterValues[r])}getModel(){return this._model}getPartIndex(t){let e;const r=this._model.parts.count;for(e=0;e<r;++e)if(t==this._partIds[e])return e;return t in this._notExistPartId?this._notExistPartId[t]:(e=r+this._notExistPartId.length,this._notExistPartId[t]=e,this._notExistPartOpacities[e]=0,e)}getPartCount(){return this._model.parts.count}setPartOpacityByIndex(t,e){t in this._notExistPartOpacities?this._notExistPartOpacities[t]=e:(0<=t&&this.getPartCount(),this._partOpacities[t]=e)}setPartOpacityById(t,e){const r=this.getPartIndex(t);r<0||this.setPartOpacityByIndex(r,e)}getPartOpacityByIndex(t){return t in this._notExistPartOpacities?this._notExistPartOpacities[t]:(0<=t&&this.getPartCount(),this._partOpacities[t])}getPartOpacityById(t){const e=this.getPartIndex(t);return e<0?0:this.getPartOpacityByIndex(e)}getParameterIndex(t){let e;const r=this._model.parameters.count;for(e=0;e<r;++e)if(t==this._parameterIds[e])return e;return t in this._notExistParameterId?this._notExistParameterId[t]:(e=this._model.parameters.count+Object.keys(this._notExistParameterId).length,this._notExistParameterId[t]=e,this._notExistParameterValues[e]=0,e)}getParameterCount(){return this._model.parameters.count}getParameterMaximumValue(t){return this._model.parameters.maximumValues[t]}getParameterMinimumValue(t){return this._model.parameters.minimumValues[t]}getParameterDefaultValue(t){return this._model.parameters.defaultValues[t]}getParameterValueByIndex(t){return t in this._notExistParameterValues?this._notExistParameterValues[t]:(0<=t&&this.getParameterCount(),this._parameterValues[t])}getParameterValueById(t){const e=this.getParameterIndex(t);return this.getParameterValueByIndex(e)}setParameterValueByIndex(t,e,r=1){t in this._notExistParameterValues?this._notExistParameterValues[t]=1==r?e:this._notExistParameterValues[t]*(1-r)+e*r:(0<=t&&this.getParameterCount(),this._model.parameters.maximumValues[t]<e&&(e=this._model.parameters.maximumValues[t]),this._model.parameters.minimumValues[t]>e&&(e=this._model.parameters.minimumValues[t]),this._parameterValues[t]=1==r?e:this._parameterValues[t]=this._parameterValues[t]*(1-r)+e*r)}setParameterValueById(t,e,r=1){const i=this.getParameterIndex(t);this.setParameterValueByIndex(i,e,r)}addParameterValueByIndex(t,e,r=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)+e*r)}addParameterValueById(t,e,r=1){const i=this.getParameterIndex(t);this.addParameterValueByIndex(i,e,r)}multiplyParameterValueById(t,e,r=1){const i=this.getParameterIndex(t);this.multiplyParameterValueByIndex(i,e,r)}multiplyParameterValueByIndex(t,e,r=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)*(1+(e-1)*r))}getDrawableIds(){return this._drawableIds.slice()}getDrawableIndex(t){const e=this._model.drawables.count;for(let r=0;r<e;++r)if(this._drawableIds[r]==t)return r;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(t){return this._model.drawables.ids[t]}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(t){return this._model.drawables.textureIndices[t]}getDrawableDynamicFlagVertexPositionsDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(e[t])}getDrawableVertexIndexCount(t){return this._model.drawables.indexCounts[t]}getDrawableVertexCount(t){return this._model.drawables.vertexCounts[t]}getDrawableVertices(t){return this.getDrawableVertexPositions(t)}getDrawableVertexIndices(t){return this._model.drawables.indices[t]}getDrawableVertexPositions(t){return this._model.drawables.vertexPositions[t]}getDrawableVertexUvs(t){return this._model.drawables.vertexUvs[t]}getDrawableOpacity(t){return this._model.drawables.opacities[t]}getDrawableCulling(t){const e=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(e[t])}getDrawableBlendMode(t){const e=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(e[t])?of.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(e[t])?of.CubismBlendMode_Multiplicative:of.CubismBlendMode_Normal}getDrawableInvertedMaskBit(t){const e=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(e[t])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let t=0;t<this._model.drawables.count;++t)if(!(this._model.drawables.maskCounts[t]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(e[t])}getDrawableDynamicFlagVisibilityDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(e[t])}getDrawableDynamicFlagOpacityDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(e[t])}getDrawableDynamicFlagRenderOrderDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(e[t])}loadParameters(){let t=this._model.parameters.count;const e=this._savedParameters.length;t>e&&(t=e);for(let r=0;r<t;++r)this._parameterValues[r]=this._savedParameters[r]}initialize(){this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const t=this._model.parameters.ids,e=this._model.parameters.count;for(let r=0;r<e;++r)this._parameterIds.push(t[r])}{const t=this._model.parts.ids,e=this._model.parts.count;for(let r=0;r<e;++r)this._partIds.push(t[r])}{const t=this._model.drawables.ids,e=this._model.drawables.count;for(let r=0;r<e;++r)this._drawableIds.push(t[r])}}constructor(t){this._model=t,this._savedParameters=[],this._parameterIds=[],this._drawableIds=[],this._partIds=[],this._notExistPartId={},this._notExistParameterId={},this._notExistParameterValues={},this._notExistPartOpacities={},this.initialize()}release(){this._model.release(),this._model=void 0}}class CubismMoc{static create(t){const e=Live2DCubismCore.Moc.fromArrayBuffer(t);if(e)return new CubismMoc(e);throw new Error("Unknown error")}createModel(){let t;const e=Live2DCubismCore.Model.fromMoc(this._moc);if(e)return t=new CubismModel(e),++this._modelCount,t;throw new Error("Unknown error")}deleteModel(t){null!=t&&--this._modelCount}constructor(t){this._moc=t,this._modelCount=0}release(){this._moc._release(),this._moc=void 0}}var Yf=(t=>(t[t.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter",t))(Yf||{}),zf=(t=>(t[t.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",t[t.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",t[t.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle",t))(zf||{});class CubismPhysicsParticle{constructor(){this.initialPosition=new CubismVector2(0,0),this.position=new CubismVector2(0,0),this.lastPosition=new CubismVector2(0,0),this.lastGravity=new CubismVector2(0,0),this.force=new CubismVector2(0,0),this.velocity=new CubismVector2(0,0)}}class CubismPhysicsSubRig{constructor(){this.normalizationPosition={},this.normalizationAngle={}}}class CubismPhysicsInput{constructor(){this.source={}}}class CubismPhysicsOutput{constructor(){this.destination={},this.translationScale=new CubismVector2(0,0)}}class CubismPhysicsRig{constructor(){this.settings=[],this.inputs=[],this.outputs=[],this.particles=[],this.gravity=new CubismVector2(0,0),this.wind=new CubismVector2(0,0)}}class CubismPhysicsJson{constructor(t){this._json=t}release(){this._json=void 0}getGravity(){const t=new CubismVector2(0,0);return t.x=this._json.Meta.EffectiveForces.Gravity.X,t.y=this._json.Meta.EffectiveForces.Gravity.Y,t}getWind(){const t=new CubismVector2(0,0);return t.x=this._json.Meta.EffectiveForces.Wind.X,t.y=this._json.Meta.EffectiveForces.Wind.Y,t}getSubRigCount(){return this._json.Meta.PhysicsSettingCount}getTotalInputCount(){return this._json.Meta.TotalInputCount}getTotalOutputCount(){return this._json.Meta.TotalOutputCount}getVertexCount(){return this._json.Meta.VertexCount}getNormalizationPositionMinimumValue(t){return this._json.PhysicsSettings[t].Normalization.Position.Minimum}getNormalizationPositionMaximumValue(t){return this._json.PhysicsSettings[t].Normalization.Position.Maximum}getNormalizationPositionDefaultValue(t){return this._json.PhysicsSettings[t].Normalization.Position.Default}getNormalizationAngleMinimumValue(t){return this._json.PhysicsSettings[t].Normalization.Angle.Minimum}getNormalizationAngleMaximumValue(t){return this._json.PhysicsSettings[t].Normalization.Angle.Maximum}getNormalizationAngleDefaultValue(t){return this._json.PhysicsSettings[t].Normalization.Angle.Default}getInputCount(t){return this._json.PhysicsSettings[t].Input.length}getInputWeight(t,e){return this._json.PhysicsSettings[t].Input[e].Weight}getInputReflect(t,e){return this._json.PhysicsSettings[t].Input[e].Reflect}getInputType(t,e){return this._json.PhysicsSettings[t].Input[e].Type}getInputSourceId(t,e){return this._json.PhysicsSettings[t].Input[e].Source.Id}getOutputCount(t){return this._json.PhysicsSettings[t].Output.length}getOutputVertexIndex(t,e){return this._json.PhysicsSettings[t].Output[e].VertexIndex}getOutputAngleScale(t,e){return this._json.PhysicsSettings[t].Output[e].Scale}getOutputWeight(t,e){return this._json.PhysicsSettings[t].Output[e].Weight}getOutputDestinationId(t,e){return this._json.PhysicsSettings[t].Output[e].Destination.Id}getOutputType(t,e){return this._json.PhysicsSettings[t].Output[e].Type}getOutputReflect(t,e){return this._json.PhysicsSettings[t].Output[e].Reflect}getParticleCount(t){return this._json.PhysicsSettings[t].Vertices.length}getParticleMobility(t,e){return this._json.PhysicsSettings[t].Vertices[e].Mobility}getParticleDelay(t,e){return this._json.PhysicsSettings[t].Vertices[e].Delay}getParticleAcceleration(t,e){return this._json.PhysicsSettings[t].Vertices[e].Acceleration}getParticleRadius(t,e){return this._json.PhysicsSettings[t].Vertices[e].Radius}getParticlePosition(t,e){const r=new CubismVector2(0,0);return r.x=this._json.PhysicsSettings[t].Vertices[e].Position.X,r.y=this._json.PhysicsSettings[t].Vertices[e].Position.Y,r}}const Wf="Angle";class CubismPhysics{static create(t){const e=new CubismPhysics;return e.parse(t),e._physicsRig.gravity.y=0,e}evaluate(t,e){let r,i,n,o;const s=new CubismVector2;let a,h,u,l,c,d,p,f;c=t.getModel().parameters.values,d=t.getModel().parameters.maximumValues,p=t.getModel().parameters.minimumValues,f=t.getModel().parameters.defaultValues;for(let m=0;m<this._physicsRig.subRigCount;++m){r={angle:0},s.x=0,s.y=0,a=this._physicsRig.settings[m],h=this._physicsRig.inputs.slice(a.baseInputIndex),u=this._physicsRig.outputs.slice(a.baseOutputIndex),l=this._physicsRig.particles.slice(a.baseParticleIndex);for(let e=0;e<a.inputCount;++e)i=h[e].weight/100,-1==h[e].sourceParameterIndex&&(h[e].sourceParameterIndex=t.getParameterIndex(h[e].source.id)),h[e].getNormalizedParameterValue(s,r,c[h[e].sourceParameterIndex],p[h[e].sourceParameterIndex],d[h[e].sourceParameterIndex],f[h[e].sourceParameterIndex],a.normalizationPosition,a.normalizationAngle,h[e].reflect,i);n=nf.degreesToRadian(-r.angle),s.x=s.x*nf.cos(n)-s.y*nf.sin(n),s.y=s.x*nf.sin(n)+s.y*nf.cos(n),nm(l,a.particleCount,s,r.angle,this._options.wind,.001*a.normalizationPosition.maximum,e,5);for(let e=0;e<a.outputCount;++e){const r=u[e].vertexIndex;if(r<1||r>=a.particleCount)break;-1==u[e].destinationParameterIndex&&(u[e].destinationParameterIndex=t.getParameterIndex(u[e].destination.id));const i=new CubismVector2;i.x=l[r].position.x-l[r-1].position.x,i.y=l[r].position.y-l[r-1].position.y,o=u[e].getValue(i,l,r,u[e].reflect,this._options.gravity);const n=u[e].destinationParameterIndex,s=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(c.subarray(n))):c.slice(n);om(s,p[n],d[n],o,u[e]);for(let t=n,e=0;t<c.length;t++,e++)c[t]=s[e]}}}setOptions(t){this._options=t}getOption(){return this._options}constructor(){this._options=new Options,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0}release(){this._physicsRig=void 0}parse(t){this._physicsRig=new CubismPhysicsRig;let e=new CubismPhysicsJson(t);this._physicsRig.gravity=e.getGravity(),this._physicsRig.wind=e.getWind(),this._physicsRig.subRigCount=e.getSubRigCount();let r=0,i=0,n=0;for(let o=0;o<this._physicsRig.subRigCount;++o){const t=new CubismPhysicsSubRig;t.normalizationPosition.minimum=e.getNormalizationPositionMinimumValue(o),t.normalizationPosition.maximum=e.getNormalizationPositionMaximumValue(o),t.normalizationPosition.defalut=e.getNormalizationPositionDefaultValue(o),t.normalizationAngle.minimum=e.getNormalizationAngleMinimumValue(o),t.normalizationAngle.maximum=e.getNormalizationAngleMaximumValue(o),t.normalizationAngle.defalut=e.getNormalizationAngleDefaultValue(o),t.inputCount=e.getInputCount(o),t.baseInputIndex=r,r+=t.inputCount;for(let r=0;r<t.inputCount;++r){const t=new CubismPhysicsInput;switch(t.sourceParameterIndex=-1,t.weight=e.getInputWeight(o,r),t.reflect=e.getInputReflect(o,r),e.getInputType(o,r)){case"X":t.type=zf.CubismPhysicsSource_X,t.getNormalizedParameterValue=qf;break;case"Y":t.type=zf.CubismPhysicsSource_Y,t.getNormalizedParameterValue=Kf;break;case Wf:t.type=zf.CubismPhysicsSource_Angle,t.getNormalizedParameterValue=Zf}t.source.targetType=Yf.CubismPhysicsTargetType_Parameter,t.source.id=e.getInputSourceId(o,r),this._physicsRig.inputs.push(t)}t.outputCount=e.getOutputCount(o),t.baseOutputIndex=i,i+=t.outputCount;for(let r=0;r<t.outputCount;++r){const t=new CubismPhysicsOutput;switch(t.destinationParameterIndex=-1,t.vertexIndex=e.getOutputVertexIndex(o,r),t.angleScale=e.getOutputAngleScale(o,r),t.weight=e.getOutputWeight(o,r),t.destination.targetType=Yf.CubismPhysicsTargetType_Parameter,t.destination.id=e.getOutputDestinationId(o,r),e.getOutputType(o,r)){case"X":t.type=zf.CubismPhysicsSource_X,t.getValue=$f,t.getScale=em;break;case"Y":t.type=zf.CubismPhysicsSource_Y,t.getValue=Jf,t.getScale=rm;break;case Wf:t.type=zf.CubismPhysicsSource_Angle,t.getValue=Qf,t.getScale=im}t.reflect=e.getOutputReflect(o,r),this._physicsRig.outputs.push(t)}t.particleCount=e.getParticleCount(o),t.baseParticleIndex=n,n+=t.particleCount;for(let r=0;r<t.particleCount;++r){const t=new CubismPhysicsParticle;t.mobility=e.getParticleMobility(o,r),t.delay=e.getParticleDelay(o,r),t.acceleration=e.getParticleAcceleration(o,r),t.radius=e.getParticleRadius(o,r),t.position=e.getParticlePosition(o,r),this._physicsRig.particles.push(t)}this._physicsRig.settings.push(t)}this.initialize(),e.release()}initialize(){let t,e,r;for(let i=0;i<this._physicsRig.subRigCount;++i){e=this._physicsRig.settings[i],t=this._physicsRig.particles.slice(e.baseParticleIndex),t[0].initialPosition=new CubismVector2(0,0),t[0].lastPosition=new CubismVector2(t[0].initialPosition.x,t[0].initialPosition.y),t[0].lastGravity=new CubismVector2(0,-1),t[0].lastGravity.y*=-1,t[0].velocity=new CubismVector2(0,0),t[0].force=new CubismVector2(0,0);for(let i=1;i<e.particleCount;++i)r=new CubismVector2(0,0),r.y=t[i].radius,t[i].initialPosition=new CubismVector2(t[i-1].initialPosition.x+r.x,t[i-1].initialPosition.y+r.y),t[i].position=new CubismVector2(t[i].initialPosition.x,t[i].initialPosition.y),t[i].lastPosition=new CubismVector2(t[i].initialPosition.x,t[i].initialPosition.y),t[i].lastGravity=new CubismVector2(0,-1),t[i].lastGravity.y*=-1,t[i].velocity=new CubismVector2(0,0),t[i].force=new CubismVector2(0,0)}}}class Options{constructor(){this.gravity=new CubismVector2(0,0),this.wind=new CubismVector2(0,0)}}function qf(t,e,r,i,n,o,s,a,h,u){t.x+=sm(r,i,n,o,s.minimum,s.maximum,s.defalut,h)*u}function Kf(t,e,r,i,n,o,s,a,h,u){t.y+=sm(r,i,n,o,s.minimum,s.maximum,s.defalut,h)*u}function Zf(t,e,r,i,n,o,s,a,h,u){e.angle+=sm(r,i,n,o,a.minimum,a.maximum,a.defalut,h)*u}function $f(t,e,r,i,n){let o=t.x;return i&&(o*=-1),o}function Jf(t,e,r,i,n){let o=t.y;return i&&(o*=-1),o}function Qf(t,e,r,i,n){let o;return n=r>=2?e[r-1].position.substract(e[r-2].position):n.multiplyByScaler(-1),o=nf.directionToRadian(n,t),i&&(o*=-1),o}function tm(t,e){return Math.min(t,e)+function(t,e){return Math.abs(Math.max(t,e)-Math.min(t,e))}(t,e)/2}function em(t,e){return t.x}function rm(t,e){return t.y}function im(t,e){return e}function nm(t,e,r,i,n,o,s,a){let h,u,l,c,d=new CubismVector2(0,0),p=new CubismVector2(0,0),f=new CubismVector2(0,0),m=new CubismVector2(0,0);t[0].position=new CubismVector2(r.x,r.y),h=nf.degreesToRadian(i),c=nf.radianToDirection(h),c.normalize();for(let _=1;_<e;++_)t[_].force=c.multiplyByScaler(t[_].acceleration).add(n),t[_].lastPosition=new CubismVector2(t[_].position.x,t[_].position.y),u=t[_].delay*s*30,d=t[_].position.substract(t[_-1].position),l=nf.directionToRadian(t[_].lastGravity,c)/a,d.x=nf.cos(l)*d.x-d.y*nf.sin(l),d.y=nf.sin(l)*d.x+d.y*nf.cos(l),t[_].position=t[_-1].position.add(d),p=t[_].velocity.multiplyByScaler(u),f=t[_].force.multiplyByScaler(u).multiplyByScaler(u),t[_].position=t[_].position.add(p).add(f),m=t[_].position.substract(t[_-1].position),m.normalize(),t[_].position=t[_-1].position.add(m.multiplyByScaler(t[_].radius)),nf.abs(t[_].position.x)<o&&(t[_].position.x=0),0!=u&&(t[_].velocity=t[_].position.substract(t[_].lastPosition),t[_].velocity=t[_].velocity.divisionByScalar(u),t[_].velocity=t[_].velocity.multiplyByScaler(t[_].mobility)),t[_].force=new CubismVector2(0,0),t[_].lastGravity=new CubismVector2(c.x,c.y)}function om(t,e,r,i,n){let o,s,a;o=n.getScale(n.translationScale,n.angleScale),s=i*o,s<e?(s<n.valueBelowMinimum&&(n.valueBelowMinimum=s),s=e):s>r&&(s>n.valueExceededMaximum&&(n.valueExceededMaximum=s),s=r),a=n.weight/100,a>=1||(s=t[0]*(1-a)+s*a),t[0]=s}function sm(t,e,r,i,n,o,s,a){let h=0;const u=nf.max(r,e);u<t&&(t=u);const l=nf.min(r,e);l>t&&(t=l);const c=nf.min(n,o),d=nf.max(n,o),p=s,f=tm(l,u),m=t-f;switch(Math.sign(m)){case 1:{const t=u-f;0!=t&&(h=m*((d-p)/t),h+=p);break}case-1:{const t=l-f;0!=t&&(h=m*((c-p)/t),h+=p);break}case 0:h=p}return a?h:-1*h}function am(){var t;null==(t=this.__moc)||t.release()}jp.registerRuntime({version:4,ready:function(){return CubismFramework.isStarted()?Promise.resolve():(null!=Vf||(Vf=new Promise(((t,e)=>{!function r(){try{i=Object.assign({logFunction:console.log,loggingLevel:cf.LogLevel_Verbose},i),CubismFramework.startUp(i),CubismFramework.initialize(),t()}catch(pm){if(Hf--,Hf<0){const r=new Error("Failed to start up Cubism 4 framework.");return r.cause=pm,void e(r)}Tp.log("Cubism4","Startup failed, retrying 10ms later..."),setTimeout(r,10)}var i}()}))),Vf)},test:t=>t instanceof Cubism4ModelSettings||Cubism4ModelSettings.isValidJSON(t),isValidMoc(t){if(t.byteLength<4)return!1;const e=new Int8Array(t,0,4);return"MOC3"===String.fromCharCode(...e)},createModelSettings:t=>new Cubism4ModelSettings(t),createCoreModel(t){const e=CubismMoc.create(t);try{const t=e.createModel();return t.__moc=e,t}catch(pm){try{e.release()}catch(r){}throw pm}},createInternalModel(t,e,r){const i=new Cubism4InternalModel(t,e,r),n=t;return n.__moc&&(i.__moc=n.__moc,delete n.__moc,i.once("destroy",am)),i},createPhysics:(t,e)=>CubismPhysics.create(e),createPose:(t,e)=>CubismPose.create(e)});const hm=t=>(y("data-v-35935bff"),t=t(),v(),t),um={class:"live2d-menu-container"},lm=hm((()=>c("div",{class:"element"},null,-1))),cm=hm((()=>c("div",{style:{height:"85vh"}},[
c("canvas",{id:"canvas"})],-1))),dm=S(t({__name:"index",setup(t){e((t=>({"6d3d3bbc":w.value})));const y=["hiyori_free_zh/runtime/hiyori_free_t08.model3.json"],v=r(),b=i((()=>y.map((t=>({label:t.split("/")[0],value:"/model/"+t})))));let x,T;const S=r(.1),M=r({});n((async()=>{window.PIXI=mp,await async function(){document.querySelector(".live2d-container"),x=new ip({view:document.querySelector("#canvas"),autoStart:!0,resizeTo:document.querySelector(".live2d-container")}),x.renderer.view.style.width="100%",v.value=b.value[0].value,await P()}()})),o((()=>{x&&(x.destroy(),x=null)}));const P=function(){let t=!1;return async function(){if(t)return;var e;t=!0,T&&A(),E({type:"success",message:"模型加载中!"}),T=await Live2DModel.from(v.value),E({type:"success",message:"加载成功!"}),async function(t){M.value=t.internalModel.motionManager.definitions}(T),x.stage.addChild(T),(e=T).buttonMode=!0,e.on("pointerdown",(t=>{e.dragging=!0,e._pointerX=t.data.global.x-e.x,e._pointerY=t.data.global.y-e.y})),e.on("pointermove",(t=>{e.dragging&&(e.position.x=t.data.global.x-e._pointerX,e.position.y=t.data.global.y-e._pointerY)})),e.on("pointerupoutside",(()=>e.dragging=!1)),e.on("pointerup",(()=>e.dragging=!1)),T.anchor.set(.5,.5);const r=(i=T.width,Number((document.querySelector(".live2d-container").clientWidth/i*.45).toFixed(2)));var i;T.scale.set(r),S.value=r,T.x=(document.querySelector(".live2d-container").clientWidth-T.width*T.scale.x)/2,T.y=(document.querySelector(".live2d-container").clientHeight-T.height*T.scale.y)/2,t=!1}}();function A(){T&&(T.destroy(),T=null)}function R(t){null==T||T.scale.set(t)}const w=r();return(t,e)=>{const r=s("el-alert"),i=s("el-option"),n=s("el-select"),o=s("el-input"),y=s("el-slider"),x=s("el-button"),I=s("el-tag"),C=s("el-scrollbar"),O=s("el-col"),D=s("el-row");return a(),h("div",null,[u(D,null,{default:l((()=>[u(O,{span:5},{default:l((()=>[c("div",um,[u(r,{title:"基于",type:"success",description:"   https://github.com/guansss/pixi-live2d-display"}),u(n,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=t=>v.value=t),placeholder:"选择模型",onChange:d(P),style:{margin:"10px 0"}},{default:l((()=>[(a(!0),h(p,null,f(b.value,(t=>(a(),m(i,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),u(o,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t)},null,8,["modelValue"]),u(y,{modelValue:S.value,"onUpdate:modelValue":e[2]||(e[2]=t=>S.value=t),step:.01,min:.01,max:3,onInput:R},null,8,["modelValue"]),c("div",null,[u(x,{onClick:d(P)},{default:l((()=>[_("加载")])),_:1},8,["onClick"]),u(x,{type:"danger",onClick:A},{default:l((()=>[_("销毁")])),_:1})]),lm,(a(!0),h(p,null,f(M.value,((t,e)=>(a(),h("div",{key:e},[u(I,null,{default:l((()=>[_(g(e||"动作列表"),1)])),_:2},1024),u(C,{style:{"max-height":"500px"}},{default:l((()=>[(a(!0),h(p,null,f(t,((t,r)=>(a(),m(x,{key:t,block:"",onClick:t=>async function(t,e){const r=await T.internalModel.motionManager.loadMotion(t,e);await T.internalModel.motionManager.startMotion(t,e)?(w.value=`${r._loopDurationSeconds}s`,setTimeout((()=>{w.value=""}),1e3*r._loopDurationSeconds),E({type:"success",message:"模型加载成功!"})):E({type:"error",message:"模型加载失败!"})}(e,r),style:{display:"block",width:"100%",margin:"10px 0"}},{default:l((()=>[_(g(t.File.split(".motion3.json")[0]),1)])),_:2},1032,["onClick"])))),128))])),_:2},1024)])))),128))])])),_:1}),u(O,{span:19,class:"live2d-container"},{default:l((()=>[cm])),_:1})])),_:1})])}}}),[["__scopeId","data-v-35935bff"]]);export{dm as default};
